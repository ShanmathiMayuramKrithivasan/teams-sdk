"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[5437],{26802:(e,n,t)=>{t.d(n,{A:()=>s});var i=t(22147),a=t(62540);function s({language:e,children:n}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,a.jsx)(a.Fragment,{children:n}):null}},39e3:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"csharp/in-depth-guides/adaptive-cards/executing-actions","title":"Executing Actions","description":"\x3c!--","source":"@site/docs/main/csharp/in-depth-guides/adaptive-cards/executing-actions.mdx","sourceDirName":"csharp/in-depth-guides/adaptive-cards","slug":"/csharp/in-depth-guides/adaptive-cards/executing-actions","permalink":"/teams-sdk/csharp/in-depth-guides/adaptive-cards/executing-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/csharp/in-depth-guides/adaptive-cards/executing-actions.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Executing Actions","title":"Executing Actions","summary":"How to implement interactive elements in Adaptive Cards through actions like buttons, links, and input submission triggers."},"sidebar":"default","previous":{"title":"Building Adaptive Cards","permalink":"/teams-sdk/csharp/in-depth-guides/adaptive-cards/building-adaptive-cards"},"next":{"title":"Dialogs","permalink":"/teams-sdk/csharp/in-depth-guides/dialogs/"}}');var a=t(62540),s=t(43023),r=t(26802);const o={sidebar_position:2,sidebar_label:"Executing Actions",title:"Executing Actions",summary:"How to implement interactive elements in Adaptive Cards through actions like buttons, links, and input submission triggers."},c="Executing Actions",d={},l=[{value:"Action Types",id:"action-types",level:2},{value:"Creating Actions with the SDK",id:"creating-actions-with-the-sdk",level:2},{value:"Single Actions",id:"single-actions",level:3},{value:"Action Sets",id:"action-sets",level:3},{value:"Raw JSON Alternative",id:"raw-json-alternative",level:3},{value:"Working with Input Values",id:"working-with-input-values",level:2},{value:"Associating data with the cards",id:"associating-data-with-the-cards",level:3},{value:"Input Validation",id:"input-validation",level:3},{value:"Server Handlers",id:"server-handlers",level:2},{value:"Basic Structure",id:"basic-structure",level:3}];function u(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.header,{children:(0,a.jsx)(n.h1,{id:"executing-actions",children:"Executing Actions"})}),"\n",(0,a.jsxs)(n.p,{children:["Adaptive Cards support interactive elements through ",(0,a.jsx)(n.strong,{children:"actions"}),"\u2014buttons, links, and input submission triggers that respond to user interaction.\nYou can use these to collect form input, trigger workflows, show task modules, open URLs, and more."]}),"\n",(0,a.jsx)(n.h2,{id:"action-types",children:"Action Types"}),"\n",(0,a.jsx)(n.p,{children:"The Teams SDK supports several action types for different interaction patterns:"}),"\n",(0,a.jsxs)(n.table,{children:[(0,a.jsx)(n.thead,{children:(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.th,{children:"Action Type"}),(0,a.jsx)(n.th,{children:"Purpose"}),(0,a.jsx)(n.th,{children:"Description"})]})}),(0,a.jsxs)(n.tbody,{children:[(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Action.Execute"})}),(0,a.jsx)(n.td,{children:"Server\u2011side processing"}),(0,a.jsx)(n.td,{children:"Send data to your bot for processing. Best for forms & multi\u2011step workflows."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Action.Submit"})}),(0,a.jsx)(n.td,{children:"Simple data submission"}),(0,a.jsxs)(n.td,{children:["Legacy action type. Prefer ",(0,a.jsx)(n.code,{children:"Execute"})," for new projects."]})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Action.OpenUrl"})}),(0,a.jsx)(n.td,{children:"External navigation"}),(0,a.jsx)(n.td,{children:"Open a URL in the user's browser."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Action.ShowCard"})}),(0,a.jsx)(n.td,{children:"Progressive disclosure"}),(0,a.jsx)(n.td,{children:"Display a nested card when clicked."})]}),(0,a.jsxs)(n.tr,{children:[(0,a.jsx)(n.td,{children:(0,a.jsx)(n.code,{children:"Action.ToggleVisibility"})}),(0,a.jsx)(n.td,{children:"UI state management"}),(0,a.jsx)(n.td,{children:"Show/hide card elements dynamically."})]})]})]}),"\n",(0,a.jsx)(n.admonition,{type:"info",children:(0,a.jsxs)(n.p,{children:["For complete reference, see the ",(0,a.jsx)(n.a,{href:"https://adaptivecards.microsoft.com/?topic=Action.Execute",children:"official documentation"}),"."]})}),"\n",(0,a.jsx)(n.h2,{id:"creating-actions-with-the-sdk",children:"Creating Actions with the SDK"}),"\n",(0,a.jsx)(n.h3,{id:"single-actions",children:"Single Actions"}),"\n",(0,a.jsx)(n.p,{children:"The SDK provides builder helpers that abstract the underlying JSON. For example:"}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'using Microsoft.Teams.Cards;\n\nvar action = new ExecuteAction\n{\n    Title = "Submit Feedback",\n    Data = new Union<string, SubmitActionData>(new SubmitActionData\n    {\n        NonSchemaProperties = new Dictionary<string, object?>\n        {\n            { "action", "submit_feedback" }\n        }\n    }),\n    AssociatedInputs = AssociatedInputs.Auto\n};\n'})})}),"\n",(0,a.jsx)(n.h3,{id:"action-sets",children:"Action Sets"}),"\n",(0,a.jsxs)(n.p,{children:["Group actions together using ",(0,a.jsx)(n.code,{children:"ActionSet"}),":"]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'using Microsoft.Teams.Cards;\n\nvar card = new AdaptiveCard\n{\n    Schema = "http://adaptivecards.io/schemas/adaptive-card.json",\n    Actions = new List<Microsoft.Teams.Cards.Action>\n    {\n        new ExecuteAction\n        {\n            Title = "Submit Feedback",\n            Data = new Union<string, SubmitActionData>(new SubmitActionData\n            {\n                NonSchemaProperties = new Dictionary<string, object?>\n                {\n                    { "action", "submit_feedback" }\n                }\n            })\n        },\n        new OpenUrlAction("https://adaptivecards.microsoft.com")\n        {\n            Title = "Learn More"\n        }\n    }\n};\n'})})}),"\n",(0,a.jsx)(n.h3,{id:"raw-json-alternative",children:"Raw JSON Alternative"}),"\n",(0,a.jsxs)(n.p,{children:["Just like when building cards, if you prefer to work with raw JSON, you can do just that. ",(0,a.jsxs)(r.A,{language:"csharp",children:[(0,a.jsx)(n.strong,{children:'[Dev] Section "json-safety-note" not found in C# documentation.'})," Either mark the section explicitly as N/A for intentionally ignored, or fill in documentation."]})]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'var actionJson = """\n{\n  "type": "Action.OpenUrl",\n  "url": "https://adaptivecards.microsoft.com",\n  "title": "Learn More"\n}\n""";\nvar action = OpenUrlAction.Deserialize(actionJson);\n'})})}),"\n",(0,a.jsx)(n.h2,{id:"working-with-input-values",children:"Working with Input Values"}),"\n",(0,a.jsx)(n.h3,{id:"associating-data-with-the-cards",children:"Associating data with the cards"}),"\n",(0,a.jsxs)(n.p,{children:["Sometimes you want to send a card and have it be associated with some data. Set the ",(0,a.jsx)(n.code,{children:"data"})," value to be sent back to the client so you can associate it with a particular entity."]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'private static AdaptiveCard CreateProfileCard()\n{\n    return new AdaptiveCard\n    {\n        Schema = "http://adaptivecards.io/schemas/adaptive-card.json",\n        Body = new List<CardElement>\n        {\n            new TextBlock("User Profile")\n            {\n                Weight = TextWeight.Bolder,\n                Size = TextSize.Large\n            },\n            new TextInput\n            {\n                Id = "name",\n                Label = "Name",\n                Value = "John Doe"\n            },\n            new TextInput\n            {\n                Id = "email",\n                Label = "Email",\n                Value = "john@contoso.com"\n            },\n            new ToggleInput("Subscribe to newsletter")\n            {\n                Id = "subscribe",\n                Value = "false"\n            }\n        },\n        Actions = new List<Microsoft.Teams.Cards.Action>\n        {\n            new ExecuteAction\n            {\n                Title = "Save",\n                // entity_id will come back after the user submits\n                Data = new Union<string, SubmitActionData>(new SubmitActionData\n                {\n                    NonSchemaProperties = new Dictionary<string, object?>\n                    {\n                        { "action", "save_profile" },\n                        { "entity_id", "12345" }\n                    }\n                }),\n                AssociatedInputs = AssociatedInputs.Auto\n            }\n        }\n    };\n}\n\n// Data received in handler (conceptual structure)\n/*\n{\n  "action": "save_profile",\n  "entity_id": "12345",     // From action data\n  "name": "John Doe",       // From name input\n  "email": "john@doe.com",  // From email input\n  "subscribe": "true"       // From toggle input (as string)\n}\n\nAccessed in C# as:\n- data["action"] \u2192 "save_profile"\n- data["entity_id"] \u2192 "12345"\n- data["name"] \u2192 "John Doe"\n- data["email"] \u2192 "john@doe.com"\n- data["subscribe"] \u2192 "true"\n*/\n'})})}),"\n",(0,a.jsx)(n.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,a.jsxs)(n.p,{children:["Input Controls provide ways for you to validate. More details can be found on the Adaptive Cards ",(0,a.jsx)(n.a,{href:"https://adaptivecards.microsoft.com/?topic=input-validation",children:"documentation"}),"."]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'private static AdaptiveCard CreateProfileCardWithValidation()\n{\n    return new AdaptiveCard\n    {\n        Schema = "http://adaptivecards.io/schemas/adaptive-card.json",\n        Body = new List<CardElement>\n        {\n            new TextBlock("Profile with Validation")\n            {\n                Weight = TextWeight.Bolder,\n                Size = TextSize.Large\n            },\n            new NumberInput\n            {\n                Id = "age",\n                Label = "Age",\n                IsRequired = true,\n                Min = 0,\n                Max = 120\n            },\n            // Can configure custom error messages\n            new TextInput\n            {\n                Id = "name",\n                Label = "Name",\n                IsRequired = true,\n                ErrorMessage = "Name is required"\n            },\n            new TextInput\n            {\n                Id = "location",\n                Label = "Location"\n            }\n        },\n        Actions = new List<Microsoft.Teams.Cards.Action>\n        {\n            new ExecuteAction\n            {\n                Title = "Save",\n                // All inputs should be validated\n                Data = new Union<string, SubmitActionData>(new SubmitActionData\n                {\n                    NonSchemaProperties = new Dictionary<string, object?>\n                    {\n                        { "action", "save_profile" }\n                    }\n                }),\n                AssociatedInputs = AssociatedInputs.Auto\n            }\n        }\n    };\n}\n'})})}),"\n",(0,a.jsx)(n.h2,{id:"server-handlers",children:"Server Handlers"}),"\n",(0,a.jsx)(n.h3,{id:"basic-structure",children:"Basic Structure"}),"\n",(0,a.jsxs)(n.p,{children:["Card actions arrive as ",(0,a.jsx)(n.code,{children:"card.action"})," activities in your app. These give you access to the validated input values plus any ",(0,a.jsx)(n.code,{children:"data"})," values you had configured to be sent back to you."]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-csharp",children:'using System.Text.Json;\nusing Microsoft.Teams.Api.Activities.Invokes.AdaptiveCards;\nusing Microsoft.Teams.Apps;\nusing Microsoft.Teams.Apps.Annotations;\nusing Microsoft.Teams.Common.Logging;\n\n//...\n\n[Microsoft.Teams.Apps.Activities.Invokes.AdaptiveCard.Action]\npublic async Task<ActionResponse> OnCardAction([Context] ActionActivity activity, [Context] IContext.Client client, [Context] ILogger log)\n{\n    log.Info("[CARD_ACTION] Card action received");\n\n    var data = activity.Value?.Action?.Data;\n\n    if (data == null)\n    {\n        log.Error("[CARD_ACTION] No data in card action");\n        return new ActionResponse.Message("No data specified") { StatusCode = 400 };\n    }\n\n    // Extract action from the Value property\n    string? action = data.TryGetValue("action", out var actionObj) ? actionObj?.ToString() : null;\n\n    if (string.IsNullOrEmpty(action))\n    {\n        log.Error("[CARD_ACTION] No action specified in card data");\n        return new ActionResponse.Message("No action specified") { StatusCode = 400 };\n    }\n\n    log.Info($"[CARD_ACTION] Processing action: {action}");\n\n    // Helper method to extract form field values\n    string? GetFormValue(string key)\n    {\n        if (data.TryGetValue(key, out var val))\n        {\n            if (val is JsonElement element)\n                return element.GetString();\n            return val?.ToString();\n        }\n        return null;\n    }\n\n    switch (action)\n    {\n        case "submit_feedback":\n            var feedbackText = GetFormValue("feedback") ?? "No feedback provided";\n            await client.Send($"Feedback received: {feedbackText}");\n            break;\n\n        case "save_profile":\n            var name = GetFormValue("name") ?? "Unknown";\n            var email = GetFormValue("email") ?? "No email";\n            var subscribe = GetFormValue("subscribe") ?? "false";\n            await client.Send($"Profile saved!\\nName: {name}\\nEmail: {email}\\nSubscribed: {subscribe}");\n            break;\n\n        case "create_task":\n            var title = GetFormValue("title") ?? "Untitled";\n            var priority = GetFormValue("priority") ?? "medium";\n            var dueDate = GetFormValue("due_date") ?? "No date";\n            await client.Send($"Task created!\\nTitle: {title}\\nPriority: {priority}\\nDue: {dueDate}");\n            break;\n\n        default:\n            log.Error($"[CARD_ACTION] Unknown action: {action}");\n            return new ActionResponse.Message("Unknown action") { StatusCode = 400 };\n    }\n\n    return new ActionResponse.Message("Action processed successfully") { StatusCode = 200 };\n}\n'})})}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(n.admonition,{type:"note",children:(0,a.jsxs)(n.p,{children:["The ",(0,a.jsx)(n.code,{children:"data"})," values come from JSON and need to be extracted using the helper method shown above to handle different JSON element types."]})})})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(u,{...e})}):u(e)}},43023:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var i=t(63696);const a={},s=i.createContext(a);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);