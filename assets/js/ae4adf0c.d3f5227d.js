"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[3133],{10864:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>g,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"typescript/in-depth-guides/feedback","title":"Feedback","description":"\x3c!--","source":"@site/docs/main/typescript/in-depth-guides/feedback.mdx","sourceDirName":"typescript/in-depth-guides","slug":"/typescript/in-depth-guides/feedback","permalink":"/teams-sdk/typescript/in-depth-guides/feedback","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/in-depth-guides/feedback.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Feedback","sidebar_label":"Feedback","summary":"Guide to implementing user feedback functionality in Teams applications, covering feedback UI components, event handling, and storage mechanisms for gathering and managing user responses to improve application performance."},"sidebar":"default","previous":{"title":"Executing Functions","permalink":"/teams-sdk/typescript/in-depth-guides/tabs/functions/function-calling"},"next":{"title":"Observability","permalink":"/teams-sdk/typescript/in-depth-guides/observability/"}}');var s=t(62540),a=t(43023),d=t(26802);const c={sidebar_position:7,title:"Feedback",sidebar_label:"Feedback",summary:"Guide to implementing user feedback functionality in Teams applications, covering feedback UI components, event handling, and storage mechanisms for gathering and managing user responses to improve application performance."},o="Feedback",r={},l=[{value:"Storage",id:"storage",level:2},{value:"Including Feedback Buttons",id:"including-feedback-buttons",level:2},{value:"Handling the feedback",id:"handling-the-feedback",level:2}];function p(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"feedback",children:"Feedback"})}),"\n",(0,s.jsx)(n.p,{children:"User feedback is essential for the improvement of any application. Teams provides specialized UI components to help facilitate the gathering of feedback from users."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Animated image showing user selecting the thumbs-up button on an agent response and a dialog opening asking &#39;What did you like?&#39;. The user types &#39;Nice&#39; and hits Submit.",src:t(51733).A+"",width:"1638",height:"1224"})}),"\n",(0,s.jsx)(n.h2,{id:"storage",children:"Storage"}),"\n",(0,s.jsx)(n.p,{children:"Once you receive a feedback event, you can choose to store it in some persistent storage. In the example below, we are storing it in an in-memory store."}),"\n",(0,s.jsx)(d.A,{language:"typescript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { ChatPrompt, IChatModel } from '@microsoft/teams.ai';\nimport { ActivityLike, IMessageActivity, MessageActivity } from '@microsoft/teams.api';\n// ...\n\n// This store would ideally be persisted in a database\nexport const storedFeedbackByMessageId = new Map<\n  string,\n  {\n    incomingMessage: string;\n    outgoingMessage: string;\n    likes: number;\n    dislikes: number;\n    feedbacks: string[];\n  }\n>();\n"})})}),"\n",(0,s.jsx)(n.h2,{id:"including-feedback-buttons",children:"Including Feedback Buttons"}),"\n",(0,s.jsx)(n.p,{children:"When sending a message that you want feedback in, simply add feedback functionality to the message you are sending."}),"\n",(0,s.jsx)(d.A,{language:"typescript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { ChatPrompt, IChatModel } from '@microsoft/teams.ai';\nimport {\n  ActivityLike,\n  IMessageActivity,\n  MessageActivity,\n  SentActivity,\n} from '@microsoft/teams.api';\n// ...\n\nconst { id: sentMessageId } = await send(\n  result.content != null\n    ? new MessageActivity(result.content)\n        .addAiGenerated()\n        /** Add feedback buttons via this method */\n        .addFeedback()\n    : 'I did not generate a response.'\n);\n\nstoredFeedbackByMessageId.set(sentMessageId, {\n  incomingMessage: activity.text,\n  outgoingMessage: result.content ?? '',\n  likes: 0,\n  dislikes: 0,\n  feedbacks: [],\n});\n"})})}),"\n",(0,s.jsx)(n.h2,{id:"handling-the-feedback",children:"Handling the feedback"}),"\n",(0,s.jsx)(n.p,{children:"Once the user decides to like/dislike the message, you can handle the feedback in a received event. Once received, you can choose to include it in your persistent store."}),"\n",(0,s.jsx)(d.A,{language:"typescript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"import { App } from '@microsoft/teams.apps';\n// ...\n\napp.on('message.submit.feedback', async ({ activity, log }) => {\n  const { reaction, feedback: feedbackJson } = activity.value.actionValue;\n  if (activity.replyToId == null) {\n    log.warn(`No replyToId found for messageId ${activity.id}`);\n    return;\n  }\n  const existingFeedback = storedFeedbackByMessageId.get(activity.replyToId);\n  /**\n   * feedbackJson looks like:\n   * {\"feedbackText\":\"Nice!\"}\n   */\n  if (!existingFeedback) {\n    log.warn(`No feedback found for messageId ${activity.id}`);\n  } else {\n    storedFeedbackByMessageId.set(activity.id, {\n      ...existingFeedback,\n      likes: existingFeedback.likes + (reaction === 'like' ? 1 : 0),\n      dislikes: existingFeedback.dislikes + (reaction === 'dislike' ? 1 : 0),\n      feedbacks: [...existingFeedback.feedbacks, feedbackJson],\n    });\n  }\n});\n"})})})]})}function g(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},26802:(e,n,t)=>{t.d(n,{A:()=>a});var i=t(22147),s=t(62540);function a({language:e,children:n}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>d,x:()=>c});var i=t(63696);const s={},a=i.createContext(s);function d(e){const n=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),i.createElement(a.Provider,{value:n},e.children)}},51733:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/feedback-6cd52f3d98ce1439c8e07122dc448fa2.gif"}}]);