"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[1157],{43023:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>r});var a=n(63696);const s={},o=a.createContext(s);function i(e){const t=a.useContext(o);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),a.createElement(o.Provider,{value:t},e.children)}},77907:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>i,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"why","title":"Why An SDK?","description":"Before getting into the basics, it\'s important to understand how an SDK can be helpful when building an agent application. For this, it\'s a good exercise to understand the basic messaging and event flow of a Teams agent application.","source":"@site/docs/main/why.md","sourceDirName":".","slug":"/why","permalink":"/teams-sdk/why","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/why.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"summary":"Explanation of why an SDK is beneficial for building Teams agent applications, covering event handling and proactive messaging patterns.","llms":"ignore"},"sidebar":"default","previous":{"title":"\ud83d\udc4b Welcome","permalink":"/teams-sdk/welcome"},"next":{"title":"Teams Integration","permalink":"/teams-sdk/teams/"}}');var s=n(62540),o=n(43023);const i={sidebar_position:1,summary:"Explanation of why an SDK is beneficial for building Teams agent applications, covering event handling and proactive messaging patterns.",llms:"ignore"},r="Why An SDK?",l={},c=[];function p(e){const t={a:"a",em:"em",h1:"h1",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"why-an-sdk",children:"Why An SDK?"})}),"\n",(0,s.jsx)(t.p,{children:"Before getting into the basics, it's important to understand how an SDK can be helpful when building an agent application. For this, it's a good exercise to understand the basic messaging and event flow of a Teams agent application."}),"\n",(0,s.jsx)(t.hr,{}),"\n",(0,s.jsx)(t.p,{children:"An agent application is mainly able to do two things:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Listen to events and respond to them"}),"\n",(0,s.jsx)(t.li,{children:"Proactively send messages to the user"}),"\n"]}),"\n",(0,s.jsx)(t.mermaid,{value:'flowchart LR\n    Teams([Teams])\n    InputEvents["Input Events"]\n    OutputEvents["Output Events"]\n    Application(["Your application"])\n\n    Teams --\x3e InputEvents\n    OutputEvents --\x3e Teams\n    InputEvents --\x3e Application\n    Application --\x3e OutputEvents\n\n    %% Styling for dark/light compatibility\n    style Teams fill:#2E86AB,stroke:#1B4F72,stroke-width:2px,color:#ffffff\n    style Application fill:#28B463,stroke:#1D8348,stroke-width:2px,color:#ffffff'}),"\n",(0,s.jsx)(t.p,{children:"To do this, we already need a few components:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsx)(t.li,{children:"A public facing URL to our agent application - This is so that the Teams backend knows where to send messages to when an interesting event happens."}),"\n",(0,s.jsx)(t.li,{children:"A unique identifier for our agent application - Teams doesn't like to pass around this URL everywhere. Instead it hides this information behind a unique ID. This way, if your URL changes, all you need to do is update the URL and keep the ID the same."}),"\n",(0,s.jsx)(t.li,{children:"A way to authenticate to and from the Teams backend - This public facing URL may get hit in many different ways. We need some protections to make sure that the only messages that reach our main application are authenticated."}),"\n"]}),"\n",(0,s.jsx)(t.mermaid,{value:'flowchart LR\n    Start("Start")\n    Teams([Teams])\n    PublicFacingUrl["Public Facing Endpoint"]\n    TeamsURL["Teams Endpoint"]\n    AuthInput["Authentication"]\n    AuthOutput["Authentication"]\n    InputEvents["Input Events"]\n    OutputEvents["Output Events"]\n    Application(["Your application logic"])\n\n    Start --\x3e Teams\n    subgraph TeamsEcosystem["Teams Ecosystem"]\n        Teams --\x3e InputEvents\n    end\n    subgraph App["Application with Unique Id"]\n        InputEvents --\x3e PublicFacingUrl\n        PublicFacingUrl --\x3e AuthInput --\x3e Application\n        Application -.-> AuthOutput\n        AuthOutput -.-> OutputEvents\n    end\n    subgraph TeamsEcosystem["Teams Ecosystem"]\n        OutputEvents --\x3e TeamsURL --\x3e Teams\n    end\n\n    %% Styling for dark/light compatibility\n    style Teams fill:#2E86AB,stroke:#1B4F72,stroke-width:2px,color:#ffffff\n    style Application fill:#28B463,stroke:#1D8348,stroke-width:2px,color:#ffffff'}),"\n",(0,s.jsxs)(t.p,{children:["Next, once a request is successfully authenticated, there is a ",(0,s.jsx)(t.em,{children:"slew"})," of possible types of events that can be sent to your agent application. User messages, user reactions, installation events, Adaptive Card actions, dialog actions, and more. All of these get to your application through a single public door - the public facing URL. Not only this, but different types of events may expect a particular type of response back. For example, a message event may expect a text response or an Adaptive Card response, while a reaction event may not expect a response at all."]}),"\n",(0,s.jsx)(t.p,{children:"Now, it's possible for your own application to handle all the nuances with these events, but that would be a lot of work, and a lot of boilerplate code. Think, a gigantic switch statement at the very least."}),"\n",(0,s.jsx)(t.mermaid,{value:'block-beta\n    columns 5\n    block:InputEventsGroup:2\n        columns 1\n        InputEvents("Input Events"):1\n        block:group2:1\n            columns 2\n            UserMessaged\n            UserReacted\n            FormSubmitted\n            Etc1["..."]\n        end\n    end\n    space:1\n    block:AppHandlersGroup:2\n        columns 1\n        Handlers("Application Handlers"):1\n        block:group4:1\n            columns 2\n            UserMessageH["User Messaged<br/>handler"]\n            UserReactedH["User Reacted<br/>handler"]\n            FormSubmittedH["Form Submitted<br/>handler"]\n            Etc2["..."]\n        end\n    end\n    InputEventsGroup --\x3e AppHandlersGroup'}),"\n",(0,s.jsx)(t.p,{children:"Next, if you wanted to send messages to the user, you would need to make sure each call to the Teams backend is authenticated appropriately for your application."}),"\n",(0,s.jsxs)(t.p,{children:["If your application wanted additional data from ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/graph/overview",children:"Microsoft Graph"}),", you would need to authenticate to that as well. Additionally, if you wanted the ",(0,s.jsx)(t.em,{children:"user"})," to authenticate and query Graph on their behalf, you would have to set up a solution to do the OAuth flow as well. For these complex flows, Teams offers a solution, but you must adhere to specific protocols and patterns to facilitate them."]}),"\n",(0,s.jsx)(t.mermaid,{value:'block-beta\n    columns 4\n    space:2\n    block:userAuth:2\n        columns 4\n        Graph:1\n        Github:1\n        Google:1\n        Etc["..."]:1\n        space:4\n        UserAuth["User OAuth/SSO"]:4\n        UserAuth--\x3eGraph\n        UserAuth--\x3eGithub\n        UserAuth--\x3eGoogle\n        UserAuth--\x3eEtc\n    end\n    block:events:2\n        columns 2\n        blockArrowInput<["InputEvents"]>(right)\n        InputAuthentication["Input Auth"]\n        blockArrowOutput<["OutputEvents"]>(left)\n        OutputAuthentication["Output Auth"]\n    end\n\n    Application:2\n\n    style Application fill:#28B463,stroke:#1D8348,stroke-width:2px,color:#ffffff'}),"\n",(0,s.jsx)(t.p,{children:"As you can see, there are a lot of moving parts to building a Teams agent application. This is where the SDK comes in. The SDK abstracts away all of the boilerplate code and provides you with a simple interface to work with. It handles all the authentication, routing, and event handling for you, so you can focus on building your application."})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);