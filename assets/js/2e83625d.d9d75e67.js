"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[148],{26802:(e,t,n)=>{n.d(t,{A:()=>i});var s=n(22147),a=n(62540);function i({language:e,children:t}){return(0,s.zy)().pathname.includes(`/${e}/`)?(0,a.jsx)(a.Fragment,{children:t}):null}},32966:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/ai-generated-4e395fdfb9e9e45530ff8287046727b2.gif"},43023:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var s=n(63696);const a={},i=s.createContext(a);function r(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),s.createElement(i.Provider,{value:t},e.children)}},84102:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>l,frontMatter:()=>o,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"csharp/in-depth-guides/ai/best-practices","title":"Best Practices","description":"\x3c!--","source":"@site/docs/main/csharp/in-depth-guides/ai/best-practices.mdx","sourceDirName":"csharp/in-depth-guides/ai","slug":"/csharp/in-depth-guides/ai/best-practices","permalink":"/teams-sdk/csharp/in-depth-guides/ai/best-practices","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/csharp/in-depth-guides/ai/best-practices.mdx","tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_position":5,"sidebar_label":"Best Practices","title":"Best Practices","summary":"Best practices for AI integration in Teams applications, including AI-generated message indicators, feedback collection for prompt improvement, and citation handling to ensure transparency and accuracy in AI responses."},"sidebar":"default","previous":{"title":"Keeping State","permalink":"/teams-sdk/csharp/in-depth-guides/ai/keeping-state"},"next":{"title":"MCP","permalink":"/teams-sdk/csharp/in-depth-guides/ai/mcp/"}}');var a=n(62540),i=n(43023),r=n(26802);const o={sidebar_position:5,sidebar_label:"Best Practices",title:"Best Practices",summary:"Best practices for AI integration in Teams applications, including AI-generated message indicators, feedback collection for prompt improvement, and citation handling to ensure transparency and accuracy in AI responses."},c="Best Practices",d={},h=[{value:"AI-Generated Indicator",id:"ai-generated-indicator",level:2},{value:"Gather feedback to improve prompts",id:"gather-feedback-to-improve-prompts",level:2},{value:"Citations",id:"citations",level:2},{value:"Suggested actions",id:"suggested-actions",level:2}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"best-practices",children:"Best Practices"})}),"\n",(0,a.jsx)(t.p,{children:"When sending messages using AI, Teams recommends a number of best practices to help with both user and developer experience."}),"\n",(0,a.jsx)(t.h2,{id:"ai-generated-indicator",children:"AI-Generated Indicator"}),"\n",(0,a.jsxs)(t.p,{children:["When sending messages using AI, Teams recommends including an indicator that the message was generated by AI. ",(0,a.jsxs)(r.A,{language:"csharp",children:["This can be done by calling the ",(0,a.jsx)(t.code,{children:".AddAIGenerated()"})," method on outgoing messages."]})," This will help users understand that the message was generated by AI, and not by a human and can help with trust and transparency."]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'var messageActivity = new MessageActivity\n{\n    Text = "Hello!",\n}.AddAIGenerated();\n'})})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Screenshot of outgoing agent message to user marked with &#39;AI generated&#39; badge.",src:n(32966).A+"",width:"352",height:"162"})}),"\n",(0,a.jsx)(t.h2,{id:"gather-feedback-to-improve-prompts",children:"Gather feedback to improve prompts"}),"\n",(0,a.jsxs)(t.p,{children:["AI Generated messages are not always perfect. Prompts can have gaps, and can sometimes lead to unexpected results. To help improve the prompts, Teams recommends gathering feedback from users on the AI-generated messages. See ",(0,a.jsx)(t.a,{href:"../feedback",children:"Feedback"})," for more information on how to gather feedback."]}),"\n",(0,a.jsx)(t.p,{children:"This does involve thinking through a pipeline for gathering feedback and then automatically, or manually, updating prompts based on the feedback. The feedback system is an point of entry to your eval pipeline."}),"\n",(0,a.jsx)(t.h2,{id:"citations",children:"Citations"}),"\n",(0,a.jsxs)(t.p,{children:["AI generated messages can hallucinate even if messages are grounded in real data. To help with this, Teams recommends including citations in the AI Generated messages. ",(0,a.jsxs)(r.A,{language:"csharp",children:["This is easy to do by using the ",(0,a.jsx)(t.code,{children:"AddCitation"})," method on the message."]})]}),"\n",(0,a.jsx)(t.admonition,{type:"warning",children:(0,a.jsxs)(t.p,{children:["Citations are added with a ",(0,a.jsx)(t.code,{children:"position"})," property. This property value needs to also be included in the message text as ",(0,a.jsx)(t.code,{children:"[<position>]"}),". If there is a citation that's added without the associated value in the message text, Teams will not render the citation"]})}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'var messageActivity = new MessageActivity\n{\n    Text = result.Content,\n}.AddAIGenerated();\n\nfor (int i = 0; i < citedDocs.Length; i++)\n{\n    messageActivity.Text += $"[{i + 1}]";\n    messageActivity.AddCitation(i + 1, new CitationAppearance\n    {\n        Name = citedDocs[i].Title,\n        Abstract = citedDocs[i].Content\n    });\n}\n'})})}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Animated screenshot showing user hovering over a footnote citation in agent response, and a pop-up showing explanatory text.",src:n(86687).A+"",width:"580",height:"302"})}),"\n",(0,a.jsx)(t.h2,{id:"suggested-actions",children:"Suggested actions"}),"\n",(0,a.jsxs)(t.p,{children:["Suggested actions help users with ideas of what to ask next, based on the previous response or conversation. Teams recommends including suggested actions in your messages. ",(0,a.jsxs)(r.A,{language:"csharp",children:["You can do that by using the ",(0,a.jsx)(t.code,{children:"WithSuggestedActions"})," method on the message."]})," See ",(0,a.jsx)(t.a,{href:"https://learn.microsoft.com/microsoftteams/platform/bots/how-to/conversations/prompt-suggestions",children:"Suggested actions"})," for more information on suggested actions."]}),"\n",(0,a.jsx)(r.A,{language:"csharp",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-csharp",children:'var message = new MessageActivity\n{\n    Text = result.Content,\n}.WithSuggestedActions(\n    new Microsoft.Teams.Api.SuggestedActions() {\n        To = [context.Activity.From.Id],\n        Actions = [\n            new Microsoft.Teams.Api.Cards.Action(ActionType.IMBack) {\n                Title = "Thank you!",\n                Value = "Thank you very much!"\n                }\n        ]\n    }).AddAIGenerated();\nawait context.Send(message);\n'})})})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},86687:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/citation-2db1c9550d1d3fb8f73a8194ba776ad6.gif"}}]);