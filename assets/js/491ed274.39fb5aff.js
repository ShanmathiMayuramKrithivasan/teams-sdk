"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[2627],{26802:(e,s,n)=>{n.d(s,{A:()=>a});var t=n(22147),i=n(62540);function a({language:e,children:s}){return(0,t.zy)().pathname.includes(`/${e}/`)?(0,i.jsx)(i.Fragment,{children:s}):null}},27023:(e,s,n)=>{n.d(s,{A:()=>t});const t=n.p+"assets/images/streaming-chat-d49edc84e71626c46703881e19aef8c2.gif"},43023:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>d});var t=n(63696);const i={},a=t.createContext(i);function r(e){const s=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function d(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),t.createElement(a.Provider,{value:s},e.children)}},53902:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>c,default:()=>g,frontMatter:()=>d,metadata:()=>t,toc:()=>l});const t=JSON.parse('{"id":"typescript/essentials/sending-messages/index","title":"Sending Messages","description":"\x3c!--","source":"@site/docs/main/typescript/essentials/sending-messages/index.mdx","sourceDirName":"typescript/essentials/sending-messages","slug":"/typescript/essentials/sending-messages/","permalink":"/teams-sdk/typescript/essentials/sending-messages/","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/essentials/sending-messages/index.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"summary":"Guide to sending messages from your Teams SDK agent, including replies, proactive messages, and different message types.","title":"Sending Messages"},"sidebar":"default","previous":{"title":"App Authentication","permalink":"/teams-sdk/typescript/essentials/app-authentication"},"next":{"title":"Proactive Messaging","permalink":"/teams-sdk/typescript/essentials/sending-messages/proactive-messaging"}}');var i=n(62540),a=n(43023),r=n(26802);const d={sidebar_position:4,summary:"Guide to sending messages from your Teams SDK agent, including replies, proactive messages, and different message types.",title:"Sending Messages"},c="Sending Messages",o={},l=[{value:"Streaming",id:"streaming",level:2},{value:"@Mention",id:"mention",level:2},{value:"Targeted Messages",id:"targeted-messages",level:2},{value:"Errors",id:"errors",level:2}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.header,{children:(0,i.jsx)(s.h1,{id:"sending-messages",children:"Sending Messages"})}),"\n",(0,i.jsxs)(s.p,{children:["Sending messages is a core part of an agent's functionality. With all activity handlers, a ",(0,i.jsx)(s.code,{children:"send"})," method is provided which allows your handlers to send a message back to the user to the relevant conversation."]}),"\n",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"app.on('message', async ({ activity, send }) => {\n  await send(`You said: ${activity.text}`);\n});\n"})})}),"\n",(0,i.jsxs)(s.p,{children:["In the above example, the handler gets a ",(0,i.jsx)(s.code,{children:"message"})," activity, and uses the ",(0,i.jsx)(s.code,{children:"send"})," method to send a reply to the user."]}),"\n",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"app.on('signin.verify-state', async ({ send }) => {\n  await send('You have successfully signed in!');\n});\n"})})}),"\n",(0,i.jsxs)(s.p,{children:["You are not restricted to only replying to ",(0,i.jsx)(s.code,{children:"message"})," activities. In the above example, the handler is listening to ",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.code,{children:"signin.verify-state"})})," events, which are sent when a user successfully signs in."]}),"\n",(0,i.jsx)(s.admonition,{type:"tip",children:(0,i.jsxs)(s.p,{children:["This shows an example of sending a text message. Additionally, you are able to send back things like ",(0,i.jsx)(s.a,{href:"../../in-depth-guides/adaptive-cards",children:"adaptive cards"})," by using the same ",(0,i.jsx)(s.code,{children:"send"})," method. Look at the ",(0,i.jsx)(s.a,{href:"../../in-depth-guides/adaptive-cards",children:"adaptive card"})," section for more details."]})}),"\n",(0,i.jsx)(s.h2,{id:"streaming",children:"Streaming"}),"\n",(0,i.jsxs)(s.p,{children:["You may also stream messages to the user which can be useful for long messages, or AI generated messages. The SDK makes this simple for you by providing a ",(0,i.jsx)(s.code,{children:"stream"})," function which you can use to send messages in chunks."]}),"\n",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"app.on('message', async ({ activity, stream }) => {\n  stream.emit('hello');\n  stream.emit(', ');\n  stream.emit('world!');\n\n  // result message: \"hello, world!\"\n});\n"})})}),"\n",(0,i.jsx)(s.admonition,{type:"note",children:(0,i.jsx)(s.p,{children:"Streaming is currently only supported in 1:1 conversations, not group chats or channels"})}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Animated image showing agent response text incrementally appearing in the chat window.",src:n(27023).A+"",width:"2006",height:"804"})}),"\n",(0,i.jsx)(s.h2,{id:"mention",children:"@Mention"}),"\n",(0,i.jsxs)(s.p,{children:["Sending a message at ",(0,i.jsx)(s.code,{children:"@mentions"})," a user is as simple including the details of the user using the ",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.code,{children:"addMention"})})," method"]}),"\n",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"app.on('message', async ({ send, activity }) => {\n  await send(new MessageActivity('hi!').addMention(activity.from));\n});\n"})})}),"\n",(0,i.jsx)(s.h2,{id:"targeted-messages",children:"Targeted Messages"}),"\n",(0,i.jsx)(s.admonition,{title:"Preview Feature",type:"info",children:(0,i.jsx)(s.p,{children:"Targeted messages are currently in preview."})}),"\n",(0,i.jsxs)(s.p,{children:["Targeted messages allow you to send messages privately to a specific recipient in a conversation.\nTo send a targeted message, use the ",(0,i.jsx)(s.code,{children:"isTargeted"})," parameter in your ",(0,i.jsx)(s.code,{children:"send"})," method:"]}),"\n",(0,i.jsx)(r.A,{language:"typescript",children:(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-typescript",children:"app.on('message', async ({ send, activity }) => {\n  // Send a targeted message that only the sender can see\n  await send('This message is only visible to you!', { isTargeted: true });\n});\n"})})}),"\n",(0,i.jsxs)(r.A,{language:"csharp",children:[(0,i.jsx)(s.h2,{id:"errors",children:"Errors"}),(0,i.jsx)(s.p,{children:"The following table lists errors that may be returned when sending messages."}),(0,i.jsxs)(s.table,{children:[(0,i.jsx)(s.thead,{children:(0,i.jsxs)(s.tr,{children:[(0,i.jsx)(s.th,{children:"Error"}),(0,i.jsx)(s.th,{children:"Description"})]})}),(0,i.jsxs)(s.tbody,{children:[(0,i.jsxs)(s.tr,{children:[(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"InvalidOperationException"}),(0,i.jsx)("br",{}),(0,i.jsx)(s.code,{children:"app not started"})]}),(0,i.jsxs)(s.td,{children:["The app has not been started. Call ",(0,i.jsx)(s.code,{children:"await app.Start()"})," before sending messages or using proactive messaging."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"ArgumentException"}),(0,i.jsx)("br",{}),(0,i.jsx)(s.code,{children:"activity.Recipient is required for targeted messages"})]}),(0,i.jsxs)(s.td,{children:["When using ",(0,i.jsx)(s.code,{children:"isTargeted: true"}),", the ",(0,i.jsx)(s.code,{children:"Recipient"})," property must be set on the activity to specify who should receive the private message."]})]}),(0,i.jsxs)(s.tr,{children:[(0,i.jsxs)(s.td,{children:[(0,i.jsx)(s.code,{children:"Exception"}),(0,i.jsx)("br",{}),(0,i.jsx)(s.code,{children:"no plugin that can send activities was found"})]}),(0,i.jsx)(s.td,{children:"No sender plugin is configured. Ensure a sender plugin (like AspNetCorePlugin) is added to the app."})]})]})]})]})]})}function g(e={}){const{wrapper:s}={...(0,a.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}}}]);