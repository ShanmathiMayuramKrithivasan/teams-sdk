"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[6712],{26802:(e,n,t)=>{t.d(n,{A:()=>o});var i=t(22147),s=t(62540);function o({language:e,children:n}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>a,x:()=>r});var i=t(63696);const s={},o=i.createContext(s);function a(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),i.createElement(o.Provider,{value:n},e.children)}},56252:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"python/in-depth-guides/ai/mcp/mcp-client","title":"MCP Client","description":"\x3c!--","source":"@site/docs/main/python/in-depth-guides/ai/mcp/mcp-client.mdx","sourceDirName":"python/in-depth-guides/ai/mcp","slug":"/python/in-depth-guides/ai/mcp/mcp-client","permalink":"/teams-sdk/python/in-depth-guides/ai/mcp/mcp-client","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/in-depth-guides/ai/mcp/mcp-client.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"MCP Client","title":"MCP Client","summary":"How to implement an MCP client to leverage remote MCP servers and their tools in your AI agent application."},"sidebar":"default","previous":{"title":"MCP Server","permalink":"/teams-sdk/python/in-depth-guides/ai/mcp/mcp-server"},"next":{"title":"A2A Protocol","permalink":"/teams-sdk/python/in-depth-guides/ai/a2a/"}}');var s=t(62540),o=t(43023),a=t(26802);const r={sidebar_position:2,sidebar_label:"MCP Client",title:"MCP Client",summary:"How to implement an MCP client to leverage remote MCP servers and their tools in your AI agent application."},l="MCP Client",c={},h=[{value:"Remote MCP Server",id:"remote-mcp-server",level:2},{value:"MCP Client Plugin",id:"mcp-client-plugin",level:2},{value:"Authentication with Headers",id:"authentication-with-headers",level:2},{value:"Using MCP Client in Message Handlers",id:"using-mcp-client-in-message-handlers",level:2}];function p(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"mcp-client",children:"MCP Client"})}),"\n",(0,s.jsxs)(n.p,{children:["You are able to leverage other MCP servers that expose tools via the ",(0,s.jsx)(a.A,{language:"python",children:"SSE protocol"})," as part of your application. This allows your AI agent to use remote tools to accomplish tasks."]}),"\n",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'[Dev] Section "install" not found in Python documentation.'})," Either mark the section explicitly as N/A for intentionally ignored, or fill in documentation."]})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Take a look at ",(0,s.jsx)(n.a,{href:"../function-calling",children:"Function calling"})," to understand how the ",(0,s.jsx)(n.code,{children:"ChatPrompt"})," leverages tools to enhance the LLM's capabilities. MCP extends this functionality by allowing remote tools, that may or may not be developed or maintained by you, to be used by your application."]})}),"\n",(0,s.jsx)(n.h2,{id:"remote-mcp-server",children:"Remote MCP Server"}),"\n",(0,s.jsxs)(n.p,{children:["The first thing that's needed is access to a ",(0,s.jsx)(n.strong,{children:"remote"})," MCP server. MCP Servers (at present) come using two main types protocols:"]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["StandardIO - This is a ",(0,s.jsx)(n.em,{children:"local"})," MCP server, which runs on your machine. An MCP client may connect to this server, and use standard input and outputs to communicate with it. Since our application is running remotely, this is not something that we want to use"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(a.A,{language:"python",children:"StreamableHttp/SSE"})," - This is a ",(0,s.jsx)(n.em,{children:"remote"})," MCP server. An MCP client may\nsend it requests and the server responds in the expected MCP protocol."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For hooking up to your ",(0,s.jsx)(a.A,{language:"python",children:"a valid SSE"})," server, you will need to know the URL of the server, and if applicable, ",(0,s.jsx)(a.A,{language:"python",children:"any keys"})," that must be included as part of the header."]}),"\n",(0,s.jsx)(n.h2,{id:"mcp-client-plugin",children:"MCP Client Plugin"}),"\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsx)(n.code,{children:"McpClientPlugin"})})," integrates directly with the ",(0,s.jsx)(n.code,{children:"ChatPrompt"})," ",(0,s.jsx)(a.A,{language:"python",children:"as a plugin"}),". When the ",(0,s.jsx)(n.code,{children:"ChatPrompt"}),"'s ",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsx)(n.code,{children:"send"})})," function is called, it calls the external MCP server and loads up all the tools that are available to it."]}),"\n",(0,s.jsxs)(n.p,{children:["Once loaded, it treats these tools like any functions that are available to the ",(0,s.jsx)(n.code,{children:"ChatPrompt"})," object. If the LLM then decides to call one of these remote MCP tools, the MCP Client plugin will call the remote MCP server and return the result back to the LLM. The LLM can then use this result in its response."]}),"\n",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from microsoft_teams.ai import ChatPrompt\nfrom microsoft_teams.mcpplugin import McpClientPlugin\nfrom microsoft_teams.openai import OpenAICompletionsAIModel\n# ...\n\n# Set up AI model\ncompletions_model = OpenAICompletionsAIModel(model="gpt-4")\n\n# Configure MCP Client Plugin with multiple remote servers\nmcp_plugin = McpClientPlugin()\n\n# Add multiple MCP servers\nmcp_plugin.use_mcp_server("https://learn.microsoft.com/api/mcp")\nmcp_plugin.use_mcp_server("https://example.com/mcp/weather")\nmcp_plugin.use_mcp_server("https://example.com/mcp/pokemon")\n\n# ChatPrompt with MCP tools\nchat_prompt = ChatPrompt(\n    completions_model,\n    plugins=[mcp_plugin]\n)\n'})})}),"\n",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'[Dev] Section "custom-headers" not found in Python documentation.'})," Either mark the section explicitly as N/A for intentionally ignored, or fill in documentation."]})}),"\n",(0,s.jsxs)(a.A,{language:"python",children:[(0,s.jsxs)(n.p,{children:["In this example, we augment the ",(0,s.jsx)(n.code,{children:"ChatPrompt"})," with multiple remote MCP Servers."]}),(0,s.jsx)(n.h2,{id:"authentication-with-headers",children:"Authentication with Headers"}),(0,s.jsx)(n.p,{children:"Many MCP servers require authentication via headers (such as API keys or Bearer tokens). You can pass these headers when configuring your MCP server:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from os import getenv\nfrom microsoft_teams.mcpplugin import McpClientPlugin, McpClientPluginParams\n# ...\n\n# This example uses a PersonalAccessToken, but you may get\n# the user\'s oauth token as well by getting them to sign in\n# and then using app.sign_in to get their token.\nGITHUB_PAT = getenv("GITHUB_PAT")\n\n# MCP server with authentication headers\nif GITHUB_PAT:\n    mcp_plugin.use_mcp_server(\n        "https://api.githubcopilot.com/mcp/",\n        McpClientPluginParams(headers={\n            "Authorization": f"Bearer {GITHUB_PAT}",\n        })\n    )\n\n# Other authentication examples:\nmcp_plugin.use_mcp_server(\n    "https://example.com/api/mcp",\n    McpClientPluginParams(headers={\n        "X-API-Key": getenv(\'API_KEY\'),\n        "Custom-Header": "custom-value"\n    })\n)\n'})}),(0,s.jsx)(n.p,{children:"Headers are passed with every request to the MCP server, enabling secure access to authenticated APIs."}),(0,s.jsx)(n.h2,{id:"using-mcp-client-in-message-handlers",children:"Using MCP Client in Message Handlers"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from microsoft_teams.ai import ChatPrompt\nfrom microsoft_teams.api import MessageActivity, MessageActivityInput\nfrom microsoft_teams.apps import ActivityContext\n# ...\n\n@app.on_message\nasync def handle_message(ctx: ActivityContext[MessageActivity]):\n    """Handle messages using ChatPrompt with MCP tools"""\n\n    result = await chat_prompt.send(\n        input=ctx.activity.text,\n        instructions="You are a helpful assistant with access to remote MCP tools."\n    )\n\n    if result.response.content:\n        message = MessageActivityInput(text=result.response.content).add_ai_generated()\n        await ctx.send(message)\n'})})]}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.p,{children:["Feel free to build an MCP Server in a different agent using the ",(0,s.jsx)(n.a,{href:"./mcp-server",children:"MCP Server Guide"}),". Or you can quickly set up an MCP server using ",(0,s.jsx)(n.a,{href:"https://techcommunity.microsoft.com/blog/appsonazureblog/build-ai-agent-tools-using-remote-mcp-with-azure-functions/4401059",children:"Azure Functions"}),"."]})}),"\n",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Animated image of user typing a prompt (&#39;Tell me about Charizard&#39;) to DevTools Chat window and multiple paragraphs of information being returned.",src:t(65368).A+"",width:"874",height:"720"})})}),"\n",(0,s.jsx)(a.A,{language:"python",children:(0,s.jsxs)(n.p,{children:["In this example, our MCP server is a Pokemon API and our client knows how to call it. The LLM is able to call the ",(0,s.jsx)(n.code,{children:"getPokemon"})," function exposed by the server and return the result back to the user."]})})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},65368:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/mcp-client-pokemon-b37c9fe6f433ede5bb0ad4f03ffe69c6.gif"}}]);