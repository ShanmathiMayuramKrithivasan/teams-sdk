"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[8658],{43023:(e,t,n)=>{n.d(t,{R:()=>p,x:()=>o});var s=n(63696);const i={},a=s.createContext(i);function p(e){const t=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:p(e.components),s.createElement(a.Provider,{value:t},e.children)}},67704:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>p,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"typescript/in-depth-guides/tabs/using-the-app","title":"Using the App","description":"\x3c!--","source":"@site/docs/main/typescript/in-depth-guides/tabs/using-the-app.mdx","sourceDirName":"typescript/in-depth-guides/tabs","slug":"/typescript/in-depth-guides/tabs/using-the-app","permalink":"/teams-sdk/typescript/in-depth-guides/tabs/using-the-app","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/in-depth-guides/tabs/using-the-app.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Using the App","summary":"Initialize and use the Teams client App to call Graph APIs and remote agent functions.","languages":["typescript"],"suppressLanguageIncludeWarning":true},"sidebar":"default","previous":{"title":"Getting Started","permalink":"/teams-sdk/typescript/in-depth-guides/tabs/getting-started"},"next":{"title":"App Options","permalink":"/teams-sdk/typescript/in-depth-guides/tabs/app-options"}}');var i=n(62540),a=n(43023);const p={sidebar_position:2,title:"Using the App",summary:"Initialize and use the Teams client App to call Graph APIs and remote agent functions.",languages:["typescript"],suppressLanguageIncludeWarning:!0},o="Using The App",r={},c=[{value:"What happens during start",id:"what-happens-during-start",level:2},{value:"Using the app",id:"using-the-app-1",level:2}];function l(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"using-the-app",children:"Using The App"})}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"@microsoft/teams.client"})," App class helps solve common challenges when building Single Page Applications hosted in Microsoft Teams, Outlook, and Microsoft 365. It is the client-side counterpart to the ",(0,i.jsx)(t.code,{children:"@microsoft/teams.app"})," App that you can use to build AI agents."]}),"\n",(0,i.jsxs)(t.p,{children:["These two App classes are designed to work well together. For instance, when you use the ",(0,i.jsx)(t.code,{children:"@microsoft/teams.app"})," App to expose a server-side function, you can then use the ",(0,i.jsx)(t.code,{children:"@microsoft/teams.client"})," App ",(0,i.jsx)(t.code,{children:"exec"})," method to easily invoke that function, as the client-side app knows how to construct an HTTP request that the server-side app can process. It can issue a request to the right URL, with the expected payload and contextual headers. The client-side app even includes a bearer token that the server side app uses to authenticate the caller."]}),"\n",(0,i.jsx)(t.h1,{id:"starting-the-app",children:"Starting the app"}),"\n",(0,i.jsxs)(t.p,{children:["To use the ",(0,i.jsx)(t.code,{children:"@microsoft/teams.client"})," package, you first create an App instance and then call ",(0,i.jsx)(t.code,{children:"app.start()"}),"."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"import { App } from '@microsoft/teams.client';\n\nconst app = new App(clientId);\nawait app.start();\n"})}),"\n",(0,i.jsx)(t.p,{children:"The app constructor strives to make it easy to get started on a new app, while still being flexible enough that it can integrate easily with existing apps."}),"\n",(0,i.jsxs)(t.p,{children:["The constructor takes two arguments: a required app client ID, and an optional ",(0,i.jsx)(t.code,{children:"AppOptions"})," argument. The app client ID is the AAD app registration ",(0,i.jsx)(t.strong,{children:"Application (client) ID"}),". The options can be used to customize observability, Microsoft Authentication Library (MSAL) configuration, and\nremote agent function calling."]}),"\n",(0,i.jsxs)(t.p,{children:["For more details on the app options, see the ",(0,i.jsx)(t.a,{href:"./app-options",children:"App options"})," page."]}),"\n",(0,i.jsx)(t.h2,{id:"what-happens-during-start",children:"What happens during start"}),"\n",(0,i.jsx)(t.p,{children:"The app constructor does the following:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"it creates an app logger, if none is provided in the app options."}),"\n",(0,i.jsx)(t.li,{children:"it creates an http client used to call the remote agent."}),"\n",(0,i.jsx)(t.li,{children:"it creates a graph client that can be used as soon as the app is started."}),"\n"]}),"\n",(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"app.start()"})," call does the following:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"it initializes TeamsJS."}),"\n",(0,i.jsx)(t.li,{children:"it creates an MSAL instance, if none is provided in the app options."}),"\n",(0,i.jsx)(t.li,{children:"it connects the MSAL instance to the graph client."}),"\n",(0,i.jsx)(t.li,{children:"it prompts the user for MSAL token consent, if needed and if pre-warming is not disabled through the app options."}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"using-the-app-1",children:"Using the app"}),"\n",(0,i.jsxs)(t.p,{children:["When the ",(0,i.jsx)(t.code,{children:"app.start()"})," call has completed, you can use the app instance to call Graph APIs and to call remote agent functions using the ",(0,i.jsx)(t.code,{children:"exec()"})," function, or directly by using the ",(0,i.jsx)(t.code,{children:"app.http"})," HTTP client. TeamsJS is now initialized, so you can interact with the hosting app. The ",(0,i.jsx)(t.code,{children:"app.msalInstance"})," is now populated, in case you need to use the same MSAL for other purposes."]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-typescript",children:"import * as teamsJs from '@microsoft/teams-js';\nimport { App } from '@microsoft/teams.client';\nimport * as endpoints from '@microsoft/teams.graph-endpoints';\n\nconst app = new App(clientId);\nawait app.start();\n\n// you can now get the TeamsJS context...\nconst context = await teamsJs.app.getContext();\n\n// ...call Graph end points...\nconst presenceResult = await app.graph.call(endpoints.me.presence.get);\n\n// ...and call remote agent functions...\nconst agentResult = await app.exec<string>('hello-world');\n"})})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);