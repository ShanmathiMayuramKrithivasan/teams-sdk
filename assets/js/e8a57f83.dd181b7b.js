"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[3618],{22491:(e,n,t)=>{t.d(n,{A:()=>r});t(63696);var a=t(11750);const s={tabItem:"tabItem_wHwb"};var i=t(62540);function r({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.A)(s.tabItem,t),hidden:n,children:e})}},26802:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(22147),s=t(62540);function i({language:e,children:n}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var a=t(63696);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},52580:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>d,default:()=>g,frontMatter:()=>c,metadata:()=>a,toc:()=>p});const a=JSON.parse('{"id":"csharp/getting-started/code-basics","title":"Code Basics","description":"\x3c!--","source":"@site/docs/main/csharp/getting-started/code-basics.mdx","sourceDirName":"csharp/getting-started","slug":"/csharp/getting-started/code-basics","permalink":"/teams-sdk/csharp/getting-started/code-basics","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/csharp/getting-started/code-basics.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Code Basics","title":"Code Basics","summary":"Understanding the structure and key components of a Teams SDK application including the Application class, dependency injection, and project organization."},"sidebar":"default","previous":{"title":"Quickstart","permalink":"/teams-sdk/csharp/getting-started/quickstart"},"next":{"title":"Running in Teams","permalink":"/teams-sdk/csharp/getting-started/running-in-teams/"}}');var s=t(62540),i=t(43023),r=t(26802),l=t(78296),o=t(22491);const c={sidebar_position:2,sidebar_label:"Code Basics",title:"Code Basics",summary:"Understanding the structure and key components of a Teams SDK application including the Application class, dependency injection, and project organization."},d="Code Basics",u={},p=[{value:"Project Structure",id:"project-structure",level:2},{value:"Core Components",id:"core-components",level:2},{value:"The App Class",id:"the-app-class",level:3},{value:"Plugins",id:"plugins",level:3},{value:"Message Handling",id:"message-handling",level:3},{value:"Application Lifecycle",id:"application-lifecycle",level:3},{value:"Next Steps",id:"next-steps",level:2},{value:"Other Resources",id:"other-resources",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(r.A,{language:"csharp"}),"\n",(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"code-basics",children:"Code Basics"})}),"\n",(0,s.jsxs)(n.p,{children:["After following the guidance in ",(0,s.jsx)(n.a,{href:"quickstart",children:"the quickstart"})," to create your first Teams application, let's review its structure and key components. This knowledge can help you build more complex applications as you progress."]}),"\n",(0,s.jsx)(n.h2,{id:"project-structure",children:"Project Structure"}),"\n",(0,s.jsx)(n.p,{children:"When you create a new Teams application, it generates a directory with this basic structure:"}),"\n",(0,s.jsx)(r.A,{language:"csharp",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Quote.Agent/\n|\u2500\u2500 appPackage/       # Teams app package files\n\u251c\u2500\u2500 Program.cs        # Main application startup code\n\u251c\u2500\u2500 MainController.cs # Main activity handling code\n"})})}),"\n",(0,s.jsx)(r.A,{language:"csharp",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"appPackage/"}),": Contains the Teams app package files, including the ",(0,s.jsx)(n.code,{children:"manifest.json"})," file and icons. This is required for ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoftteams/platform/concepts/deploy-and-publish/apps-upload",children:"sideloading"})," the app into Teams for testing. The app manifest defines the app's metadata, capabilities, and permissions."]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"core-components",children:"Core Components"}),"\n",(0,s.jsxs)(n.p,{children:["Let's break down the simple application from the ",(0,s.jsx)(n.a,{href:"quickstart",children:"quickstart"})," into its core components."]}),"\n",(0,s.jsx)(n.h3,{id:"the-app-class",children:"The App Class"}),"\n",(0,s.jsxs)(n.p,{children:["The heart of an application is the ",(0,s.jsx)(n.code,{children:"App"})," class. This class handles all incoming activities and manages the application's lifecycle. It also acts as a way to host your application service."]}),"\n",(0,s.jsx)(r.A,{language:"csharp",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="Program.cs"',children:"using Microsoft.Teams.Plugins.AspNetCore.DevTools.Extensions;\nusing Microsoft.Teams.Plugins.AspNetCore.Extensions;\n\nusing Quote.Agent;\n\nvar builder = WebApplication.CreateBuilder(args);\nbuilder.AddTeams();\nbuilder.AddTeamsDevTools();\nbuilder.Services.AddTransient<MainController>();\n\nvar app = builder.Build();\napp.UseTeams();\napp.Run();\n"})})}),"\n",(0,s.jsx)(n.p,{children:"The app configuration includes a variety of options that allow you to customize its behavior, including controlling the underlying server, authentication, and other settings."}),"\n",(0,s.jsx)(n.h3,{id:"plugins",children:"Plugins"}),"\n",(0,s.jsxs)(n.p,{children:["Plugins are a core part of the Teams SDK. They allow you to hook into various lifecycles of the application. The lifecycles include server events (start, stop, initialize, etc.), and also Teams Activity events ",(0,s.jsx)(r.A,{language:"csharp",children:"(onActivity, onActivitySent, etc.)"}),". In fact, the ",(0,s.jsx)(n.a,{href:"/developer-tools/devtools",children:"DevTools"})," application you already have running is a plugin too. It allows you to inspect and debug your application in real-time."]}),"\n",(0,s.jsxs)(n.admonition,{type:"warning",children:[(0,s.jsx)(n.p,{children:"DevTools is a plugin that should only be used in development mode. It should not be used in production applications since it offers no authentication and allows your application to be accessed by anyone."}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Be sure to remove the DevTools plugin from your production code."})})]}),"\n",(0,s.jsx)(n.h3,{id:"message-handling",children:"Message Handling"}),"\n",(0,s.jsx)(n.p,{children:"Teams applications respond to various types of activities. The most basic is handling messages:"}),"\n",(0,s.jsx)(r.A,{language:"csharp",children:(0,s.jsxs)(l.A,{children:[(0,s.jsx)(o.A,{label:"Controller",value:"controller",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="MainController.cs"',children:'[TeamsController("main")]\npublic class MainController\n{\n    [Message]\n    public async Task OnMessage([Context] MessageActivity activity, [Context] IContext.Client client)\n    {\n        await client.Typing();\n        await client.Send($"you said \\"{activity.Text}\\"");\n    }\n}\n'})})}),(0,s.jsx)(o.A,{label:"Minimal",value:"minimal",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",metastring:'title="Program.cs"',children:'app.OnMessage(async context =>\n{\n    await context.Typing();\n    await context.Send($"you said \\"{context.activity.Text}\\"");\n});\n'})})})]})}),"\n",(0,s.jsx)(n.p,{children:"This code:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(r.A,{language:"csharp",children:["Listens for all incoming messages using ",(0,s.jsx)(n.code,{children:"[Message]"})," attribute."]}),"\n"]}),"\n",(0,s.jsx)(n.li,{children:"Sends a typing indicator, which renders as an animated ellipsis (\u2026) in the chat."}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(r.A,{language:"csharp",children:"Responds by echoing back the received message."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(r.A,{language:"csharp",children:(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Each activity type has both an attribute and a functional method for type safety/simplicity\nof routing logic!"})})}),"\n",(0,s.jsx)(n.h3,{id:"application-lifecycle",children:"Application Lifecycle"}),"\n",(0,s.jsx)(n.p,{children:"Your application starts when you run:"}),"\n",(0,s.jsx)(r.A,{language:"csharp",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-csharp",children:"var app = builder.Build();\napp.UseTeams();\napp.Run();\n"})})}),"\n",(0,s.jsx)(n.p,{children:"This code initializes your application server and, when configured for Teams, also authenticates it to be ready for sending and receiving messages."}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.p,{children:["Now that you understand the basic structure of your Teams application, you're ready to ",(0,s.jsx)(n.a,{href:"running-in-teams",children:"run it in Teams"}),". You will learn about Microsoft 365 Agents Toolkit and other important tools that help you with deployment and testing your application."]}),"\n",(0,s.jsx)(n.p,{children:"After that, you can:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add more activity handlers for different types of interactions. See ",(0,s.jsx)(n.a,{href:"../essentials/on-activity",children:"Listening to Activities"})," for more details."]}),"\n",(0,s.jsxs)(n.li,{children:["Integrate with external services using the ",(0,s.jsx)(n.a,{href:"../essentials/api",children:"API Client"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Add interactive ",(0,s.jsx)(n.a,{href:"../in-depth-guides/adaptive-cards",children:"cards"})," and ",(0,s.jsx)(n.a,{href:"../in-depth-guides/dialogs",children:"dialogs"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Implement ",(0,s.jsx)(n.a,{href:"../in-depth-guides/ai",children:"AI"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Continue on to the next page to learn about these advanced features."}),"\n",(0,s.jsx)(n.h2,{id:"other-resources",children:"Other Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"../essentials",children:"Essentials"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/teams",children:"Teams concepts"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/developer-tools",children:"Teams developer tools"})}),"\n"]})]})}function g(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},78296:(e,n,t)=>{t.d(n,{A:()=>A});var a=t(63696),s=t(11750),i=t(53237),r=t(90766),l=t(22147),o=t(14395),c=t(35043),d=t(44544),u=t(41506);function p(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return p(e).map((({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a})))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function g({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const t=(0,l.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=h(e),[r,l]=(0,a.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!g({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[c,d]=m({queryString:t,groupId:s}),[p,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,u.Dv)(n);return[t,(0,a.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:s}),x=(()=>{const e=c??p;return g({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{x&&l(x)}),[x]);return{selectedValue:r,selectValue:(0,a.useCallback)((e=>{if(!g({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);l(e),d(e),f(e)}),[d,f,i]),tabValues:i}}var x=t(86681);const v={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var b=t(62540);function j({className:e,block:n,selectedValue:t,selectValue:a,tabValues:i}){const l=[],{blockElementScrollPositionUntilNextRender:o}=(0,r.a_)(),c=e=>{const n=e.currentTarget,s=l.indexOf(n),r=i[s].value;r!==t&&(o(n),a(r))},d=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=l.indexOf(e.currentTarget)+1;n=l[t]??l[0];break}case"ArrowLeft":{const t=l.indexOf(e.currentTarget)-1;n=l[t]??l[l.length-1];break}}n?.focus()};return(0,b.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:i.map((({value:e,label:n,attributes:a})=>(0,b.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{l.push(e)},onKeyDown:d,onClick:c,...a,className:(0,s.A)("tabs__item",v.tabItem,a?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function y({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find((e=>e.props.value===t));return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,b.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function T(e){const n=f(e);return(0,b.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",v.tabList),children:[(0,b.jsx)(j,{...n,...e}),(0,b.jsx)(y,{...n,...e})]})}function A(e){const n=(0,x.A)();return(0,b.jsx)(T,{...e,children:p(e.children)},String(n))}}}]);