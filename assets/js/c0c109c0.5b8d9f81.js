"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[6130],{22491:(e,n,t)=>{t.d(n,{A:()=>r});t(63696);var a=t(11750);const s={tabItem:"tabItem_wHwb"};var i=t(62540);function r({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.A)(s.tabItem,t),hidden:n,children:e})}},26802:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(22147),s=t(62540);function i({language:e,children:n}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},41722:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"typescript/migrations/v1","title":"Migrating from Teams SDK v1","description":"\x3c!--","source":"@site/docs/main/typescript/migrations/v1.mdx","sourceDirName":"typescript/migrations","slug":"/typescript/migrations/v1","permalink":"/teams-sdk/typescript/migrations/v1","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/migrations/v1.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Migrating from Teams SDK v1","languages":["typescript","python"],"summary":"Migration guide from Teams SDK v1 to v2 highlighting the key changes and upgrade steps."},"sidebar":"default","previous":{"title":"User Authentication","permalink":"/teams-sdk/typescript/migrations/botbuilder/user-authentication"},"next":{"title":"From V2 Previews","permalink":"/teams-sdk/typescript/migrations/v2-previews"}}');var s=t(62540),i=t(43023),r=t(26802),o=t(78296),c=t(22491);const l={sidebar_position:2,title:"Migrating from Teams SDK v1",languages:["typescript","python"],summary:"Migration guide from Teams SDK v1 to v2 highlighting the key changes and upgrade steps."},d="Migrating from Teams SDK v1",p={},u=[{value:"Installing Teams SDK",id:"installing-teams-sdk",level:2},{value:"Migrate Application class",id:"migrate-application-class",level:2},{value:"Migrate activity handlers",id:"migrate-activity-handlers",level:2},{value:"Message handlers",id:"message-handlers",level:3},{value:"Task modules",id:"task-modules",level:3},{value:"Adaptive cards",id:"adaptive-cards",level:2},{value:"Authentication",id:"authentication",level:2},{value:"AI",id:"ai",level:2},{value:"Action planner",id:"action-planner",level:3},{value:"Feedback",id:"feedback",level:3},{value:"Incrementally migrating code via botbuilder plugin",id:"incrementally-migrating-code-via-botbuilder-plugin",level:2}];function g(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"migrating-from-teams-sdk-v1",children:"Migrating from Teams SDK v1"})}),"\n",(0,s.jsxs)(n.p,{children:["Welcome, fellow agent developer! You've made it through a full major release of Teams SDK, and now you want to take the plunge into v2. In this guide, we'll walk you through everything you need to know, from migrating core features like message handlers and auth, to optional AI features like ",(0,s.jsx)(n.code,{children:"ActionPlanner"}),". ",(0,s.jsxs)(r.A,{language:"typescript",children:["We'll also discuss how you can migrate features over incrementally via the ",(0,s.jsx)(n.a,{href:"./botbuilder",children:"botbuilder adapter"}),"."]})]}),"\n",(0,s.jsx)(n.h2,{id:"installing-teams-sdk",children:"Installing Teams SDK"}),"\n",(0,s.jsxs)(r.A,{language:"typescript",children:[(0,s.jsxs)(n.p,{children:["First, let's install Teams SDK into your project. Notably, this won't replace any existing installation of Teams SDK. When you've completed your migration, you can safely remove the ",(0,s.jsx)(n.code,{children:"@microsoft/teams-ai"})," dependency from your ",(0,s.jsx)(n.code,{children:"package.json"})," file."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"npm install @microsoft/teams.apps\n"})})]}),"\n",(0,s.jsx)(n.h2,{id:"migrate-application-class",children:"Migrate Application class"}),"\n",(0,s.jsxs)(n.p,{children:["First, migrate your ",(0,s.jsx)(n.code,{children:"Application"})," class from v1 to the new ",(0,s.jsx)(n.code,{children:"App"})," class."]}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// highlight-error-start\n-    import {\n-      ConfigurationServiceClientCredentialFactory,\n-      MemoryStorage,\n-      TurnContext,\n-    } from 'botbuilder';\n-    import { Application, TeamsAdapter } from '@microsoft/teams-ai';\n-    import * as restify from 'restify';\n// highlight-error-end\n// highlight-success-start\n+    import { App } from '@microsoft/teams.apps';\n+    import { LocalStorage } from '@microsoft/teams.common/storage';\n// highlight-success-end\n\n// highlight-error-start\n\n- // Create adapter.\n- const adapter = new TeamsAdapter(\n-        {},\n-        new ConfigurationServiceClientCredentialFactory({\n-            MicrosoftAppId: process.env.ENTRA_APP_CLIENT_ID,\n-            MicrosoftAppPassword: process.env.ENTRA_APP_CLIENT_SECRET,\n-            MicrosoftAppType: 'SingleTenant',\n-            MicrosoftAppTenantId: process.env.ENTRA_APP_TENANT_ID\n-        })\n- );\n\n- // Catch-all for errors.\n- const onTurnErrorHandler = async (context: TurnContext, error: any) => {\n-        console.error(`\\n [onTurnError] unhandled error: ${error}`);\n-        // Send a message to the user\n-        await context.sendActivity('The bot encountered an error or bug.');\n- };\n\n- // Set the onTurnError for the singleton CloudAdapter.\n- adapter.onTurnError = onTurnErrorHandler;\n\n- // Create HTTP server.\n- const server = restify.createServer();\n- server.use(restify.plugins.bodyParser());\n\n- server.listen(process.env.port || process.env.PORT || 3978, () => {\n-        console.log(`\\n${server.name} listening to ${server.url}`);\n- });\n\n- // Define storage and application\n- const app = new Application<ApplicationTurnState>({\n-        storage: new MemoryStorage()\n- });\n\n- // Listen for incoming server requests.\n- server.post('/api/messages', async (req, res) => {\n-        // Route received a request to adapter for processing\n-        await adapter.process(req, res, async (context) => {\n-            // Dispatch to application for routing\n-            await app.run(context);\n-        });\n- });\n// highlight-error-end\n// highlight-success-start\n\n* // Define app\n* const app = new App({\n*      clientId: process.env.ENTRA_APP_CLIENT_ID!,\n*      clientSecret: process.env.ENTRA_APP_CLIENT_SECRET!,\n*      tenantId: process.env.ENTRA_TENANT_ID!,\n* });\n\n* // Optionally create local storage\n* const storage = new LocalStorage();\n\n* // Listen for errors\n* app.event('error', async (client) => {\n*      console.error('Error event received:', client.error);\n*      if (client.activity) {\n*        await app.send(\n*          client.activity.conversation.id,\n*          'An error occurred while processing your message.',\n*        );\n*      }\n* });\n\n* // App creates local server with route for /api/messages\n* // To reuse your restify or other server,\n* // create a custom `HttpPlugin`.\n* (async () => {\n*      // starts the server\n*      await app.start();\n* })();\n// highlight-success-end\n\n"})})}),(0,s.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { App } from '@microsoft/teams.apps';\nimport { LocalStorage } from '@microsoft/teams.common/storage';\n\n// Define app\nconst app = new App({\n  clientId: process.env.ENTRA_APP_CLIENT_ID!,\n  clientSecret: process.env.ENTRA_APP_CLIENT_SECRET!,\n  tenantId: process.env.ENTRA_TENANT_ID!,\n});\n\n// Optionally create local storage\nconst storage = new LocalStorage();\n\n// Listen for errors\napp.event('error', async (client) => {\n  console.error('Error event received:', client.error);\n  if (client.activity) {\n    await app.send(\n      client.activity.conversation.id,\n      'An error occurred while processing your message.',\n    );\n  }\n});\n\n// App creates local server with route for /api/messages\n// To reuse your restify or other server,\n// create a custom `HttpPlugin`.\n(async () => {\n  // starts the server\n  await app.start();\n})();\n"})})}),(0,s.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import {\n  ConfigurationServiceClientCredentialFactory,\n  MemoryStorage,\n  TurnContext,\n} from 'botbuilder';\nimport { Application, TeamsAdapter } from '@microsoft/teams-ai';\nimport * as restify from 'restify';\n\n// Create adapter.\nconst adapter = new TeamsAdapter(\n    {},\n    new ConfigurationServiceClientCredentialFactory({\n        MicrosoftAppId: process.env.ENTRA_APP_CLIENT_ID,\n        MicrosoftAppPassword: process.env.ENTRA_APP_CLIENT_SECRET,\n        MicrosoftAppType: 'SingleTenant',\n        MicrosoftAppTenantId: process.env.ENTRA_APP_TENANT_ID\n    })\n);\n\n// Catch-all for errors.\nconst onTurnErrorHandler = async (context: TurnContext, error: any) => {\n    console.error(`\\n [onTurnError] unhandled error: ${error}`);\n    // Send a message to the user\n    await context.sendActivity('The bot encountered an error or bug.');\n};\n\n// Set the onTurnError for the singleton CloudAdapter.\nadapter.onTurnError = onTurnErrorHandler;\n\n// Create HTTP server.\nconst server = restify.createServer();\nserver.use(restify.plugins.bodyParser());\n\nserver.listen(process.env.port || process.env.PORT || 3978, () => {\n    console.log(`\\n${server.name} listening to ${server.url}`);\n});\n\n// Define storage and application\nconst app = new Application<ApplicationTurnState>({\n    storage: new MemoryStorage()\n});\n\n// Listen for incoming server requests.\nserver.post('/api/messages', async (req, res) => {\n    // Route received a request to adapter for processing\n    await adapter.process(req, res, async (context) => {\n        // Dispatch to application for routing\n        await app.run(context);\n    });\n});\n"})})})]})}),"\n",(0,s.jsx)(n.h2,{id:"migrate-activity-handlers",children:"Migrate activity handlers"}),"\n",(0,s.jsxs)(n.p,{children:["Both v1 and v2 are built atop incoming ",(0,s.jsx)(n.code,{children:"Activity"})," requests, which trigger handlers in your code when specific type of activities are received. The syntax for how you register different types of ",(0,s.jsx)(n.code,{children:"Activity"})," handlers differs ",(0,s.jsxs)(r.A,{language:"typescript",children:[(0,s.jsx)(n.strong,{children:'[Dev] Section "activity-handlers-intro" not found in TypeScript documentation.'})," Either mark the section explicitly as N/A for intentionally ignored, or fill in documentation."]})," between the v1 and v2 versions of our SDK."]}),"\n",(0,s.jsx)(n.h3,{id:"message-handlers",children:"Message handlers"}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// triggers when user sends "/hi" or "@bot /hi"\n// highlight-error-start\n-    app.message("/hi", async (context) => {\n-      await context.sendActivity("Hi!");\n-    });\n// highlight-error-end\n// highlight-success-start\n+    app.message(\'/hi\', async (client) => {\n+      // SDK does not auto send typing indicators\n+      await client.send({ type: \'typing\' });\n+      await client.send("Hi!");\n+    });\n// highlight-success-end\n// listen for ANY message to be received\n// highlight-error-start\n-    app.activity(\n-      ActivityTypes.Message,\n-      async (context) => {\n-        // echo back users request\n-        await context.sendActivity(\n-          `you said: ${context.activity.text}`\n-        );\n-      }\n-    );\n// highlight-error-end\n// highlight-success-start\n+    app.on(\'message\', async (client) => {\n+      await client.send({ type: \'typing\' });\n+      await client.send(\n+        `you said "${client.activity.text}"`\n+      );\n+    });\n// highlight-success-end\n'})})}),(0,s.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:'// triggers when user sends "/hi" or "@bot /hi"\napp.message("/hi", async (context) => {\n  await context.sendActivity("Hi!");\n});\n// listen for ANY message to be received\napp.activity(\n  ActivityTypes.Message,\n  async (context) => {\n    // echo back users request\n    await context.sendActivity(\n      `you said: ${context.activity.text}`\n    );\n  }\n);\n'})})}),(0,s.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// triggers when user sends \"/hi\" or \"@bot /hi\"\napp.message('/hi', async (client) => {\n  // SDK does not auto send typing indicators\n  await client.send({ type: 'typing' });\n  await client.send(\"Hi!\");\n});\n// listen for ANY message to be received\napp.on('message', async (client) => {\n  await client.send({ type: 'typing' });\n  await client.send(\n    `you said \"${client.activity.text}\"`\n  );\n});\n"})})})]})}),"\n",(0,s.jsx)(n.h3,{id:"task-modules",children:"Task modules"}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:'[Dev] Section "task-modules-note" not found in TypeScript documentation.'})," Either mark the section explicitly as N/A for intentionally ignored, or fill in documentation."]})}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// highlight-error-start\n-    app.taskModules.fetch('connect-account', async (context, state, data) => {\n-      const taskInfo: TaskModuleTaskInfo = {\n-        title: 'Connect your Microsoft 365 account',\n-        height: 'medium',\n-        width: 'medium',\n-        url: `https://${process.env.NEXT_PUBLIC_BOT_DOMAIN}/connections`,\n-        fallbackUrl: `https://${process.env.NEXT_PUBLIC_BOT_DOMAIN}/connections`,\n-        completionBotId: process.env.NEXT_PUBLIC_BOT_ID,\n-      };\n-      return taskInfo;\n-    });\n-    app.taskModules.submit('connect-account', async (context, state, data) => {\n-      console.log(\n-        `bot-app.ts taskModules.submit(\"connect-account\"): data`,\n-        JSON.stringify(data, null, 4)\n-      );\n-      await context.sendActivity('You are all set! Now, how can I help you today?');\n-      return undefined;\n-    });\n// highlight-error-end\n// highlight-success-start\n+    app.on('dialog.open', (client) => {\n+      const dialogType = client.activity.value.data?.opendialogtype;\n+      if (dialogType === 'some-type') {\n+        return {\n+          task: {\n+            type: 'continue',\n+            value: {\n+              title: 'Dialog title',\n+              height: 'medium',\n+              width: 'medium',\n+              url: `https://${process.env.YOUR_WEBSITE_DOMAIN}/some-path`,\n+              fallbackUrl: `https://${process.env.YOUR_WEBSITE_DOMAIN}/fallback-path-for-web`,\n+              completionBotId: process.env.ENTRA_APP_CLIENT_ID!,\n+            },\n+          },\n+        };\n+      }\n+    });\n\n- app.on('dialog.submit', async (client) => {\n-      const dialogType = client.activity.value.data?.submissiondialogtype;\n-      if (dialogType === 'some-type') {\n-        const { data } = client.activity.value;\n-        await client.send(JSON.stringify(data));\n-      }\n-      return undefined;\n- });\n// highlight-success-end\n\n"})})}),(0,s.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"app.on('dialog.open', (client) => {\n  const dialogType = client.activity.value.data?.opendialogtype;\n  if (dialogType === 'some-type') {\n    return {\n      task: {\n        type: 'continue',\n        value: {\n          title: 'Dialog title',\n          height: 'medium',\n          width: 'medium',\n          url: `https://${process.env.YOUR_WEBSITE_DOMAIN}/some-path`,\n          fallbackUrl: `https://${process.env.YOUR_WEBSITE_DOMAIN}/fallback-path-for-web`,\n          completionBotId: process.env.ENTRA_APP_CLIENT_ID!,\n        },\n      },\n    };\n  }\n});\n\napp.on('dialog.submit', async (client) => {\n  const dialogType = client.activity.value.data?.submissiondialogtype;\n  if (dialogType === 'some-type') {\n    const { data } = client.activity.value;\n    await client.send(JSON.stringify(data));\n  }\n  return undefined;\n});\n"})})}),(0,s.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"app.taskModules.fetch('connect-account', async (context, state, data) => {\n  const taskInfo: TaskModuleTaskInfo = {\n    title: 'Connect your Microsoft 365 account',\n    height: 'medium',\n    width: 'medium',\n    url: `https://${process.env.NEXT_PUBLIC_BOT_DOMAIN}/connections`,\n    fallbackUrl: `https://${process.env.NEXT_PUBLIC_BOT_DOMAIN}/connections`,\n    completionBotId: process.env.NEXT_PUBLIC_BOT_ID,\n  };\n  return taskInfo;\n});\napp.taskModules.submit('connect-account', async (context, state, data) => {\n  console.log(\n    `bot-app.ts taskModules.submit(\"connect-account\"): data`,\n    JSON.stringify(data, null, 4)\n  );\n  await context.sendActivity('You are all set! Now, how can I help you today?');\n  return undefined;\n});\n"})})})]})}),"\n",(0,s.jsxs)(n.p,{children:["Learn more in the ",(0,s.jsx)(n.a,{href:"../in-depth-guides/dialogs",children:"Dialogs guide"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"adaptive-cards",children:"Adaptive cards"}),"\n",(0,s.jsx)(n.p,{children:"In Teams SDK v2, cards have much more rich type validation than existed in v1. However, assuming your cards were valid, it should be easy to migrate to v2."}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// highlight-error-start\n-    app.message('/card', async (context: TurnContext) => {\n-      const card = CardFactory.adaptiveCard({\n-        $schema: 'http://adaptivecards.io/schemas/adaptive-card.json',\n-        version: '1.5',\n-        type: 'AdaptiveCard',\n-        body: [\n-          {\n-            type: 'TextBlock',\n-            text: 'Hello, world!',\n-            wrap: true,\n-            isSubtle: false,\n-          },\n-        ],\n-        msteams: {\n-          width: 'Full',\n-        },\n-      });\n-      await context.sendActivity({\n-        attachments: [card],\n-      });\n-    });\n// highlight-error-end\n// highlight-success-start\n+    app.message('/card', async (client) => {\n+      await client.send({\n+        $schema: 'http://adaptivecards.io/schemas/adaptive-card.json',\n+        version: '1.5',\n+        type: 'AdaptiveCard',\n+        body: [\n+          {\n+            type: 'TextBlock',\n+            text: 'Hello, world!',\n+            wrap: true,\n+            isSubtle: false,\n+          },\n+        ],\n+        msteams: {\n+          width: 'Full',\n+        },\n+      });\n+    });\n// highlight-success-end\n"})})}),(0,s.jsxs)(c.A,{value:"v2-option1",label:"Teams SDK v2 (Option 1)",children:[(0,s.jsx)(n.p,{children:"For existing cards like this, the simplest way to convert that to Teams SDK is this:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"app.message('/card', async (client) => {\n  await client.send({\n    $schema: 'http://adaptivecards.io/schemas/adaptive-card.json',\n    version: '1.5',\n    type: 'AdaptiveCard',\n    body: [\n      {\n        type: 'TextBlock',\n        text: 'Hello, world!',\n        wrap: true,\n        isSubtle: false,\n      },\n    ],\n    msteams: {\n      width: 'Full',\n    },\n  });\n});\n"})})]}),(0,s.jsxs)(c.A,{value:"v2-option2",label:"Teams SDK v2 (Option 2)",children:[(0,s.jsx)(n.p,{children:"For a more thorough port, you could also do the following:"}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { Card, TextBlock } from '@microsoft/teams.cards';\n\napp.message('/card', async (client) => {\n  await client.send(\n    new Card(new TextBlock('Hello, world!', { wrap: true, isSubtle: false })).withOptions({\n      width: 'Full',\n    })\n  );\n});\n"})})]}),(0,s.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"app.message('/card', async (context: TurnContext) => {\n  const card = CardFactory.adaptiveCard({\n    $schema: 'http://adaptivecards.io/schemas/adaptive-card.json',\n    version: '1.5',\n    type: 'AdaptiveCard',\n    body: [\n      {\n        type: 'TextBlock',\n        text: 'Hello, world!',\n        wrap: true,\n        isSubtle: false,\n      },\n    ],\n    msteams: {\n      width: 'Full',\n    },\n  });\n  await context.sendActivity({\n    attachments: [card],\n  });\n});\n"})})})]})}),"\n",(0,s.jsxs)(n.p,{children:["Learn more in the ",(0,s.jsx)(n.a,{href:"../in-depth-guides/adaptive-cards",children:"Adaptive Cards guide"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,s.jsx)(n.p,{children:"Most agents feature authentication for user identification, interacting with APIs, etc. Whether your Teams SDK app used Entra SSO or custom OAuth, porting to v2 should be simple."}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// highlight-error-start\n-    const storage = new MemoryStorage();\n-    const app = new Application({\n-      storage: new MemoryStorage(),\n-      authentication: {\n-        autoSignIn: (context) => {\n-          const activity = context.activity;\n-          // No auth when user wants to sign in\n-          if (activity.text === '/signout') {\n-            return Promise.resolve(false);\n-          }\n-          // No auth for \"/help\"\n-          if (activity.text === '/help') {\n-            return Promise.resolve(false);\n-          }\n-          // Manually sign in (for illustrative purposes)\n-          if (activity.text === '/signin') {\n-            return Promise.resolve(false);\n-          }\n-          // For all other messages, require sign in\n-          return Promise.resolve(true);\n-        },\n-        settings: {\n-          graph: {\n-            connectionName: process.env.OAUTH_CONNECTION_NAME!,\n-            title: 'Sign in',\n-            text: 'Please sign in to use the bot.',\n-            endOnInvalidMessage: true,\n-            tokenExchangeUri: process.env.TOKEN_EXCHANGE_URI!,\n-            enableSso: true,\n-          },\n-        },\n-      },\n-    });\n-\n-    app.message('/signout', async (context, state) => {\n-      await app.authentication.signOutUser(context, state);\n-      await context.sendActivity(`You have signed out`);\n-    });\n-\n-    app.message('/help', async (context, state) => {\n-      await context.sendActivity(`your help text`);\n-    });\n-\n-    app.authentication.get('graph').onUserSignInSuccess(async (context, state) => {\n-      await context.sendActivity('Successfully logged in');\n-      await context.sendActivity(`Token string length: ${state.temp.authTokens['graph']!.length}`);\n-    });\n// highlight-error-end\n// highlight-success-start\n+    const app = new App({\n+      oauth: {\n+        defaultConnectionName: 'graph',\n+      },\n+      logger: new ConsoleLogger('@tests/auth', { level: 'debug' }),\n+    });\n+\n+    app.message('/signout', async (client) => {\n+      if (!client.isSignedIn) return;\n+      await client.signout();\n+      await client.send('you have been signed out!');\n+    });\n+\n+    app.message('/help', async (client) => {\n+      await client.send('your help text');\n+    });\n+\n+    app.on('message', async (client) => {\n+      if (!client.isSignedIn) {\n+        await client.signin({\n+          oauthCardText: 'Sign in to your account',\n+          signInButtonText: 'Sign in',\n+        });\n+        return;\n+      }\n+      const me = await client.userGraph.me.get();\n+      log.info(`user \"${me.displayName}\" already signed in!`);\n+    });\n+\n+    app.event('signin', async (client) => {\n+      const me = await client.userGraph.me.get();\n+      await client.send(`user \"${me.displayName}\" signed in.`);\n+      await client.send(`Token string length: ${client.token.token.length}`);\n+    });\n// highlight-success-end\n"})})}),(0,s.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const app = new App({\n  oauth: {\n    // oauth configurations\n    /**\n     * The name of the auth connection to use.\n     * It should be the same as the OAuth connection name defined in the Azure Bot configuration.\n     */\n    defaultConnectionName: 'graph',\n  },\n  logger: new ConsoleLogger('@tests/auth', { level: 'debug' }),\n});\n\napp.message('/signout', async (client) => {\n  if (!client.isSignedIn) return;\n  await client.signout(); // call signout for your auth connection...\n  await client.send('you have been signed out!');\n});\n\napp.message('/help', async (client) => {\n  await client.send('your help text');\n});\n\napp.on('message', async (client) => {\n  if (!client.isSignedIn) {\n    await client.signin({\n      // Customize the OAuth card text (only renders in OAuth flow, not SSO)\n      oauthCardText: 'Sign in to your account',\n      signInButtonText: 'Sign in',\n    }); // call signin for your auth connection...\n    return;\n  }\n\n  const me = await client.userGraph.me.get();\n  log.info(`user \"${me.displayName}\" already signed in!`);\n});\n\napp.event('signin', async (client) => {\n  const me = await client.userGraph.me.get();\n  await client.send(`user \"${me.displayName}\" signed in.`);\n  await client.send(`Token string length: ${client.token.token.length}`);\n});\n"})})}),(0,s.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"const storage = new MemoryStorage();\nconst app = new Application({\n  storage: new MemoryStorage(),\n  authentication: {\n    autoSignIn: (context) => {\n      const activity = context.activity;\n      // No auth when user wants to sign in\n      if (activity.text === '/signout') {\n        return Promise.resolve(false);\n      }\n      // No auth for \"/help\"\n      if (activity.text === '/help') {\n        return Promise.resolve(false);\n      }\n      // Manually sign in (for illustrative purposes)\n      if (activity.text === '/signin') {\n        return Promise.resolve(false);\n      }\n      // For all other messages, require sign in\n      return Promise.resolve(true);\n    },\n    settings: {\n      graph: {\n        connectionName: process.env.OAUTH_CONNECTION_NAME!,\n        title: 'Sign in',\n        text: 'Please sign in to use the bot.',\n        endOnInvalidMessage: true,\n        tokenExchangeUri: process.env.TOKEN_EXCHANGE_URI!,\n        enableSso: true,\n      },\n    },\n  },\n});\n\napp.message('/signout', async (context, state) => {\n  await app.authentication.signOutUser(context, state);\n\n  // Echo back users request\n  await context.sendActivity(`You have signed out`);\n});\n\napp.message('/signin', async (context, state) => {\n  let token = state.temp.authTokens['graph'];\n  if (!token) {\n    const res = await app.authentication.signInUser(context, state);\n    if (res.error) {\n      console.log(res.error);\n      return;\n    }\n    token = state.temp.authTokens['graph'];\n  }\n\n  if (token) {\n    // Echo back users request\n    await context.sendActivity(`You are already authenticated!`);\n    return;\n  }\n\n  // Sign in is pending...\n});\n\napp.message('/help', async (context, state) => {\n  await context.sendActivity(`your help text`);\n});\n\napp.authentication.get('graph').onUserSignInSuccess(async (context, state) => {\n  // Successfully logged in\n  await context.sendActivity('Successfully logged in');\n  await context.sendActivity(`Token string length: ${state.temp.authTokens['graph']!.length}`);\n});\n\napp.authentication.get('graph').onUserSignInFailure(async (context, _state, error) => {\n  // Failed to login\n  await context.sendActivity(`Failed to login with error: ${error.message}`);\n});\n"})})})]})}),"\n",(0,s.jsx)(n.h2,{id:"ai",children:"AI"}),"\n",(0,s.jsxs)(r.A,{language:"typescript",children:[(0,s.jsx)(n.h3,{id:"action-planner",children:"Action planner"}),(0,s.jsxs)(n.p,{children:["When we created Teams SDK, LLM's didn't natively support tool calling or orchestration. A lot has changed since then, which is why we decided to deprecate ",(0,s.jsx)(n.code,{children:"ActionPlanner"})," from Teams SDK, and replace it with something a bit more lightweight. Notably, Teams SDK had two similar concepts: functions and actions. In Teams SDK, these are consolidated into functions."]}),(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// highlight-error-start\n-    // Create AI components\n-    const model = new OpenAIModel({\n-      apiKey: process.env.OPENAI_KEY!,\n-      defaultModel: 'gpt-4o',\n-      logRequests: true,\n-    });\n-\n-    const prompts = new PromptManager({\n-      promptsFolder: path.join(__dirname, '../src/prompts'),\n-    });\n-\n-    // Define a prompt function for getting the current status of the lights\n-    prompts.addFunction('getLightStatus', async (context, memory) => {\n-      return memory.getValue('conversation.lightsOn') ? 'on' : 'off';\n-    });\n-\n-    const planner = new ActionPlanner({\n-      model,\n-      prompts,\n-      defaultPrompt: 'tools',\n-    });\n-\n-    // Define storage and application\n-    const storage = new MemoryStorage();\n-    const app = new Application<ApplicationTurnState>({\n-      storage,\n-      ai: {\n-        planner,\n-      },\n-    });\n-\n-    // Register action handlers\n-    app.ai.action('ToggleLights', async (context, state) => {\n-      state.conversation.lightsOn = !state.conversation.lightsOn;\n-      const lightStatusText = state.conversation.lightsOn ? 'on' : 'off';\n-      await context.sendActivity(`[lights ${lightStatusText}]`);\n-      return `the lights are now ${lightStatusText}$`;\n-    });\n-\n-    app.ai.action('Pause', async (context, state, parameters: PauseParameters) => {\n-      await context.sendActivity(`[pausing for ${parameters.time / 1000} seconds]`);\n-      await new Promise((resolve) => setTimeout(resolve, parameters.time));\n-      return `done pausing`;\n-    });\n// highlight-error-end\n// highlight-success-start\n+    const storage = new LocalStorage<IStorageState>();\n+    const app = new App();\n+\n+    app.on('message', async (client) => {\n+      let state = storage.get(client.activity.from.id);\n+\n+      if (!state) {\n+        state = {\n+          status: false,\n+          messages: [],\n+        };\n+        storage.set(client.activity.from.id, state);\n+      }\n+\n+      const prompt = new ChatPrompt({\n+        messages: state.messages,\n+        instructions: `The assistant can turn a light on or off. The lights are currently off.`,\n+        model: new OpenAIChatModel({\n+          model: 'gpt-4o-mini',\n+          apiKey: process.env.OPENAI_API_KEY,\n+        }),\n+      })\n+        .function('get_light_status', 'get the current light status', () => {\n+          return state.status;\n+        })\n+        .function('toggle_lights', 'toggles the lights on/off', () => {\n+          state.status = !state.status;\n+          storage.set(client.activity.from.id, state);\n+        })\n+        .function(\n+          'pause',\n+          'delays for a period of time',\n+          {\n+            type: 'object',\n+            properties: {\n+              time: {\n+                type: 'number',\n+                description: 'the amount of time to delay in milliseconds',\n+              },\n+            },\n+            required: ['time'],\n+          },\n+          async ({ time }: { time: number }) => {\n+            await new Promise((resolve) => setTimeout(resolve, time));\n+          }\n+        );\n+\n+      await prompt.send(client.activity.text, {\n+        onChunk: (chunk) => {\n+          client.stream.emit(new MessageActivity(chunk));\n+        },\n+      });\n+    });\n// highlight-success-end\n"})})}),(0,s.jsxs)(c.A,{value:"v2",label:"Teams SDK v2",children:[(0,s.jsxs)(n.p,{children:["In Teams SDK, there is no ",(0,s.jsx)(n.code,{children:"actions.json"})," file. Instead, function prompts, parameters, etc. are declared in your code."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import '@azure/openai/types';\nimport { ChatPrompt, Message } from '@microsoft/teams.ai';\nimport { MessageActivity } from '@microsoft/teams.api';\nimport { App } from '@microsoft/teams.apps';\nimport { LocalStorage } from '@microsoft/teams.common/storage';\nimport { OpenAIChatModel } from '@microsoft/teams.openai';\n\ninterface IStorageState {\n  status: boolean;\n  messages: Message[];\n}\n\nconst storage = new LocalStorage<IStorageState>();\n\nconst app = new App();\n\napp.on('message', async (client) => {\n  let state = storage.get(client.activity.from.id);\n\n  if (!state) {\n    state = {\n      status: false,\n      messages: [],\n    };\n\n    storage.set(client.activity.from.id, state);\n  }\n\n  const prompt = new ChatPrompt({\n    messages: state.messages,\n    instructions: `The following is a conversation with an AI assistant.\n  The assistant can turn a light on or off.\n  The lights are currently off.`,\n    model: new OpenAIChatModel({\n      model: 'gpt-4o-mini',\n      apiKey: process.env.OPENAI_API_KEY,\n    }),\n  })\n    .function('get_light_status', 'get the current light status', () => {\n      return state.status;\n    })\n    .function('toggle_lights', 'toggles the lights on/off', () => {\n      state.status = !state.status;\n      storage.set(client.activity.from.id, state);\n    })\n    .function(\n      'pause',\n      'delays for a period of time',\n      {\n        type: 'object',\n        properties: {\n          time: {\n            type: 'number',\n            description: 'the amount of time to delay in milliseconds',\n          },\n        },\n        required: ['time'],\n      },\n      async ({ time }: { time: number }) => {\n        await new Promise((resolve) => setTimeout(resolve, time));\n      }\n    );\n\n  await prompt.send(client.activity.text, {\n    onChunk: (chunk) => {\n      client.stream.emit(new MessageActivity(chunk));\n    },\n  });\n});\n\n(async () => {\n  await app.start();\n})();\n"})})]}),(0,s.jsxs)(c.A,{value:"v1",label:"Teams SDK v1",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// Create AI components\nconst model = new OpenAIModel({\n  // OpenAI Support\n  apiKey: process.env.OPENAI_KEY!,\n  defaultModel: 'gpt-4o',\n\n  // Azure OpenAI Support\n  azureApiKey: process.env.AZURE_OPENAI_KEY!,\n  azureDefaultDeployment: 'gpt-4o',\n  azureEndpoint: process.env.AZURE_OPENAI_ENDPOINT!,\n  azureApiVersion: '2023-03-15-preview',\n\n  // Request logging\n  logRequests: true,\n});\n\nconst prompts = new PromptManager({\n  promptsFolder: path.join(__dirname, '../src/prompts'),\n});\n\n// Define a prompt function for getting the current status of the lights\nprompts.addFunction('getLightStatus', async (context, memory) => {\n  return memory.getValue('conversation.lightsOn') ? 'on' : 'off';\n});\n\nconst planner = new ActionPlanner({\n  model,\n  prompts,\n  defaultPrompt: 'tools',\n});\n\n// Define storage and application\nconst storage = new MemoryStorage();\nconst app = new Application<ApplicationTurnState>({\n  storage,\n  ai: {\n    planner,\n  },\n});\n\n// Register action handlers\napp.ai.action('ToggleLights', async (context, state) => {\n  state.conversation.lightsOn = !state.conversation.lightsOn;\n  const lightStatusText = state.conversation.lightsOn ? 'on' : 'off';\n  await context.sendActivity(`[lights ${lightStatusText}]`);\n  return `the lights are now ${lightStatusText}$`;\n});\n\ninterface PauseParameters {\n  time: number;\n}\n\napp.ai.action('Pause', async (context, state, parameters: PauseParameters) => {\n  await context.sendActivity(`[pausing for ${parameters.time / 1000} seconds]`);\n  await new Promise((resolve) => setTimeout(resolve, parameters.time));\n  return `done pausing`;\n});\n\n// Listen for incoming server requests.\nserver.post('/api/messages', async (req, res) => {\n  // Route received a request to adapter for processing\n  await adapter.process(req, res as any, async (context) => {\n    // Dispatch to application for routing\n    await app.run(context);\n  });\n});\n"})}),(0,s.jsxs)(n.p,{children:["And the corresponding ",(0,s.jsx)(n.code,{children:"actions.json"})," file:"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "name": "ToggleLights",\n    "description": "Turns on/off the lights"\n  },\n  {\n    "name": "Pause",\n    "description": "Delays for a period of time",\n    "parameters": {\n      "type": "object",\n      "properties": {\n        "time": {\n          "type": "number",\n          "description": "The amount of time to delay in milliseconds"\n        }\n      },\n      "required": ["time"]\n    }\n  }\n]\n'})})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"feedback",children:"Feedback"}),"\n",(0,s.jsx)(n.p,{children:"If you supported feedback for AI generated messages, migrating is simple."}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsxs)(o.A,{children:[(0,s.jsx)(c.A,{value:"Diff",default:!0,children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"// highlight-error-start\n-    export const app = new Application({\n-      ai: {\n-        // opts into feedback loop\n-        enable_feedback_loop: true,\n-      },\n-    });\n-\n-    // Reply with message including feedback buttons\n-    app.activity(ActivityTypes.Message, async (context) => {\n-      await context.sendActivity({\n-        type: ActivityTypes.Message,\n-        text: `Hey, give me feedback!`,\n-        channelData: {\n-          feedbackLoop: {\n-            type: 'custom',\n-          },\n-        },\n-      });\n-    });\n-\n-    // Handle feedback submit\n-    app.feedbackLoop(async (context, state, feedbackLoopData) => {\n-      // custom logic here...\n-    });\n// highlight-error-end\n// highlight-success-start\n+    // Reply with message including feedback buttons\n+    app.on('message', async (client) => {\n+      await client.send(\n+        new MessageActivity('Hey, give me feedback!')\n+          .addAiGenerated() // AI generated label\n+          .addFeedback() // Feedback buttons\n+      );\n+    });\n+\n+    // Listen for feedback submissions\n+    app.on('message.submit.feedback', async ({ activity, log }) => {\n+      // custom logic here...\n+    });\n// highlight-success-end\n"})})}),(0,s.jsxs)(c.A,{value:"v2",label:"Teams SDK v2",children:[(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"import { MessageActivity } from '@microsoft/teams.api';\n\n// Reply with message including feedback buttons\napp.on('message', async (client) => {\n  await client.send(\n    new MessageActivity('Hey, give me feedback!')\n      .addAiGenerated() // AI generated label\n      .addFeedback() // Feedback buttons\n  );\n});\n\n// Listen for feedback submissions\napp.on('message.submit.feedback', async ({ activity, log }) => {\n  // custom logic here...\n});\n"})}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.em,{children:"Note:"})," In Teams SDK, you do not need to opt into feedback at the ",(0,s.jsx)(n.code,{children:"App"})," level."]})]}),(0,s.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ts",children:"export const app = new Application({\n  ai: {\n    // opts into feedback loop\n    enable_feedback_loop: true,\n  },\n});\n\n// Reply with message including feedback buttons\napp.activity(ActivityTypes.Message, async (context) => {\n  await context.sendActivity({\n    type: ActivityTypes.Message,\n    text: `Hey, give me feedback!`,\n    channelData: {\n      feedbackLoop: {\n        type: 'custom',\n      },\n    },\n  });\n});\n\n// Handle feedback submit\napp.feedbackLoop(async (context, state, feedbackLoopData) => {\n  // custom logic here...\n});\n"})})})]})}),"\n",(0,s.jsxs)(n.p,{children:["You can learn more about feedback in Teams SDK in the ",(0,s.jsx)(n.a,{href:"../in-depth-guides/feedback",children:"Feedback guide"}),"."]}),"\n",(0,s.jsxs)(r.A,{language:"typescript",children:[(0,s.jsx)(n.h2,{id:"incrementally-migrating-code-via-botbuilder-plugin",children:"Incrementally migrating code via botbuilder plugin"}),(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Comparison code coming soon!"})}),(0,s.jsxs)(n.p,{children:["If you aren't ready to migrate all of your code, you can run your existing Teams SDK code in parallel with Teams SDK. Learn more ",(0,s.jsx)(n.a,{href:"./botbuilder/integration",children:"here"}),"."]})]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},43023:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>o});var a=t(63696);const s={},i=a.createContext(s);function r(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),a.createElement(i.Provider,{value:n},e.children)}},78296:(e,n,t)=>{t.d(n,{A:()=>T});var a=t(63696),s=t(11750),i=t(53237),r=t(90766),o=t(22147),c=t(14395),l=t(35043),d=t(44544),p=t(41506);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function g(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a})))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const t=(0,o.W6)(),s=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(s),(0,a.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function v(e){const{defaultValue:n,queryString:t=!1,groupId:s}=e,i=g(e),[r,o]=(0,a.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[l,d]=m({queryString:t,groupId:s}),[u,v]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,p.Dv)(n);return[t,(0,a.useCallback)((e=>{n&&s.set(e)}),[n,s])]}({groupId:s}),y=(()=>{const e=l??u;return h({value:e,tabValues:i})?e:null})();(0,c.A)((()=>{y&&o(y)}),[y]);return{selectedValue:r,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),v(e)}),[d,v,i]),tabValues:i}}var y=t(86681);const f={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var x=t(62540);function A({className:e,block:n,selectedValue:t,selectValue:a,tabValues:i}){const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),l=e=>{const n=e.currentTarget,s=o.indexOf(n),r=i[s].value;r!==t&&(c(n),a(r))},d=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":n},e),children:i.map((({value:e,label:n,attributes:a})=>(0,x.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:d,onClick:l,...a,className:(0,s.A)("tabs__item",f.tabItem,a?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function w({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find((e=>e.props.value===t));return e?(0,a.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function b(e){const n=v(e);return(0,x.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",f.tabList),children:[(0,x.jsx)(A,{...n,...e}),(0,x.jsx)(w,{...n,...e})]})}function T(e){const n=(0,y.A)();return(0,x.jsx)(b,{...e,children:u(e.children)},String(n))}}}]);