"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[6523],{26585:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/auth-consent-popup-d3668799f135f0c895d2de7362c5d1e4.png"},35853:(e,t,n)=>{n.d(t,{A:()=>s});const s=n.p+"assets/images/auth-explicit-signin-24a4e95647d91815a6e6ff7116e2c26c.png"},43023:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var s=n(63696);const i={},r=s.createContext(i);function o(e){const t=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:t},e.children)}},66104:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"teams/user-authentication/README","title":"User Authentication","description":"At times, agents must access secured online resources on behalf of the user, such as checking email, checking flight status, or placing an order. To enable this, the user must authenticate their identity and grant consent for the application to access these resources. This process results in the application receiving a token, which the application can then use to access the permitted resources on the user\'s behalf.","source":"@site/docs/main/teams/user-authentication/README.md","sourceDirName":"teams/user-authentication","slug":"/teams/user-authentication/","permalink":"/teams-sdk/teams/user-authentication/","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/teams/user-authentication/README.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"summary":"Overview of user authentication in Teams SDK applications, including OAuth, SSO, and secure resource access."},"sidebar":"default","previous":{"title":"Troubleshooting","permalink":"/teams-sdk/teams/app-authentication/troubleshooting"},"next":{"title":"SSO Setup","permalink":"/teams-sdk/teams/user-authentication/sso-setup"}}');var i=n(62540),r=n(43023);const o={sidebar_position:4,summary:"Overview of user authentication in Teams SDK applications, including OAuth, SSO, and secure resource access."},a="User Authentication",h={},c=[{value:"How Auth Works",id:"how-auth-works",level:2},{value:"Single Sign-On (SSO)",id:"single-sign-on-sso",level:3},{value:"The SSO Signin Flow",id:"the-sso-signin-flow",level:4},{value:"OAuth",id:"oauth",level:3},{value:"The OAuth Signin Flow",id:"the-oauth-signin-flow",level:4},{value:"The OAuth Card",id:"the-oauth-card",level:4},{value:"OAuth vs SSO - Head-to-Head Comparison",id:"oauth-vs-sso---head-to-head-comparison",level:2}];function l(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"user-authentication",children:"User Authentication"})}),"\n",(0,i.jsx)(t.p,{children:"At times, agents must access secured online resources on behalf of the user, such as checking email, checking flight status, or placing an order. To enable this, the user must authenticate their identity and grant consent for the application to access these resources. This process results in the application receiving a token, which the application can then use to access the permitted resources on the user's behalf."}),"\n",(0,i.jsx)(t.h2,{id:"how-auth-works",children:"How Auth Works"}),"\n",(0,i.jsx)(t.p,{children:"When building Teams applications, choosing the right authentication method is crucial for both security and user experience. Teams supports two primary authentication approaches: OAuth and Single Sign-On (SSO). While both methods serve the same fundamental purpose of validating user identity, they differ significantly in their implementation, supported identity providers, and user experience. Understanding these differences is essential for making the right choice for your application."}),"\n",(0,i.jsx)(t.p,{children:"The following table provides a clear comparison between OAuth and SSO authentication methods, highlighting their key differences in terms of identity providers, authentication flows, and user experience."}),"\n",(0,i.jsx)(t.h3,{id:"single-sign-on-sso",children:"Single Sign-On (SSO)"}),"\n",(0,i.jsx)(t.p,{children:"Single Sign-On (SSO) in Teams provides a seamless authentication experience by leveraging a user's existing Teams identity. Once a user is logged into Teams, they can access your app without needing to sign in again. The only requirement is a one-time consent from the user, after which your app can securely retrieve their access details from Microsoft Entra ID. This consent is device-agnostic - once granted, users can access your app from any device without additional authentication steps."}),"\n",(0,i.jsx)(t.p,{children:"When an access token expires, the app automatically initiates a token exchange flow. In this process:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"The Teams client sends an OAuth ID token containing the user's information"}),"\n",(0,i.jsx)(t.li,{children:"Your app exchanges this ID token for a new access token with the previously consented scopes"}),"\n",(0,i.jsx)(t.li,{children:"This exchange happens silently without requiring user interaction"}),"\n"]}),"\n",(0,i.jsx)(t.admonition,{type:"tip",children:(0,i.jsx)(t.p,{children:"Always use SSO if you're authenticating the user with Microsoft Entra ID."})}),"\n",(0,i.jsx)(t.h4,{id:"the-sso-signin-flow",children:"The SSO Signin Flow"}),"\n",(0,i.jsx)(t.p,{children:"The SSO signin flow involves several components working together. Here's how it works:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"User interacts with your bot or message extension app"}),"\n",(0,i.jsx)(t.li,{children:"App initiates the signin process"}),"\n",(0,i.jsxs)(t.li,{children:["If it's the first time:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"User is shown a consent form for the requested scopes"}),"\n",(0,i.jsx)(t.li,{children:"Upon consent, Microsoft Entra ID issues an access token (in simple terms)"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["For subsequent interactions:","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"If token is valid, app uses it directly"}),"\n",(0,i.jsx)(t.li,{children:"If token expires, app silently signs the user in using the token exchange flow"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"This is what the SSO consent form looks like in Teams:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"SSO Consent Form",src:n(26585).A+"",width:"2386",height:"1628"})}),"\n",(0,i.jsx)(t.h3,{id:"oauth",children:"OAuth"}),"\n",(0,i.jsx)(t.p,{children:"You can use a third-party OAuth Identity Provider (IdP) to authenticate your app users. The app user is registered with the identity provider, which has a trust relationship with your app. When the user attempts to log in, the identity provider validates the app user and provides them with access to your app. Microsoft Entra ID is one such third party OAuth provider. You can use other providers, such as Google, Facebook, GitHub, or any other provider."}),"\n",(0,i.jsx)(t.h4,{id:"the-oauth-signin-flow",children:"The OAuth Signin Flow"}),"\n",(0,i.jsx)(t.p,{children:"The OAuth signin flow involves several components working together. Here's how it works:"}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"User interacts with your bot or message extension app"}),"\n",(0,i.jsx)(t.li,{children:"App sends a sign-in card with a link to the OAuth provider"}),"\n",(0,i.jsx)(t.li,{children:"User clicks the link and is redirected to the provider's authentication page"}),"\n",(0,i.jsx)(t.li,{children:"User authenticates and grants consent for requested scopes"}),"\n",(0,i.jsx)(t.li,{children:"Provider issues an access token to your app (in simple terms)"}),"\n",(0,i.jsx)(t.li,{children:"App uses the token to access services on user's behalf"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"When an access token expires, the user will need to go through the sign-in process again. Unlike SSO, there is no automatic token exchange - the user must explicitly authenticate each time their token expires."}),"\n",(0,i.jsx)(t.h4,{id:"the-oauth-card",children:"The OAuth Card"}),"\n",(0,i.jsx)(t.p,{children:"This is what the OAuth card looks like in Teams:"}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{alt:"OAuthCard",src:n(35853).A+"",width:"1562",height:"372"})}),"\n",(0,i.jsx)(t.h2,{id:"oauth-vs-sso---head-to-head-comparison",children:"OAuth vs SSO - Head-to-Head Comparison"}),"\n",(0,i.jsx)(t.p,{children:"The following table provides a clear comparison between OAuth and SSO authentication methods, highlighting their key differences in terms of identity providers, authentication flows, and user experience."}),"\n",(0,i.jsxs)(t.table,{children:[(0,i.jsx)(t.thead,{children:(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.th,{children:"Feature"}),(0,i.jsx)(t.th,{children:"OAuth"}),(0,i.jsx)(t.th,{children:"SSO"})]})}),(0,i.jsxs)(t.tbody,{children:[(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Identity Provider"}),(0,i.jsx)(t.td,{children:"Works with any OAuth provider (Microsoft Entra ID, Google, Facebook, GitHub, etc.)"}),(0,i.jsx)(t.td,{children:"Only works with Microsoft Entra ID"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Authentication Flow"}),(0,i.jsx)(t.td,{children:"User is sent a card with a sign-in link"}),(0,i.jsx)(t.td,{children:'If the user has already consented to the requested scopes in the past they will "silently" login through the token exchange flow. Otherwise user is shown a consent form'})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"User Experience"}),(0,i.jsx)(t.td,{children:"Requires explicit signin, and consent to scopes"}),(0,i.jsx)(t.td,{children:"Re-use existing Teams credential. Only requires consent to scopes"})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsxs)(t.td,{children:["Conversation scopes (",(0,i.jsx)(t.code,{children:"personal"}),", ",(0,i.jsx)(t.code,{children:"groupChat"}),", ",(0,i.jsx)(t.code,{children:"teams"}),")"]}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"personal"})," scope only"]}),(0,i.jsxs)(t.td,{children:[(0,i.jsx)(t.code,{children:"personal"})," scope only"]})]}),(0,i.jsxs)(t.tr,{children:[(0,i.jsx)(t.td,{children:"Azure Configuration differences"}),(0,i.jsxs)(t.td,{children:["Same configuration except ",(0,i.jsx)(t.code,{children:"Token Exchange URL"})," is blank"]}),(0,i.jsxs)(t.td,{children:["Same configuration except ",(0,i.jsx)(t.code,{children:"Token Exchange URL"})," is set"]})]})]})]})]})}function d(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);