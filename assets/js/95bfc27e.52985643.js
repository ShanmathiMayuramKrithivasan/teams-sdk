"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[602],{43023:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>r});var t=i(63696);const s={},o=t.createContext(s);function a(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(o.Provider,{value:n},e.children)}},99288:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"teams/core-concepts","title":"Teams Core Concepts","description":"When you run your agent on Teams using Microsoft 365 Agents Toolkit, several Teams-specific processes happen behind the scenes. Understanding these components will help you better debug and deploy your agents. Obviously, all these processes can be done manually, but Agents Toolkit automates them for you.","source":"@site/docs/main/teams/core-concepts.md","sourceDirName":"teams","slug":"/teams/core-concepts","permalink":"/teams-sdk/teams/core-concepts","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/teams/core-concepts.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"summary":"Understand Teams app architecture including app registration, Azure Bot Service, DevTunnel, and sideloading processes."},"sidebar":"default","previous":{"title":"Teams Integration","permalink":"/teams-sdk/teams/"},"next":{"title":"Basic Configuration","permalink":"/teams-sdk/teams/configuration/"}}');var s=i(62540),o=i(43023);const a={sidebar_position:1,summary:"Understand Teams app architecture including app registration, Azure Bot Service, DevTunnel, and sideloading processes."},r="Teams Core Concepts",l={},c=[{value:"Basic Flow",id:"basic-flow",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"DevTunnel",id:"devtunnel",level:2},{value:"Teams App Provisioning",id:"teams-app-provisioning",level:2},{value:"App Registration",id:"app-registration",level:3},{value:"Azure Bot",id:"azure-bot",level:3},{value:"Sideloading Process",id:"sideloading-process",level:2},{value:"Provisioning and Deployment",id:"provisioning-and-deployment",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"teams-core-concepts",children:"Teams Core Concepts"})}),"\n",(0,s.jsx)(n.p,{children:"When you run your agent on Teams using Microsoft 365 Agents Toolkit, several Teams-specific processes happen behind the scenes. Understanding these components will help you better debug and deploy your agents. Obviously, all these processes can be done manually, but Agents Toolkit automates them for you."}),"\n",(0,s.jsx)(n.h2,{id:"basic-flow",children:"Basic Flow"}),"\n",(0,s.jsx)(n.mermaid,{value:'flowchart LR\n    %% Main actors\n    User([User])\n\n    %% Teams section\n    subgraph Teams ["Teams"]\n        TeamsClient["Teams Client"]\n        TeamsBackend["Teams Backend"]\n    end\n\n    %% Azure section\n    subgraph Azure ["Azure"]\n        AppReg["App Registration"]\n        AzureBot["Azure Bot"]\n    end\n\n    %% Local Server section\n    subgraph LocalServer ["Local Server"]\n        DevTunnel["DevTunnel"]\n        LocalApp["Your local application"]\n    end\n\n    %% Deployed Server section\n    subgraph DeployedServer ["Deployed Server"]\n        DeployedApp["Your deployed application"]\n    end\n\n    %% Define connections\n    User <--\x3e TeamsClient\n    TeamsClient <--\x3e TeamsBackend\n    TeamsBackend <--\x3e AppReg\n    AppReg <--\x3e AzureBot\n    AzureBot --\x3e LocalServer\n    AzureBot --\x3e DeployedServer'}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Teams"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Teams Client: User-facing agent that interacts with the user."}),"\n",(0,s.jsx)(n.li,{children:"Teams Backend: Part of your app package; includes a manifest with your app\u2019s client ID."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Azure"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"App Registration: Contains a unique client ID and secret for your app."}),"\n",(0,s.jsx)(n.li,{children:"Azure Bot: Connects your app to Teams; contains a pointer to your HTTPS URL."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Local Server"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Dev Tunnel: Public-facing HTTPS tunnel to expose your local machine."}),"\n",(0,s.jsx)(n.li,{children:"Local App: Your application running locally; handles events from Teams and sends responses."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Deployed Server"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Deployed App: Your app deployed to the cloud with a public HTTPS endpoint; also interacts with Teams."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,s.jsx)(n.p,{children:"When working with Teams, these are the key concepts. Keep in mind, this is a simplified view of the architecture."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Teams Client: This is the Teams application where users interact with your agent. This can be the desktop app, web app, or mobile app."}),"\n",(0,s.jsx)(n.li,{children:"Teams Backend: This service handles all the Teams-related operations, including keeping a record of your manifest, and routing messages from your agent to the Azure bot service."}),"\n",(0,s.jsx)(n.li,{children:"App Registration: This is the registration of your agent in Azure. This Application Registration issues a unique client ID for your application and a client secret. This is used to authenticate your agent application with the Teams backend and other Azure services (including Graph if you are using it)."}),"\n",(0,s.jsx)(n.li,{children:"Azure Bot Service: This is the service that handles all the bot-related operations, including routing messages from Teams to your agent and vice versa. This holds the URL to your agent application."}),"\n",(0,s.jsx)(n.li,{children:"DevTunnel: This is a service that creates a public facing URL to your locally running application. Azure Bot Service requires that you have a public facing https URL to your agent application."}),"\n",(0,s.jsx)(n.li,{children:"Local Agent Application: This is your agent application running on your local machine."}),"\n",(0,s.jsx)(n.li,{children:"Deployed Agent Application: This is your deployed agent which probably has a public facing URL."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"devtunnel",children:"DevTunnel"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/azure/developer/dev-tunnels/overview",children:"DevTunnel"})," is a critical component that makes your locally running agent accessible to Teams. When you set up a DevTunnel, it:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Creates a secure public HTTPS endpoint that forwards to your local server"}),"\n",(0,s.jsx)(n.li,{children:"Manages SSL certificates automatically"}),"\n",(0,s.jsx)(n.li,{children:"Routes Teams messages and events to your local agent"}),"\n"]}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"DevTunnel is only one way of exposing your locally running service to the internet. Other tools like ngrok can also accomplish the same thing."})}),"\n",(0,s.jsx)(n.h2,{id:"teams-app-provisioning",children:"Teams App Provisioning"}),"\n",(0,s.jsx)(n.p,{children:"Before your agent can interact with Teams, it needs to be properly registered and configured. This step handles creating or updating the App Registration and creating or registering the Azure Bot instance in Azure."}),"\n",(0,s.jsx)(n.h3,{id:"app-registration",children:"App Registration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Creates an App ID (i.e. Client ID) in the Teams platform"}),"\n",(0,s.jsx)(n.li,{children:"Sets up a bot registration with the Bot Framework"}),"\n",(0,s.jsxs)(n.li,{children:["Creates a client secret that your agent can use to authenticate to be able to send and receive messages. Agents Toolkit will automatically get this value and store it in the ",(0,s.jsx)(n.code,{children:".env"})," file for you."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"azure-bot",children:"Azure Bot"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Creates an Azure Bot resource"}),"\n",(0,s.jsx)(n.li,{children:"Associates the bot with your App Registration"}),"\n",(0,s.jsx)(n.li,{children:"Configures the messaging endpoint to point to your DevTunnel (or public URL if deployed)"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"sideloading-process",children:"Sideloading Process"}),"\n",(0,s.jsx)(n.p,{children:"Sideloading is the process of installing your agent in Teams. You are able to pass in the manifest and icons (zipped up) to the Teams client. Sideloading an application automatically makes that application available to you. You are also able to sideload the application in a Team or a Group chat. In this case, the application will be available to all members of that Team or Group chat."}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"Sideloading needs to be enabled in your tenant. If this is not the case, then you will need to contact your Teams administrator to enable it."})}),"\n",(0,s.jsx)(n.h2,{id:"provisioning-and-deployment",children:"Provisioning and Deployment"}),"\n",(0,s.jsxs)(n.p,{children:["To test your app in Teams, you will at minimum need to have a provisioned Azure bot. You are likely to have other provisionied resources such as storage. Please see the Microsoft Learn ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/provision",children:"Provision cloud resources"})," documentation for provisioning and deployment using Visual Studio Code and to a container service."]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}}}]);