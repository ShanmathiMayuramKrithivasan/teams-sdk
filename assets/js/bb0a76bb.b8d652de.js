"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[1353],{43023:(e,n,i)=>{i.d(n,{R:()=>a,x:()=>l});var t=i(63696);const o={},s=t.createContext(o);function a(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),t.createElement(s.Provider,{value:n},e.children)}},56580:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>a,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"teams/enabling-in-copilot","title":"Enabling in M365 Copilot","description":"If you\'ve built a Teams app or agent and want to make it available in M365 Copilot, you can easily do so by updating your app manifest. This allows users to interact with your agent through Copilot\'s interface.","source":"@site/docs/main/teams/enabling-in-copilot.md","sourceDirName":"teams","slug":"/teams/enabling-in-copilot","permalink":"/teams-sdk/teams/enabling-in-copilot","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/teams/enabling-in-copilot.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"summary":"Learn how to enable your Teams app to work in M365 Copilot by updating the app manifest."},"sidebar":"default","previous":{"title":"Teams Manifest","permalink":"/teams-sdk/teams/manifest"},"next":{"title":"\ud83d\ude80 Getting Started","permalink":"/teams-sdk/typescript/getting-started/"}}');var o=i(62540),s=i(43023);const a={sidebar_position:6,summary:"Learn how to enable your Teams app to work in M365 Copilot by updating the app manifest."},l="Enabling in M365 Copilot",r={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Updating the Manifest",id:"updating-the-manifest",level:2},{value:"Location of the Manifest",id:"location-of-the-manifest",level:2},{value:"Example Manifest Structure",id:"example-manifest-structure",level:3},{value:"Regenerating the App Package",id:"regenerating-the-app-package",level:2},{value:"Using Microsoft 365 Agents Toolkit",id:"using-microsoft-365-agents-toolkit",level:3},{value:"Manual Packaging",id:"manual-packaging",level:3},{value:"Testing in Copilot",id:"testing-in-copilot",level:2},{value:"Resources",id:"resources",level:2}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"enabling-in-m365-copilot",children:"Enabling in M365 Copilot"})}),"\n",(0,o.jsx)(n.p,{children:"If you've built a Teams app or agent and want to make it available in M365 Copilot, you can easily do so by updating your app manifest. This allows users to interact with your agent through Copilot's interface."}),"\n",(0,o.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsx)(n.p,{children:"Before enabling your app in Copilot, ensure you have:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"A working Teams app or agent"}),"\n",(0,o.jsx)(n.li,{children:'Completed the app registration process (see "Running in Teams" for your language)'}),"\n",(0,o.jsxs)(n.li,{children:["Your ",(0,o.jsx)(n.code,{children:"BOT_ID"})," from the app registration"]}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"updating-the-manifest",children:"Updating the Manifest"}),"\n",(0,o.jsxs)(n.p,{children:["To enable your app in Copilot, add the following configuration to your ",(0,o.jsx)(n.code,{children:"manifest.json"})," file:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'"copilotAgents": {\n  "customEngineAgents": [\n    {\n      "type": "bot",\n      "id": "${{BOT_ID}}"\n    }\n  ]\n}\n'})}),"\n",(0,o.jsxs)(n.p,{children:["The ",(0,o.jsx)(n.code,{children:"BOT_ID"}),' is assigned to your agent after you have registered your application. If you followed the "Running in Teams" guide for your language, this ID should already be available in your environment configuration.']}),"\n",(0,o.jsx)(n.h2,{id:"location-of-the-manifest",children:"Location of the Manifest"}),"\n",(0,o.jsxs)(n.p,{children:["The manifest file is typically located in the ",(0,o.jsx)(n.code,{children:"appPackage"})," folder of your project. If you used the Teams CLI to set up your project, this folder was automatically created for you."]}),"\n",(0,o.jsx)(n.h3,{id:"example-manifest-structure",children:"Example Manifest Structure"}),"\n",(0,o.jsxs)(n.p,{children:["Here's how the ",(0,o.jsx)(n.code,{children:"copilotAgents"})," section fits into the overall manifest structure:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-json",children:'{\n  "$schema": "https://developer.microsoft.com/en-us/json-schemas/teams/v1.19/MicrosoftTeams.schema.json",\n  "manifestVersion": "1.19",\n  "version": "1.0.0",\n  "id": "${{APP_ID}}",\n  "developer": {\n    "name": "Your Company",\n    "websiteUrl": "https://www.example.com",\n    "privacyUrl": "https://www.example.com/privacy",\n    "termsOfUseUrl": "https://www.example.com/terms"\n  },\n  "name": {\n    "short": "Your App Name",\n    "full": "Your Full App Name"\n  },\n  "description": {\n    "short": "Short description",\n    "full": "Full description of your app"\n  },\n  "icons": {\n    "outline": "outline.png",\n    "color": "color.png"\n  },\n  "accentColor": "#FFFFFF",\n  "bots": [\n    {\n      "botId": "${{BOT_ID}}",\n      "scopes": [\n        "personal",\n        "team",\n        "groupchat"\n      ],\n      "supportsFiles": false,\n      "isNotificationOnly": false\n    }\n  ],\n  "copilotAgents": {\n    "customEngineAgents": [\n      {\n        "type": "bot",\n        "id": "${{BOT_ID}}"\n      }\n    ]\n  }\n}\n'})}),"\n",(0,o.jsx)(n.h2,{id:"regenerating-the-app-package",children:"Regenerating the App Package"}),"\n",(0,o.jsx)(n.p,{children:"After updating the manifest, you need to zip the manifest and icon files into an app package:"}),"\n",(0,o.jsx)(n.h3,{id:"using-microsoft-365-agents-toolkit",children:"Using Microsoft 365 Agents Toolkit"}),"\n",(0,o.jsx)(n.p,{children:"If you're using the Microsoft 365 Agents Toolkit, the app package is automatically regenerated when you build or debug your app. The toolkit will:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsx)(n.li,{children:"Read your updated manifest"}),"\n",(0,o.jsxs)(n.li,{children:["Replace variables like ",(0,o.jsx)(n.code,{children:"${{BOT_ID}}"})," with actual values from your environment"]}),"\n",(0,o.jsx)(n.li,{children:"Package the manifest and icons into a zip file"}),"\n",(0,o.jsx)(n.li,{children:"Deploy the updated package to Teams"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"manual-packaging",children:"Manual Packaging"}),"\n",(0,o.jsx)(n.p,{children:"If you're manually packaging your app:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Ensure the ",(0,o.jsx)(n.code,{children:"manifest.json"})," file is updated with the ",(0,o.jsx)(n.code,{children:"copilotAgents"})," section"]}),"\n",(0,o.jsxs)(n.li,{children:["Create a zip file containing:","\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.code,{children:"manifest.json"})}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"color.png"})," (192x192 icon)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.code,{children:"outline.png"})," (32x32 icon)"]}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(n.li,{children:"Upload the zip file to Teams"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"testing-in-copilot",children:"Testing in Copilot"}),"\n",(0,o.jsx)(n.p,{children:"Once you've updated and redeployed your app:"}),"\n",(0,o.jsxs)(n.ol,{children:["\n",(0,o.jsxs)(n.li,{children:["Open M365 Copilot in Teams or at ",(0,o.jsx)(n.a,{href:"https://m365.cloud.microsoft/",children:"m365.cloud.microsoft"})]}),"\n",(0,o.jsx)(n.li,{children:"Your app should now be available as an agent option"}),"\n",(0,o.jsx)(n.li,{children:"Interact with your agent through the Copilot interface"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/convert-declarative-agent",children:"Convert Your Declarative Agent for Microsoft 365 Copilot to a Custom Engine Agent"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://learn.microsoft.com/microsoftteams/platform/resources/schema/manifest-schema",children:"Teams app manifest reference"})}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(p,{...e})}):p(e)}}}]);