"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[5071],{3228:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>d,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>m});const i=JSON.parse('{"id":"typescript/in-depth-guides/dialogs/handling-multi-step-forms","title":"Handling Multi-Step Forms","description":"\x3c!--","source":"@site/docs/main/typescript/in-depth-guides/dialogs/handling-multi-step-forms.mdx","sourceDirName":"typescript/in-depth-guides/dialogs","slug":"/typescript/in-depth-guides/dialogs/handling-multi-step-forms","permalink":"/teams-sdk/typescript/in-depth-guides/dialogs/handling-multi-step-forms","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/in-depth-guides/dialogs/handling-multi-step-forms.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"Handling Multi-Step Forms","title":"Handling Multi-Step Forms","summary":"Tutorial on implementing multi-step dialogs in Teams, demonstrating how to create dynamic form flows that adapt based on user input, with examples of handling state between steps and conditional navigation."},"sidebar":"default","previous":{"title":"Handling Dialog Submissions","permalink":"/teams-sdk/typescript/in-depth-guides/dialogs/handling-dialog-submissions"},"next":{"title":"Message Extensions","permalink":"/teams-sdk/typescript/in-depth-guides/message-extensions/"}}');var a=n(62540),s=n(43023),o=n(26802);const r={sidebar_position:3,sidebar_label:"Handling Multi-Step Forms",title:"Handling Multi-Step Forms",summary:"Tutorial on implementing multi-step dialogs in Teams, demonstrating how to create dynamic form flows that adapt based on user input, with examples of handling state between steps and conditional navigation."},d="Handling Multi-Step Forms",l={},m=[];function p(e){const t={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"handling-multi-step-forms",children:"Handling Multi-Step Forms"})}),"\n",(0,a.jsx)(t.p,{children:"Dialogs can become complex yet powerful with multi-step forms. These forms can alter the flow of the survey depending on the user's input or customize subsequent steps based on previous answers."}),"\n",(0,a.jsx)(o.A,{language:"typescript",children:(0,a.jsxs)(t.p,{children:["Start off by sending an initial card in the ",(0,a.jsx)(t.code,{children:"dialog.open"})," event."]})}),"\n",(0,a.jsx)(o.A,{language:"typescript",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"import { cardAttachment } from '@microsoft/teams.api';\nimport { AdaptiveCard, TextInput, SubmitAction } from '@microsoft/teams.cards';\n// ...\n\nconst dialogCard = new AdaptiveCard(\n  {\n    type: 'TextBlock',\n    text: 'This is a multi-step form',\n    size: 'Large',\n    weight: 'Bolder',\n  },\n  new TextInput()\n    .withLabel('Name')\n    .withIsRequired()\n    .withId('name')\n    .withPlaceholder('Enter your name')\n)\n  // Inside the dialog, the card actions for submitting the card must be\n  // of type Action.Submit\n  .withActions(\n    new SubmitAction()\n      .withTitle('Submit')\n      .withData({ submissiondialogtype: 'webpage_dialog_step_1' })\n  );\n\n// Return an object with the task value that renders a card\nreturn {\n  task: {\n    type: 'continue',\n    value: {\n      title: 'Multi-step Form Dialog',\n      card: cardAttachment('adaptive', dialogCard),\n    },\n  },\n};\n"})})}),"\n",(0,a.jsxs)(o.A,{language:"typescript",children:[(0,a.jsxs)(t.p,{children:["Then in the submission handler, you can choose to ",(0,a.jsx)(t.code,{children:"continue"})," the dialog with a different card."]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-typescript",children:"import { cardAttachment } from '@microsoft/teams.api';\nimport { App } from '@microsoft/teams.apps';\nimport { AdaptiveCard, TextInput, SubmitAction } from '@microsoft/teams.cards';\n// ...\n\napp.on('dialog.submit', async ({ activity, send, next }) => {\n  const dialogType = activity.value.data.submissiondialogtype;\n\n  if (dialogType === 'webpage_dialog_step_1') {\n    // This is data from the form that was submitted\n    const name = activity.value.data.name;\n    const nextStepCard = new AdaptiveCard(\n      {\n        type: 'TextBlock',\n        text: 'Email',\n        size: 'Large',\n        weight: 'Bolder',\n      },\n      new TextInput()\n        .withLabel('Email')\n        .withIsRequired()\n        .withId('email')\n        .withPlaceholder('Enter your email')\n    ).withActions(\n      new SubmitAction().withTitle('Submit').withData({\n        // This same handler will get called, so we need to identify the step\n        // in the returned data\n        submissiondialogtype: 'webpage_dialog_step_2',\n        // Carry forward data from previous step\n        name,\n      })\n    );\n    return {\n      task: {\n        // This indicates that the dialog flow should continue\n        type: 'continue',\n        value: {\n          // Here we customize the title based on the previous response\n          title: `Thanks ${name} - Get Email`,\n          card: cardAttachment('adaptive', nextStepCard),\n        },\n      },\n    };\n  } else if (dialogType === 'webpage_dialog_step_2') {\n    const name = activity.value.data.name;\n    const email = activity.value.data.email;\n    await send(`Hi ${name}, thanks for submitting the form! We got that your email is ${email}`);\n    // You can also return a blank response\n    return {\n      status: 200,\n    };\n  }\n});\n"})})]})]})}function c(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(p,{...e})}):p(e)}},26802:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(22147),a=n(62540);function s({language:e,children:t}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,a.jsx)(a.Fragment,{children:t}):null}},43023:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>r});var i=n(63696);const a={},s=i.createContext(a);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);