"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[679],{22491:(t,e,n)=>{n.d(e,{A:()=>r});n(63696);var i=n(11750);const a={tabItem:"tabItem_wHwb"};var s=n(62540);function r({children:t,hidden:e,className:n}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,i.A)(a.tabItem,n),hidden:e,children:t})}},26802:(t,e,n)=>{n.d(e,{A:()=>s});var i=n(22147),a=n(62540);function s({language:t,children:e}){return(0,i.zy)().pathname.includes(`/${t}/`)?(0,a.jsx)(a.Fragment,{children:e}):null}},43023:(t,e,n)=>{n.d(e,{R:()=>r,x:()=>o});var i=n(63696);const a={},s=i.createContext(a);function r(t){const e=i.useContext(s);return i.useMemo((function(){return"function"==typeof t?t(e):{...e,...t}}),[e,t])}function o(t){let e;return e=t.disableParentContext?"function"==typeof t.components?t.components(a):t.components||a:r(t.components),i.createElement(s.Provider,{value:e},t.children)}},48716:(t,e,n)=>{n.r(e),n.d(e,{assets:()=>u,contentTitle:()=>d,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>h});const i=JSON.parse('{"id":"python/migrations/botbuilder/sending-activities","title":"Sending Activities","description":"\x3c!--","source":"@site/docs/main/python/migrations/botbuilder/sending-activities.mdx","sourceDirName":"python/migrations/botbuilder","slug":"/python/migrations/botbuilder/sending-activities","permalink":"/teams-sdk/python/migrations/botbuilder/sending-activities","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/migrations/botbuilder/sending-activities.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Sending Activities","title":"Sending Activities","languages":["typescript","csharp","python"],"summary":"Migrate from BotBuilder\'s TurnContext activity sending to Teams SDK\'s simplified send method with better Adaptive Card support."},"sidebar":"default","previous":{"title":"Using the BotBuilder Plugin","permalink":"/teams-sdk/python/migrations/botbuilder/integration"},"next":{"title":"Proactive Activities","permalink":"/teams-sdk/python/migrations/botbuilder/proactive-activities"}}');var a=n(62540),s=n(43023),r=n(26802),o=n(78296),c=n(22491);const l={sidebar_position:1,sidebar_label:"Sending Activities",title:"Sending Activities",languages:["typescript","csharp","python"],summary:"Migrate from BotBuilder's TurnContext activity sending to Teams SDK's simplified send method with better Adaptive Card support."},d="Sending Activities",u={},h=[{value:"Strings",id:"strings",level:2},{value:"Adaptive Cards",id:"adaptive-cards",level:2},{value:"Attachments",id:"attachments",level:2}];function m(t){const e={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,s.R)(),...t.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(e.header,{children:(0,a.jsx)(e.h1,{id:"sending-activities",children:"Sending Activities"})}),"\n",(0,a.jsxs)(e.p,{children:["BotBuilder's pattern for sending activities via its ",(0,a.jsx)(e.code,{children:"TurnContext"})," is similar to that in Teams SDK,\nbut one key difference is that sending adaptive cards doesn't require constructing the entire activity yourself."]}),"\n",(0,a.jsxs)(r.A,{language:"python",children:[(0,a.jsxs)(o.A,{groupId:"sending-activities",children:[(0,a.jsx)(c.A,{value:"Diff",default:!0,children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# highlight-error-start\n-   from botbuilder.core import ActivityHandler, TurnContext\n-   from botbuilder.schema import Activity\n# highlight-error-end\n# highlight-success-start\n+   from microsoft_teams.api import MessageActivity, TypingActivityInput\n+   from microsoft_teams.apps import ActivityContext, App\n# highlight-success-end\n\n# highlight-error-start\n-   class MyActivityHandler(ActivityHandler):\n-       async def on_message_activity(self, turn_context: TurnContext):\n-           await turn_context.send_activity(Activity(type="typing"))\n# highlight-error-end\n# highlight-success-start\n+   @app.on_message\n+   async def on_message(context: ActivityContext[MessageActivity]):\n+       await context.send(TypingActivityInput())\n# highlight-success-end\n'})})}),(0,a.jsx)(c.A,{value:"BotBuilder",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'from botbuilder.core import ActivityHandler, TurnContext\nfrom botbuilder.schema import Activity\n\nclass MyActivityHandler(ActivityHandler):\n    async def on_message_activity(self, turn_context: TurnContext):\n        # highlight-next-line\n        await turn_context.send_activity(Activity(type="typing"))\n'})})}),(0,a.jsx)(c.A,{value:"Teams SDK",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"from microsoft_teams.api import MessageActivity, TypingActivityInput\nfrom microsoft_teams.apps import ActivityContext, App\n\n@app.on_message\nasync def on_message(context: ActivityContext[MessageActivity]):\n    # highlight-next-line\n    await context.send(TypingActivityInput())\n"})})})]}),(0,a.jsx)(e.h2,{id:"strings",children:"Strings"}),(0,a.jsxs)(o.A,{groupId:"sending-activities",children:[(0,a.jsx)(c.A,{value:"Diff",default:!0,children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# highlight-error-start\n-   from botbuilder.core import ActivityHandler, TurnContext\n# highlight-error-end\n# highlight-success-start\n+   from microsoft_teams.api import MessageActivity\n+   from microsoft_teams.apps import ActivityContext, App\n# highlight-success-end\n\n# highlight-error-start\n-   class MyActivityHandler(ActivityHandler):\n-       async def on_message_activity(self, turn_context: TurnContext):\n-           await turn_context.send_activity("hello world")\n# highlight-error-end\n# highlight-success-start\n+   @app.on_message\n+   async def on_message(context: ActivityContext[MessageActivity]):\n+       await context.send("hello world")\n# highlight-success-end\n'})})}),(0,a.jsx)(c.A,{value:"BotBuilder",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'from botbuilder.core import ActivityHandler, TurnContext\n\nclass MyActivityHandler(ActivityHandler):\n    async def on_message_activity(self, turn_context: TurnContext):\n        # highlight-next-line\n        await turn_context.send_activity("hello world")\n'})})}),(0,a.jsx)(c.A,{value:"Teams SDK",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'from microsoft_teams.api import MessageActivity\nfrom microsoft_teams.apps import ActivityContext, App\n\n@app.on_message\nasync def on_message(context: ActivityContext[MessageActivity]):\n    # highlight-next-line\n    await context.send("hello world")\n'})})})]}),(0,a.jsx)(e.h2,{id:"adaptive-cards",children:"Adaptive Cards"}),(0,a.jsxs)(o.A,{groupId:"sending-activities",children:[(0,a.jsx)(c.A,{value:"Diff",default:!0,children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# highlight-error-start\n-   from botbuilder.core import ActivityHandler, TurnContext\n-   from botbuilder.schema import Activity, Attachment\n# highlight-error-end\n# highlight-success-start\n+   from microsoft_teams.api import MessageActivity\n+   from microsoft_teams.apps import ActivityContext, App\n+   from microsoft_teams.cards import AdaptiveCard, TextBlock\n# highlight-success-end\n\n# highlight-error-start\n-   class MyActivityHandler(ActivityHandler):\n-       async def on_message_activity(self, turn_context: TurnContext):\n-         card = {"type": "AdaptiveCard", "version": "1.0", "body": [{"type": "TextBlock", "text": "hello world"}]}\n-         attachment = Attachment(content_type="application/vnd.microsoft.card.adaptive", content=card)\n-         activity = Activity(type="message", attachments=[attachment])\n-         await turn_context.send_activity(activity)\n# highlight-error-end\n# highlight-success-start\n+   @app.on_message\n+   async def on_message(context: ActivityContext[MessageActivity]):\n+       await context.send(AdaptiveCard().with_body([TextBlock(text="Hello from Adaptive Card!")]))\n# highlight-success-end\n'})})}),(0,a.jsx)(c.A,{value:"BotBuilder",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'from botbuilder.core import ActivityHandler, TurnContext\nfrom botbuilder.schema import Activity, Attachment\n\nclass MyActivityHandler(ActivityHandler):\n    async def on_message_activity(self, turn_context: TurnContext):\n      # hightlight-start\n      card = {"type": "AdaptiveCard", "version": "1.0", "body": [{"type": "TextBlock", "text": "hello world"}]}\n      attachment = Attachment(content_type="application/vnd.microsoft.card.adaptive", content=card)\n      activity = Activity(type="message", attachments=[attachment])\n      await turn_context.send_activity(activity)\n      # highlight-end\n'})})}),(0,a.jsx)(c.A,{value:"Teams SDK",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'from microsoft_teams.api import MessageActivity\nfrom microsoft_teams.apps import ActivityContext, App\nfrom microsoft_teams.cards import AdaptiveCard, TextBlock\n\n@app.on_message\nasync def on_message(context: ActivityContext[MessageActivity]):\n    # highlight-next-line\n    await context.send(AdaptiveCard(body=[TextBlock(text="Hello from Adaptive Card!")]))\n'})})})]}),(0,a.jsx)(e.h2,{id:"attachments",children:"Attachments"}),(0,a.jsxs)(o.A,{groupId:"sending-activities",children:[(0,a.jsx)(c.A,{value:"Diff",default:!0,children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",children:'# highlight-error-start\n-   from botbuilder.core import ActivityHandler, TurnContext\n-   from botbuilder.schema import Activity, Attachment\n# highlight-error-end\n# highlight-success-start\n+   from microsoft_teams.api import Attachment, MessageActivity, MessageActivityInput\n+   from microsoft_teams.apps import ActivityContext, App\n# highlight-success-end\n\n# highlight-error-start\n-   class MyActivityHandler(ActivityHandler):\n-       async def on_message_activity(self, turn_context: TurnContext):\n-         attachment = Attachment(...)\n-         activity = Activity(type="message", attachments=[attachment])\n-         await turn_context.send_activity(activity)\n# highlight-error-end\n# highlight-success-start\n+   @app.on_message\n+   async def on_message(context: ActivityContext[MessageActivity]):\n+       attachment = Attachment(...)\n+       activity = MessageActivityInput().add_attachments([attachment])\n+       await context.send(activity)\n# highlight-success-end\n'})})}),(0,a.jsx)(c.A,{value:"BotBuilder",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:'from botbuilder.core import ActivityHandler, TurnContext\nfrom botbuilder.schema import Activity, Attachment\n\nclass MyActivityHandler(ActivityHandler):\n    async def on_message_activity(self, turn_context: TurnContext):\n        # highlight-start\n        attachment = Attachment(...)\n        activity = Activity(type="message", attachments=[attachment])\n        await turn_context.send_activity(activity)\n        # highlight-end\n'})})}),(0,a.jsx)(c.A,{value:"Teams SDK",children:(0,a.jsx)(e.pre,{children:(0,a.jsx)(e.code,{className:"language-python",metastring:"showLineNumbers",children:"from microsoft_teams.api import Attachment, MessageActivity, MessageActivityInput\nfrom microsoft_teams.apps import ActivityContext, App\n\n@app.on_message\nasync def on_message(context: ActivityContext[MessageActivity]):\n    # highlight-start\n    attachment = Attachment(...)\n    activity = MessageActivityInput().add_attachments([attachment])\n    await context.send(activity)\n    # highlight-end\n"})})})]})]})]})}function p(t={}){const{wrapper:e}={...(0,s.R)(),...t.components};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(m,{...t})}):m(t)}},78296:(t,e,n)=>{n.d(e,{A:()=>j});var i=n(63696),a=n(11750),s=n(53237),r=n(90766),o=n(22147),c=n(14395),l=n(35043),d=n(44544),u=n(41506);function h(t){return i.Children.toArray(t).filter((t=>"\n"!==t)).map((t=>{if(!t||(0,i.isValidElement)(t)&&function(t){const{props:e}=t;return!!e&&"object"==typeof e&&"value"in e}(t))return t;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof t.type?t.type:t.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function m(t){const{values:e,children:n}=t;return(0,i.useMemo)((()=>{const t=e??function(t){return h(t).map((({props:{value:t,label:e,attributes:n,default:i}})=>({value:t,label:e,attributes:n,default:i})))}(n);return function(t){const e=(0,d.XI)(t,((t,e)=>t.value===e.value));if(e.length>0)throw new Error(`Docusaurus error: Duplicate values "${e.map((t=>t.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(t),t}),[e,n])}function p({value:t,tabValues:e}){return e.some((e=>e.value===t))}function g({queryString:t=!1,groupId:e}){const n=(0,o.W6)(),a=function({queryString:t=!1,groupId:e}){if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!e)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return e??null}({queryString:t,groupId:e});return[(0,l.aZ)(a),(0,i.useCallback)((t=>{if(!a)return;const e=new URLSearchParams(n.location.search);e.set(a,t),n.replace({...n.location,search:e.toString()})}),[a,n])]}function v(t){const{defaultValue:e,queryString:n=!1,groupId:a}=t,s=m(t),[r,o]=(0,i.useState)((()=>function({defaultValue:t,tabValues:e}){if(0===e.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!p({value:t,tabValues:e}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${e.map((t=>t.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=e.find((t=>t.default))??e[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:e,tabValues:s}))),[l,d]=g({queryString:n,groupId:a}),[h,v]=function({groupId:t}){const e=function(t){return t?`docusaurus.tab.${t}`:null}(t),[n,a]=(0,u.Dv)(e);return[n,(0,i.useCallback)((t=>{e&&a.set(t)}),[e,a])]}({groupId:a}),y=(()=>{const t=l??h;return p({value:t,tabValues:s})?t:null})();(0,c.A)((()=>{y&&o(y)}),[y]);return{selectedValue:r,selectValue:(0,i.useCallback)((t=>{if(!p({value:t,tabValues:s}))throw new Error(`Can't select invalid tab value=${t}`);o(t),d(t),v(t)}),[d,v,s]),tabValues:s}}var y=n(86681);const f={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var x=n(62540);function A({className:t,block:e,selectedValue:n,selectValue:i,tabValues:s}){const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,r.a_)(),l=t=>{const e=t.currentTarget,a=o.indexOf(e),r=s[a].value;r!==n&&(c(e),i(r))},d=t=>{let e=null;switch(t.key){case"Enter":l(t);break;case"ArrowRight":{const n=o.indexOf(t.currentTarget)+1;e=o[n]??o[0];break}case"ArrowLeft":{const n=o.indexOf(t.currentTarget)-1;e=o[n]??o[o.length-1];break}}e?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":e},t),children:s.map((({value:t,label:e,attributes:i})=>(0,x.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:t=>{o.push(t)},onKeyDown:d,onClick:l,...i,className:(0,a.A)("tabs__item",f.tabItem,i?.className,{"tabs__item--active":n===t}),children:e??t},t)))})}function b({lazy:t,children:e,selectedValue:n}){const s=(Array.isArray(e)?e:[e]).filter(Boolean);if(t){const t=s.find((t=>t.props.value===n));return t?(0,i.cloneElement)(t,{className:(0,a.A)("margin-top--md",t.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((t,e)=>(0,i.cloneElement)(t,{key:e,hidden:t.props.value!==n})))})}function _(t){const e=v(t);return(0,x.jsxs)("div",{className:(0,a.A)(s.G.tabs.container,"tabs-container",f.tabList),children:[(0,x.jsx)(A,{...e,...t}),(0,x.jsx)(b,{...e,...t})]})}function j(t){const e=(0,y.A)();return(0,x.jsx)(_,{...t,children:h(t.children)},String(e))}}}]);