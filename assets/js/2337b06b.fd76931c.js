"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[9690],{26802:(e,n,t)=>{t.d(n,{A:()=>s});var a=t(22147),i=t(62540);function s({language:e,children:n}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,i.jsx)(i.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>c});var a=t(63696);const i={},s=a.createContext(i);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:n},e.children)}},51733:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/feedback-6cd52f3d98ce1439c8e07122dc448fa2.gif"},87001:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>p,frontMatter:()=>c,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"python/in-depth-guides/feedback","title":"Feedback","description":"\x3c!--","source":"@site/docs/main/python/in-depth-guides/feedback.mdx","sourceDirName":"python/in-depth-guides","slug":"/python/in-depth-guides/feedback","permalink":"/teams-sdk/python/in-depth-guides/feedback","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/in-depth-guides/feedback.mdx","tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"sidebar_position":7,"title":"Feedback","sidebar_label":"Feedback","summary":"Guide to implementing user feedback functionality in Teams applications, covering feedback UI components, event handling, and storage mechanisms for gathering and managing user responses to improve application performance."},"sidebar":"default","previous":{"title":"A2A Client","permalink":"/teams-sdk/python/in-depth-guides/ai/a2a/a2a-client"},"next":{"title":"Observability","permalink":"/teams-sdk/python/in-depth-guides/observability/"}}');var i=t(62540),s=t(43023),o=t(26802);const c={sidebar_position:7,title:"Feedback",sidebar_label:"Feedback",summary:"Guide to implementing user feedback functionality in Teams applications, covering feedback UI components, event handling, and storage mechanisms for gathering and managing user responses to improve application performance."},r="Feedback",d={},l=[{value:"Storage",id:"storage",level:2},{value:"Including Feedback Buttons",id:"including-feedback-buttons",level:2},{value:"Handling the feedback",id:"handling-the-feedback",level:2}];function m(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"feedback",children:"Feedback"})}),"\n",(0,i.jsx)(n.p,{children:"User feedback is essential for the improvement of any application. Teams provides specialized UI components to help facilitate the gathering of feedback from users."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Animated image showing user selecting the thumbs-up button on an agent response and a dialog opening asking &#39;What did you like?&#39;. The user types &#39;Nice&#39; and hits Submit.",src:t(51733).A+"",width:"1638",height:"1224"})}),"\n",(0,i.jsx)(n.h2,{id:"storage",children:"Storage"}),"\n",(0,i.jsx)(n.p,{children:"Once you receive a feedback event, you can choose to store it in some persistent storage. In the example below, we are storing it in an in-memory store."}),"\n",(0,i.jsxs)(o.A,{language:"python",children:[(0,i.jsx)(n.p,{children:"Once you receive a feedback event, you can choose to store it in some persistent storage. You'll need to implement storage for tracking:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Like/dislike counts per message"}),"\n",(0,i.jsx)(n.li,{children:"Text feedback comments"}),"\n",(0,i.jsx)(n.li,{children:"Message ID associations"}),"\n"]}),(0,i.jsx)(n.p,{children:"For production applications, consider using databases, file systems, or cloud storage. The examples below use in-memory storage for simplicity."})]}),"\n",(0,i.jsx)(n.h2,{id:"including-feedback-buttons",children:"Including Feedback Buttons"}),"\n",(0,i.jsx)(n.p,{children:"When sending a message that you want feedback in, simply add feedback functionality to the message you are sending."}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from microsoft_teams.ai import Agent\nfrom microsoft_teams.api import MessageActivityInput\nfrom microsoft_teams.apps import ActivityContext, MessageActivity\n\n@app.on_message\nasync def handle_message(ctx: ActivityContext[MessageActivity]):\n    """Handle \'feedback demo\' command to demonstrate feedback collection"""\n    agent = Agent(current_model)\n    chat_result = await agent.send(\n        input="Tell me a short joke",\n        instructions="You are a comedian. Keep responses brief and funny."\n    )\n\n    if chat_result.response.content:\n        message = MessageActivityInput(text=chat_result.response.content)\n                    .add_ai_generated()\n                    # Create message with feedback enabled\n                    .add_feedback()\n        await ctx.send(message)\n'})})}),"\n",(0,i.jsx)(n.h2,{id:"handling-the-feedback",children:"Handling the feedback"}),"\n",(0,i.jsx)(n.p,{children:"Once the user decides to like/dislike the message, you can handle the feedback in a received event. Once received, you can choose to include it in your persistent store."}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import json\nfrom typing import Dict, Any\nfrom microsoft_teams.api import MessageSubmitActionInvokeActivity\nfrom microsoft_teams.apps import ActivityContext\n# ...\n\n# Handle feedback submission events\n@app.on_message_submit_feedback\nasync def handle_message_feedback(ctx: ActivityContext[MessageSubmitActionInvokeActivity]):\n    """Handle feedback submission events"""\n    activity = ctx.activity\n\n    # Extract feedback data from activity value\n    if not hasattr(activity, "value") or not activity.value:\n        logger.warning(f"No value found in activity {activity.id}")\n        return\n\n    # Access feedback data directly from invoke value\n    invoke_value = activity.value\n    assert invoke_value.action_name == "feedback"\n    feedback_str = invoke_value.action_value.feedback\n    reaction = invoke_value.action_value.reaction\n    feedback_json: Dict[str, Any] = json.loads(feedback_str)\n    # { \'feedbackText\': \'the ai response was great!\' }\n\n    if not activity.reply_to_id:\n        logger.warning(f"No replyToId found for messageId {activity.id}")\n        return\n\n    # Store the feedback (implement your own storage logic)\n    upsert_feedback_storage(activity.reply_to_id, reaction, feedback_json.get(\'feedbackText\', \'\'))\n\n    # Optionally Send confirmation response\n    feedback_text: str = feedback_json.get("feedbackText", "")\n    reaction_text: str = f" and {reaction}" if reaction else ""\n    text_part: str = f" with comment: \'{feedback_text}\'" if feedback_text else ""\n\n    await ctx.reply(f"\u2705 Thank you for your feedback{reaction_text}{text_part}!")\n'})})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);