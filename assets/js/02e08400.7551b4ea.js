"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[9658],{26802:(e,s,n)=>{n.d(s,{A:()=>i});var a=n(22147),t=n(62540);function i({language:e,children:s}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,t.jsx)(t.Fragment,{children:s}):null}},27023:(e,s,n)=>{n.d(s,{A:()=>a});const a=n.p+"assets/images/streaming-chat-d49edc84e71626c46703881e19aef8c2.gif"},43023:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>c});var a=n(63696);const t={},i=a.createContext(t);function r(e){const s=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(s):{...s,...e}}),[s,e])}function c(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),a.createElement(i.Provider,{value:s},e.children)}},90213:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>o,contentTitle:()=>d,default:()=>g,frontMatter:()=>c,metadata:()=>a,toc:()=>l});const a=JSON.parse('{"id":"csharp/essentials/sending-messages/index","title":"Sending Messages","description":"\x3c!--","source":"@site/docs/main/csharp/essentials/sending-messages/index.mdx","sourceDirName":"csharp/essentials/sending-messages","slug":"/csharp/essentials/sending-messages/","permalink":"/teams-sdk/csharp/essentials/sending-messages/","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/csharp/essentials/sending-messages/index.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"summary":"Guide to sending messages from your Teams SDK agent, including replies, proactive messages, and different message types.","title":"Sending Messages"},"sidebar":"default","previous":{"title":"Listening To Activities","permalink":"/teams-sdk/csharp/essentials/on-activity/"},"next":{"title":"Proactive Messaging","permalink":"/teams-sdk/csharp/essentials/sending-messages/proactive-messaging"}}');var t=n(62540),i=n(43023),r=n(26802);const c={sidebar_position:4,summary:"Guide to sending messages from your Teams SDK agent, including replies, proactive messages, and different message types.",title:"Sending Messages"},d="Sending Messages",o={},l=[{value:"Streaming",id:"streaming",level:2},{value:"@Mention",id:"mention",level:2},{value:"Targeted Messages",id:"targeted-messages",level:2}];function h(e){const s={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.header,{children:(0,t.jsx)(s.h1,{id:"sending-messages",children:"Sending Messages"})}),"\n",(0,t.jsxs)(s.p,{children:["Sending messages is a core part of an agent's functionality. With all activity handlers, a ",(0,t.jsx)(s.code,{children:"send"})," method is provided which allows your handlers to send a message back to the user to the relevant conversation."]}),"\n",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'app.OnMessage(async context =>\n{\n    await context.Send($"you said: {context.activity.Text}");\n});\n'})})}),"\n",(0,t.jsxs)(s.p,{children:["In the above example, the handler gets a ",(0,t.jsx)(s.code,{children:"message"})," activity, and uses the ",(0,t.jsx)(s.code,{children:"send"})," method to send a reply to the user."]}),"\n",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'  app.OnVerifyState(async context =>\n  {\n      await context.Send("You have successfully signed in!");\n  });\n'})})}),"\n",(0,t.jsxs)(s.p,{children:["You are not restricted to only replying to ",(0,t.jsx)(s.code,{children:"message"})," activities. In the above example, the handler is listening to ",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.code,{children:"SignIn.VerifyState"})})," events, which are sent when a user successfully signs in."]}),"\n",(0,t.jsx)(s.admonition,{type:"tip",children:(0,t.jsxs)(s.p,{children:["This shows an example of sending a text message. Additionally, you are able to send back things like ",(0,t.jsx)(s.a,{href:"../../in-depth-guides/adaptive-cards",children:"adaptive cards"})," by using the same ",(0,t.jsx)(s.code,{children:"send"})," method. Look at the ",(0,t.jsx)(s.a,{href:"../../in-depth-guides/adaptive-cards",children:"adaptive card"})," section for more details."]})}),"\n",(0,t.jsx)(s.h2,{id:"streaming",children:"Streaming"}),"\n",(0,t.jsxs)(s.p,{children:["You may also stream messages to the user which can be useful for long messages, or AI generated messages. The SDK makes this simple for you by providing a ",(0,t.jsx)(s.code,{children:"stream"})," function which you can use to send messages in chunks."]}),"\n",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'app.OnMessage(async context =>\n{\n    context.Stream.Emit("hello");\n    context.Stream.Emit(", ");\n    context.Stream.Emit("world!");\n    // result message: "hello, world!"\n    return Task.CompletedTask;\n});\n'})})}),"\n",(0,t.jsx)(s.admonition,{type:"note",children:(0,t.jsx)(s.p,{children:"Streaming is currently only supported in 1:1 conversations, not group chats or channels"})}),"\n",(0,t.jsx)(s.p,{children:(0,t.jsx)(s.img,{alt:"Animated image showing agent response text incrementally appearing in the chat window.",src:n(27023).A+"",width:"2006",height:"804"})}),"\n",(0,t.jsx)(s.h2,{id:"mention",children:"@Mention"}),"\n",(0,t.jsxs)(s.p,{children:["Sending a message at ",(0,t.jsx)(s.code,{children:"@mentions"})," a user is as simple including the details of the user using the ",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.code,{children:"AddMention"})})," method"]}),"\n",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'app.OnMessage(async context =>\n{\n    await context.Send(new MessageActivity("hi!").AddMention(activity.From));\n});\n'})})}),"\n",(0,t.jsx)(s.h2,{id:"targeted-messages",children:"Targeted Messages"}),"\n",(0,t.jsx)(s.admonition,{title:"Preview",type:"info",children:(0,t.jsx)(s.p,{children:"Targeted messages are currently in preview."})}),"\n",(0,t.jsx)(s.p,{children:"Targeted messages, also known as ephemeral messages, are delivered to a specific user in a shared conversation. From a single user's perspective, it appears as regular inline messages in a conversation. Other participants won't see these messages, making them useful for authentication flows, help or error responses, personal reminders, or sharing contextual information without cluttering the group conversation."}),"\n",(0,t.jsxs)(s.p,{children:["To send a targeted message when responding to an incoming activity, use the ",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.code,{children:"WithTargetedRecipient"})})," method. The recipient will automatically be set to the user who sent the incoming message."]}),"\n",(0,t.jsx)(r.A,{language:"csharp",children:(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-csharp",children:'app.OnMessage(async context =>\n{\n    // Using WithTargetedRecipient(true) automatically targets the sender of the incoming message\n    await context.Send(\n        new MessageActivity("This message is only visible to you!")\n            .WithTargetedRecipient(true)\n    );\n});\n'})})})]})}function g(e={}){const{wrapper:s}={...(0,i.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);