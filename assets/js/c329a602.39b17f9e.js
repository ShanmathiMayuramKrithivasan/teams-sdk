"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[2105],{12255:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>a,toc:()=>p});const a=JSON.parse('{"id":"python/in-depth-guides/dialogs/handling-multi-step-forms","title":"Handling Multi-Step Forms","description":"\x3c!--","source":"@site/docs/main/python/in-depth-guides/dialogs/handling-multi-step-forms.mdx","sourceDirName":"python/in-depth-guides/dialogs","slug":"/python/in-depth-guides/dialogs/handling-multi-step-forms","permalink":"/teams-sdk/python/in-depth-guides/dialogs/handling-multi-step-forms","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/in-depth-guides/dialogs/handling-multi-step-forms.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"Handling Multi-Step Forms","title":"Handling Multi-Step Forms","summary":"Tutorial on implementing multi-step dialogs in Teams, demonstrating how to create dynamic form flows that adapt based on user input, with examples of handling state between steps and conditional navigation."},"sidebar":"default","previous":{"title":"Handling Dialog Submissions","permalink":"/teams-sdk/python/in-depth-guides/dialogs/handling-dialog-submissions"},"next":{"title":"Message Extensions","permalink":"/teams-sdk/python/in-depth-guides/message-extensions/"}}');var s=t(62540),i=t(43023),o=t(26802);const d={sidebar_position:3,sidebar_label:"Handling Multi-Step Forms",title:"Handling Multi-Step Forms",summary:"Tutorial on implementing multi-step dialogs in Teams, demonstrating how to create dynamic form flows that adapt based on user input, with examples of handling state between steps and conditional navigation."},l="Handling Multi-Step Forms",r={},p=[];function m(e){const n={code:"code",h1:"h1",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"handling-multi-step-forms",children:"Handling Multi-Step Forms"})}),"\n",(0,s.jsx)(n.p,{children:"Dialogs can become complex yet powerful with multi-step forms. These forms can alter the flow of the survey depending on the user's input or customize subsequent steps based on previous answers."}),"\n",(0,s.jsx)(o.A,{language:"python",children:(0,s.jsxs)(n.p,{children:["Start off by sending an initial card in the ",(0,s.jsx)(n.code,{children:"dialog_open"})," event."]})}),"\n",(0,s.jsx)(o.A,{language:"python",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'dialog_card = AdaptiveCard.model_validate(\n            {\n                "type": "AdaptiveCard",\n                "version": "1.4",\n                "body": [\n                    {"type": "TextBlock", "text": "This is a multi-step form", "size": "Large", "weight": "Bolder"},\n                    {\n                        "type": "Input.Text",\n                        "id": "name",\n                        "label": "Name",\n                        "placeholder": "Enter your name",\n                        "isRequired": True,\n                    },\n                ],\n                "actions": [\n                    {\n                        "type": "Action.Submit",\n                        "title": "Submit",\n                        "data": {"submissiondialogtype": "webpage_dialog_step_1"},\n                    }\n                ],\n            }\n        )\n'})})}),"\n",(0,s.jsxs)(o.A,{language:"python",children:[(0,s.jsxs)(n.p,{children:["Then in the submission handler, you can choose to ",(0,s.jsx)(n.code,{children:"continue"})," the dialog with a different card."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'\n@app.on_dialog_submit\nasync def handle_dialog_submit(ctx: ActivityContext[TaskSubmitInvokeActivity]):\n    """Handle dialog submit events for all dialog types."""\n    data: Optional[Any] = ctx.activity.value.data\n    dialog_type = data.get("submissiondialogtype") if data else None\n\n    if dialog_type == "webpage_dialog":\n        name = data.get("name") if data else None\n        email = data.get("email") if data else None\n        await ctx.send(f"Hi {name}, thanks for submitting the form! We got that your email is {email}")\n        return InvokeResponse(\n            body=TaskModuleResponse(task=TaskModuleMessageResponse(value="Form submitted successfully"))\n        )\n\n    elif dialog_type == "webpage_dialog_step_1":\n        name = data.get("name") if data else None\n        next_step_card = AdaptiveCard.model_validate(\n            {\n                "type": "AdaptiveCard",\n                "version": "1.4",\n                "body": [\n                    {"type": "TextBlock", "text": "Email", "size": "Large", "weight": "Bolder"},\n                    {\n                        "type": "Input.Text",\n                        "id": "email",\n                        "label": "Email",\n                        "placeholder": "Enter your email",\n                        "isRequired": True,\n                    },\n                ],\n                "actions": [\n                    {\n                        "type": "Action.Submit",\n                        "title": "Submit",\n                        "data": {"submissiondialogtype": "webpage_dialog_step_2", "name": name},\n                    }\n                ],\n            }\n        )\n\n        return InvokeResponse(\n            body=TaskModuleResponse(\n                task=TaskModuleContinueResponse(\n                    value=CardTaskModuleTaskInfo(\n                        title=f"Thanks {name} - Get Email",\n                        card=card_attachment(AdaptiveCardAttachment(content=next_step_card)),\n                    )\n                )\n            )\n        )\n\n    elif dialog_type == "webpage_dialog_step_2":\n        name = data.get("name") if data else None\n        email = data.get("email") if data else None\n        await ctx.send(f"Hi {name}, thanks for submitting the form! We got that your email is {email}")\n        return InvokeResponse(\n            body=TaskModuleResponse(task=TaskModuleMessageResponse(value="Multi-step form completed successfully"))\n        )\n\n    return TaskModuleResponse(task=TaskModuleMessageResponse(value="Unknown submission type"))\n\n'})})]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(m,{...e})}):m(e)}},26802:(e,n,t)=>{t.d(n,{A:()=>i});var a=t(22147),s=t(62540);function i({language:e,children:n}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>d});var a=t(63696);const s={},i=a.createContext(s);function o(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),a.createElement(i.Provider,{value:n},e.children)}}}]);