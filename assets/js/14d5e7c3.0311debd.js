"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[1535],{22491:(e,a,t)=>{t.d(a,{A:()=>i});t(63696);var r=t(11750);const s={tabItem:"tabItem_wHwb"};var n=t(62540);function i({children:e,hidden:a,className:t}){return(0,n.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,t),hidden:a,children:e})}},26802:(e,a,t)=>{t.d(a,{A:()=>n});var r=t(22147),s=t(62540);function n({language:e,children:a}){return(0,r.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:a}):null}},33321:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>c,contentTitle:()=>l,default:()=>d,frontMatter:()=>o,metadata:()=>r,toc:()=>u});const r=JSON.parse('{"id":"csharp/essentials/graph","title":"Graph API Client","description":"\x3c!--","source":"@site/docs/main/csharp/essentials/graph.mdx","sourceDirName":"csharp/essentials","slug":"/csharp/essentials/graph","permalink":"/teams-sdk/csharp/essentials/graph","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/csharp/essentials/graph.mdx","tags":[],"version":"current","sidebarPosition":8,"frontMatter":{"sidebar_position":8,"sidebar_label":"Graph API Client","title":"Graph API Client","summary":"Guide to using the Microsoft Graph API client to access Microsoft 365 data and services from your Teams SDK application."},"sidebar":"default","previous":{"title":"Hosting Static Pages","permalink":"/teams-sdk/csharp/essentials/hosting-static-pages"},"next":{"title":"In-Depth Guides","permalink":"/teams-sdk/csharp/in-depth-guides/"}}');var s=t(62540),n=t(43023),i=t(26802);t(78296),t(22491);const o={sidebar_position:8,sidebar_label:"Graph API Client",title:"Graph API Client",summary:"Guide to using the Microsoft Graph API client to access Microsoft 365 data and services from your Teams SDK application."},l="Graph API Client",c={},u=[{value:"Calling APIs",id:"calling-apis",level:2}];function h(e){const a={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.header,{children:(0,s.jsx)(a.h1,{id:"graph-api-client",children:"Graph API Client"})}),"\n",(0,s.jsxs)(a.p,{children:[(0,s.jsx)(a.a,{href:"https://docs.microsoft.com/en-us/graph/overview",children:"Microsoft Graph"})," gives you access to the wider Microsoft 365 ecosystem. You can enrich your application with data from across Microsoft 365."]}),"\n",(0,s.jsxs)(a.p,{children:["The SDK gives your application easy access to the Microsoft Graph API via the ",(0,s.jsxs)(i.A,{language:"csharp",children:[(0,s.jsx)(a.code,{children:"Microsoft.Graph"})," package"]}),"."]}),"\n",(0,s.jsx)(a.h2,{id:"calling-apis",children:"Calling APIs"}),"\n",(0,s.jsxs)(a.p,{children:["Microsoft Graph can be accessed by your application using its own application token, or by using the user's token. If you need access to resources that your application may not have, but your user does, you will need to use the user's scoped graph client. To grant explicit consent for your application to access resources on behalf of a user, follow the ",(0,s.jsx)(a.a,{href:"../in-depth-guides/user-authentication",children:"auth guide"}),"."]}),"\n",(0,s.jsxs)(a.p,{children:["To access the graph using the Graph using the app, you may use the ",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.code,{children:"app.Graph"})})," object ."]}),"\n",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-csharp",children:'// Equivalent of https://learn.microsoft.com/en-us/graph/api/user-get\n// Gets the details of the bot-user\nvar user = app.Graph.Me.GetAsync().GetAwaiter().GetResult();\nConsole.WriteLine($"User ID: {user.id}");\nConsole.WriteLine($"User Display Name: {user.displayName}");\nConsole.WriteLine($"User Email: {user.mail}");\nConsole.WriteLine($"User Job Title: {user.jobTitle}");\n'})})}),"\n",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.p,{children:"To access the graph using the user's token, you need to do this as part of a message handler:"})}),"\n",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.pre,{children:(0,s.jsx)(a.code,{className:"language-csharp",children:'app.OnMessage(async context =>\n{\n    var user = await context.UserGraph.Me.GetAsync();\n    Console.WriteLine($"User ID: {user.id}");\n    Console.WriteLine($"User Display Name: {user.displayName}");\n    Console.WriteLine($"User Email: {user.mail}");\n    Console.WriteLine($"User Job Title: {user.jobTitle}");\n});\n'})})}),"\n",(0,s.jsxs)(a.p,{children:["Here, the ",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.code,{children:"userGraph"})})," object is a scoped graph client for the user that sent the message."]}),"\n",(0,s.jsx)(a.admonition,{type:"tip",children:(0,s.jsxs)(a.p,{children:["You also have access to the ",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.code,{children:"appGraph"})})," object in the activity handler. This is equivalent to ",(0,s.jsx)(i.A,{language:"csharp",children:(0,s.jsx)(a.code,{children:"app.Graph"})}),"."]})})]})}function d(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,s.jsx)(a,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},43023:(e,a,t)=>{t.d(a,{R:()=>i,x:()=>o});var r=t(63696);const s={},n=r.createContext(s);function i(e){const a=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(n.Provider,{value:a},e.children)}},78296:(e,a,t)=>{t.d(a,{A:()=>I});var r=t(63696),s=t(11750),n=t(53237),i=t(90766),o=t(22147),l=t(14395),c=t(35043),u=t(44544),h=t(41506);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:a}=e;return!!a&&"object"==typeof a&&"value"in a}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:a,children:t}=e;return(0,r.useMemo)((()=>{const e=a??function(e){return d(e).map((({props:{value:e,label:a,attributes:t,default:r}})=>({value:e,label:a,attributes:t,default:r})))}(t);return function(e){const a=(0,u.XI)(e,((e,a)=>e.value===a.value));if(a.length>0)throw new Error(`Docusaurus error: Duplicate values "${a.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[a,t])}function m({value:e,tabValues:a}){return a.some((a=>a.value===e))}function f({queryString:e=!1,groupId:a}){const t=(0,o.W6)(),s=function({queryString:e=!1,groupId:a}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!a)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return a??null}({queryString:e,groupId:a});return[(0,c.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const a=new URLSearchParams(t.location.search);a.set(s,e),t.replace({...t.location,search:a.toString()})}),[s,t])]}function g(e){const{defaultValue:a,queryString:t=!1,groupId:s}=e,n=p(e),[i,o]=(0,r.useState)((()=>function({defaultValue:e,tabValues:a}){if(0===a.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!m({value:e,tabValues:a}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${a.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=a.find((e=>e.default))??a[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:a,tabValues:n}))),[c,u]=f({queryString:t,groupId:s}),[d,g]=function({groupId:e}){const a=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,s]=(0,h.Dv)(a);return[t,(0,r.useCallback)((e=>{a&&s.set(e)}),[a,s])]}({groupId:s}),b=(()=>{const e=c??d;return m({value:e,tabValues:n})?e:null})();(0,l.A)((()=>{b&&o(b)}),[b]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:n}))throw new Error(`Can't select invalid tab value=${e}`);o(e),u(e),g(e)}),[u,g,n]),tabValues:n}}var b=t(86681);const v={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var x=t(62540);function y({className:e,block:a,selectedValue:t,selectValue:r,tabValues:n}){const o=[],{blockElementScrollPositionUntilNextRender:l}=(0,i.a_)(),c=e=>{const a=e.currentTarget,s=o.indexOf(a),i=n[s].value;i!==t&&(l(a),r(i))},u=e=>{let a=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;a=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;a=o[t]??o[o.length-1];break}}a?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":a},e),children:n.map((({value:e,label:a,attributes:r})=>(0,x.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{o.push(e)},onKeyDown:u,onClick:c,...r,className:(0,s.A)("tabs__item",v.tabItem,r?.className,{"tabs__item--active":t===e}),children:a??e},e)))})}function j({lazy:e,children:a,selectedValue:t}){const n=(Array.isArray(a)?a:[a]).filter(Boolean);if(e){const e=n.find((e=>e.props.value===t));return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:n.map(((e,a)=>(0,r.cloneElement)(e,{key:a,hidden:e.props.value!==t})))})}function A(e){const a=g(e);return(0,x.jsxs)("div",{className:(0,s.A)(n.G.tabs.container,"tabs-container",v.tabList),children:[(0,x.jsx)(y,{...a,...e}),(0,x.jsx)(j,{...a,...e})]})}function I(e){const a=(0,b.A)();return(0,x.jsx)(A,{...e,children:d(e.children)},String(a))}}}]);