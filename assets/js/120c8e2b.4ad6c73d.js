"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[412],{26802:(e,n,t)=>{t.d(n,{A:()=>r});var a=t(22147),s=t(62540);function r({language:e,children:n}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},27792:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>a,toc:()=>p});const a=JSON.parse('{"id":"python/in-depth-guides/ai/a2a/a2a-server","title":"A2A Server","description":"\x3c!--","source":"@site/docs/main/python/in-depth-guides/ai/a2a/a2a-server.mdx","sourceDirName":"python/in-depth-guides/ai/a2a","slug":"/python/in-depth-guides/ai/a2a/a2a-server","permalink":"/teams-sdk/python/in-depth-guides/ai/a2a/a2a-server","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/in-depth-guides/ai/a2a/a2a-server.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"title":"A2A Server","summary":"How to implement an A2A server to expose your Teams app capabilities to other agents using the A2A protocol.","languages":["typescript","python"]},"sidebar":"default","previous":{"title":"A2A Protocol","permalink":"/teams-sdk/python/in-depth-guides/ai/a2a/"},"next":{"title":"A2A Client","permalink":"/teams-sdk/python/in-depth-guides/ai/a2a/a2a-client"}}');var s=t(62540),r=t(43023),i=t(26802);t(50630);const o={sidebar_position:1,title:"A2A Server",summary:"How to implement an A2A server to expose your Teams app capabilities to other agents using the A2A protocol.",languages:["typescript","python"]},l="A2A Server",d={},p=[{value:"What is an A2A Server?",id:"what-is-an-a2a-server",level:2},{value:"Adding the <code>A2APlugin</code>",id:"adding-the-a2aplugin",level:2},{value:"Agent Card Exposure",id:"agent-card-exposure",level:2},{value:"Handling A2A Requests",id:"handling-a2a-requests",level:2},{value:"Sequence Diagram",id:"sequence-diagram",level:2}];function c(e){const n={admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"a2a-server",children:"A2A Server"})}),"\n",(0,s.jsx)(n.h2,{id:"what-is-an-a2a-server",children:"What is an A2A Server?"}),"\n",(0,s.jsx)(n.p,{children:"An A2A server is an agent that exposes its capabilities to other agents using the A2A protocol. With this package, you can make your Teams app accessible to A2A clients."}),"\n",(0,s.jsxs)(n.h2,{id:"adding-the-a2aplugin",children:["Adding the ",(0,s.jsx)(n.code,{children:"A2APlugin"})]}),"\n",(0,s.jsxs)(n.p,{children:["To enable A2A server functionality, add the ",(0,s.jsx)(n.code,{children:"A2APlugin"})," to your Teams app and provide an ",(0,s.jsx)(i.A,{language:"python",children:(0,s.jsx)(n.code,{children:"agent_card"})}),":"]}),"\n",(0,s.jsx)(i.A,{language:"python",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from os import getenv\nfrom a2a.types import AgentCard, AgentCapabilities, AgentSkill\nfrom microsoft_teams.a2a import A2APlugin, A2APluginOptions\nfrom microsoft_teams.apps import App, PluginBase\n\nPORT = getenv("PORT", "4000")\n\nagent_card = AgentCard(\n    name="weather_agent",\n    description="An agent that can tell you the weather",\n    url=f"http://localhost:{PORT}/a2a/",\n    version="0.0.1",\n    protocol_version="0.3.0",\n    capabilities=AgentCapabilities(),\n    default_input_modes=[],\n    default_output_modes=[],\n    skills=[\n        AgentSkill(\n            # Expose various skills that this agent can perform\n            id="get_weather",\n            name="Get Weather",\n            description="Get the weather for a given location",\n            tags=["weather", "get", "location"],\n            examples=[\n                # Give concrete examples on how to contact the agent\n                "Get the weather for London",\n                "What is the weather",\n                "What\'s the weather in Tokyo?",\n                "How is the current temperature in San Francisco?",\n            ],\n        ),\n    ],\n)\n\nplugins: List[PluginBase] = [A2APlugin(A2APluginOptions(agent_card=agent_card))]\napp = App(logger=logger, plugins=plugins)\n'})})}),"\n",(0,s.jsx)(n.h2,{id:"agent-card-exposure",children:"Agent Card Exposure"}),"\n",(0,s.jsxs)(n.p,{children:["The plugin automatically exposes your agent card at the path ",(0,s.jsx)(n.code,{children:"/a2a/.well-known/agent-card.json"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"handling-a2a-requests",children:"Handling A2A Requests"}),"\n",(0,s.jsxs)(n.p,{children:["Handle incoming A2A requests by adding an event handler for the ",(0,s.jsx)(n.code,{children:"a2a:message"})," event. You may use ",(0,s.jsx)(n.code,{children:"accumulateArtifacts"})," to iteratively accumulate artifacts for the task, or simply ",(0,s.jsx)(n.code,{children:"respond"})," with the final result."]}),"\n",(0,s.jsx)(i.A,{language:"python",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'from microsoft_teams.a2a import A2AMessageEvent, A2AMessageEventKey\nfrom a2a.types import TextPart\n\n@app.event(A2AMessageEventKey)\nasync def handle_a2a_message(message: A2AMessageEvent) -> None:\n    request_context = message.get("request_context")\n    respond = message.get("respond")\n\n    logger.info(f"Received message: {request_context.message}")\n\n    if request_context.message:\n        text_input = None\n        for part in request_context.message.parts:\n            if getattr(part.root, "kind", None) == "text":\n                text_part = cast(TextPart, part.root)\n                text_input = text_part.text\n                break\n        if not text_input:\n            await respond("My agent currently only supports text input")\n            return\n\n        result = await my_event_handler(text_input)\n        await respond(result)\n'})})}),"\n",(0,s.jsx)(n.admonition,{type:"note",children:(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["You must have only a single handler that calls ",(0,s.jsx)(n.code,{children:"respond"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["You ",(0,s.jsx)(n.strong,{children:"must"})," call ",(0,s.jsx)(n.code,{children:"respond"})," as the last step in your handler. This resolves the open request to the caller."]}),"\n"]})}),"\n",(0,s.jsx)(n.h2,{id:"sequence-diagram",children:"Sequence Diagram"}),"\n",(0,s.jsx)(n.mermaid,{value:"sequenceDiagram\n    participant A2A Client\n    participant App\n    participant A2APlugin\n    participant YourEventHandler\n\n    A2A Client->>App: /task/send\n    App->>A2APlugin: Call A2APlugin\n    A2APlugin->>YourEventHandler: Call your event handler a2a:message\n    YourEventHandler->>A2APlugin: Call respond\n    A2APlugin->>A2A Client: Return response"})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},50630:(e,n,t)=>{t(63696),t(5535),t(10883),t(62540)}}]);