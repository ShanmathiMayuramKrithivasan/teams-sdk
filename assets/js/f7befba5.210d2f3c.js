"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[3371],{22491:(e,n,t)=>{t.d(n,{A:()=>o});t(63696);var a=t(11750);const i={tabItem:"tabItem_wHwb"};var s=t(62540);function o({children:e,hidden:n,className:t}){return(0,s.jsx)("div",{role:"tabpanel",className:(0,a.A)(i.tabItem,t),hidden:n,children:e})}},26802:(e,n,t)=>{t.d(n,{A:()=>s});var a=t(22147),i=t(62540);function s({language:e,children:n}){return(0,a.zy)().pathname.includes(`/${e}/`)?(0,i.jsx)(i.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>r});var a=t(63696);const i={},s=a.createContext(i);function o(e){const n=a.useContext(s);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:n},e.children)}},78296:(e,n,t)=>{t.d(n,{A:()=>T});var a=t(63696),i=t(11750),s=t(53237),o=t(90766),r=t(22147),c=t(14395),l=t(35043),d=t(44544),p=t(41506);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function g(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a})))}(t);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const t=(0,r.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,l.aZ)(i),(0,a.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(t.location.search);n.set(i,e),t.replace({...t.location,search:n.toString()})}),[i,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,s=g(e),[o,r]=(0,a.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:s}))),[l,d]=m({queryString:t,groupId:i}),[u,f]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,i]=(0,p.Dv)(n);return[t,(0,a.useCallback)((e=>{n&&i.set(e)}),[n,i])]}({groupId:i}),_=(()=>{const e=l??u;return h({value:e,tabValues:s})?e:null})();(0,c.A)((()=>{_&&r(_)}),[_]);return{selectedValue:o,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);r(e),d(e),f(e)}),[d,f,s]),tabValues:s}}var _=t(86681);const y={tabList:"tabList_J5MA",tabItem:"tabItem_l0OV"};var v=t(62540);function x({className:e,block:n,selectedValue:t,selectValue:a,tabValues:s}){const r=[],{blockElementScrollPositionUntilNextRender:c}=(0,o.a_)(),l=e=>{const n=e.currentTarget,i=r.indexOf(n),o=s[i].value;o!==t&&(c(n),a(o))},d=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=r.indexOf(e.currentTarget)+1;n=r[t]??r[0];break}case"ArrowLeft":{const t=r.indexOf(e.currentTarget)-1;n=r[t]??r[r.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:s.map((({value:e,label:n,attributes:a})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{r.push(e)},onKeyDown:d,onClick:l,...a,className:(0,i.A)("tabs__item",y.tabItem,a?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function A({lazy:e,children:n,selectedValue:t}){const s=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=s.find((e=>e.props.value===t));return e?(0,a.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:s.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function b(e){const n=f(e);return(0,v.jsxs)("div",{className:(0,i.A)(s.G.tabs.container,"tabs-container",y.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(A,{...n,...e})]})}function T(e){const n=(0,_.A)();return(0,v.jsx)(b,{...e,children:u(e.children)},String(n))}},91249:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"python/migrations/v1","title":"Migrating from Teams SDK v1","description":"\x3c!--","source":"@site/docs/main/python/migrations/v1.mdx","sourceDirName":"python/migrations","slug":"/python/migrations/v1","permalink":"/teams-sdk/python/migrations/v1","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/migrations/v1.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"Migrating from Teams SDK v1","languages":["typescript","python"],"summary":"Migration guide from Teams SDK v1 to v2 highlighting the key changes and upgrade steps."},"sidebar":"default","previous":{"title":"User Authentication","permalink":"/teams-sdk/python/migrations/botbuilder/user-authentication"},"next":{"title":"Developer Tools","permalink":"/teams-sdk/developer-tools/"}}');var i=t(62540),s=t(43023),o=t(26802),r=t(78296),c=t(22491);const l={sidebar_position:2,title:"Migrating from Teams SDK v1",languages:["typescript","python"],summary:"Migration guide from Teams SDK v1 to v2 highlighting the key changes and upgrade steps."},d="Migrating from Teams SDK v1",p={},u=[{value:"Installing Teams SDK",id:"installing-teams-sdk",level:2},{value:"Migrate Application class",id:"migrate-application-class",level:2},{value:"Migrate activity handlers",id:"migrate-activity-handlers",level:2},{value:"Message handlers",id:"message-handlers",level:3},{value:"Task modules",id:"task-modules",level:3},{value:"Adaptive cards",id:"adaptive-cards",level:2},{value:"Authentication",id:"authentication",level:2},{value:"AI",id:"ai",level:2},{value:"Action planner",id:"action-planner",level:3},{value:"Feedback",id:"feedback",level:3},{value:"Incrementally migrating code via botbuilder plugin",id:"incrementally-migrating-code-via-botbuilder-plugin",level:2}];function g(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"migrating-from-teams-sdk-v1",children:"Migrating from Teams SDK v1"})}),"\n",(0,i.jsxs)(n.p,{children:["Welcome, fellow agent developer! You've made it through a full major release of Teams SDK, and now you want to take the plunge into v2. In this guide, we'll walk you through everything you need to know, from migrating core features like message handlers and auth, to optional AI features like ",(0,i.jsx)(n.code,{children:"ActionPlanner"}),". ",(0,i.jsxs)(o.A,{language:"python",children:["We'll also discuss how you can migrate features over incrementally via the ",(0,i.jsx)(n.a,{href:"./botbuilder",children:"botbuilder plugin"}),"."]})]}),"\n",(0,i.jsx)(n.h2,{id:"installing-teams-sdk",children:"Installing Teams SDK"}),"\n",(0,i.jsxs)(o.A,{language:"python",children:[(0,i.jsxs)(n.p,{children:["First, let's install Teams SDK into your project. Notably, this won't replace any existing installation of Teams SDK. When you've completed your migration, you can safely remove the ",(0,i.jsx)(n.code,{children:"teams-ai"})," dependency from your ",(0,i.jsx)(n.code,{children:"pyproject.toml"})," file."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"pip install microsoft-teams-apps\n"})})]}),"\n",(0,i.jsx)(n.h2,{id:"migrate-application-class",children:"Migrate Application class"}),"\n",(0,i.jsxs)(n.p,{children:["First, migrate your ",(0,i.jsx)(n.code,{children:"Application"})," class from v1 to the new ",(0,i.jsx)(n.code,{children:"App"})," class."]}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    # in api.py\n-    from http import HTTPStatus\n-\n-    from aiohttp import web\n-    from botbuilder.core.integration import aiohttp_error_middleware\n-\n-    from bot import app\n-\n-    routes = web.RouteTableDef()\n-\n-    @routes.post("/api/messages")\n-    async def on_messages(req: web.Request) -> web.Response:\n-        res = await app.process(req)\n-        if res is not None:\n-            return res\n-        return web.Response(status=HTTPStatus.OK)\n-\n-    # in bot.py\n-    import sys\n-    import traceback\n-\n-    from botbuilder.core import TurnContext, MemoryStorage\n-    from teams import Application, ApplicationOptions, TeamsAdapter\n-    from teams.state import TurnState\n-\n-    config = Config()\n-    storage = MemoryStorage()\n-    app = Application[TurnState](\n-        ApplicationOptions(\n-            bot_app_id=config.APP_ID,\n-            adapter=TeamsAdapter(config),\n-            storage=storage\n-        )\n-    )\n-\n-    @app.activity("message")\n-    async def on_message(context: TurnContext, _state: TurnState):\n-        await context.send_activity(f"you said: {context.activity.text}")\n-        return True\n-\n-    @app.error\n-    async def on_error(context: TurnContext, error: Exception):\n-        print(f"\\n [on_turn_error] unhandled error: {error}", file=sys.stderr)\n-        traceback.print_exc()\n-        await context.send_activity("The bot encountered an error or bug.")\n# highlight-error-end\n# highlight-success-start\n+    # in main.py\n+    import asyncio\n+    import logging\n+\n+    from microsoft_teams.api import MessageActivity\n+    from microsoft_teams.apps import ActivityContext, App, ErrorEvent\n+    from microsoft_teams.common import LocalStorage\n+\n+    logger = logging.getLogger(__name__)\n+\n+    # Define the app\n+    app = App()\n+\n+    # Optionally create local storage\n+    storage: LocalStorage[str] = LocalStorage()\n+\n+    @app.on_message\n+    async def handle_message(ctx: ActivityContext[MessageActivity]):\n+        await ctx.send(f"You said \'{ctx.activity.text}\'")\n+\n+    # Listen for errors\n+    @app.event("error")\n+    async def handle_error(event: ErrorEvent) -> None:\n+        """Handle errors."""\n+        logger.error(f"Error occurred: {event.error}")\n+        if event.context:\n+            logger.warning(f"Context: {event.context}")\n+\n+    if __name__ == "__main__":\n+        asyncio.run(app.start())\n# highlight-success-end\n'})})}),(0,i.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# in main.py\nimport asyncio\nimport logging\n\nfrom microsoft_teams.api import MessageActivity\nfrom microsoft_teams.apps import ActivityContext, App, ErrorEvent\nfrom microsoft_teams.common import LocalStorage\n\nlogger = logging.getLogger(__name__)\n\n# Define the app\napp = App()\n\n# Optionally create local storage\nstorage: LocalStorage[str] = LocalStorage()\n\n@app.on_message\nasync def handle_message(ctx: ActivityContext[MessageActivity]):\n    await ctx.send(f"You said \'{ctx.activity.text}\'")\n\n# Listen for errors\n@app.event("error")\nasync def handle_error(event: ErrorEvent) -> None:\n    """Handle errors."""\n    logger.error(f"Error occurred: {event.error}")\n    if event.context:\n        logger.warning(f"Context: {event.context}")\n\n\nif __name__ == "__main__":\n    asyncio.run(app.start())\n'})})}),(0,i.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# in api.py\nfrom http import HTTPStatus\n\nfrom aiohttp import web\nfrom botbuilder.core.integration import aiohttp_error_middleware\n\nfrom bot import app\n\nroutes = web.RouteTableDef()\n\n\n@routes.post("/api/messages")\nasync def on_messages(req: web.Request) -> web.Response:\n    res = await app.process(req)\n\n    if res is not None:\n        return res\n\n    return web.Response(status=HTTPStatus.OK)\n\n\napi = web.Application(middlewares=[aiohttp_error_middleware])\napi.add_routes(routes)\n\n# in app.py\nfrom aiohttp import web\n\nfrom api import api\nfrom config import Config\n\nif __name__ == "__main__":\n    web.run_app(api, host="localhost", port=Config.PORT)\n\n# in bot.py\nimport sys\nimport traceback\n\nfrom botbuilder.core import TurnContext, MemoryStorage\nfrom teams import Application, ApplicationOptions, TeamsAdapter\nfrom teams.state import TurnState\n\nfrom config import Config\n\nconfig = Config()\nstorage = MemoryStorage()\napp = Application[TurnState](\n    ApplicationOptions(\n        bot_app_id=config.APP_ID,\n        adapter=TeamsAdapter(config),\n        storage=storage\n    )\n)\n\n@app.activity("message")\nasync def on_message(context: TurnContext, _state: TurnState):\n    await context.send_activity(f"you said: {context.activity.text}")\n    return True\n\n\n@app.error\nasync def on_error(context: TurnContext, error: Exception):\n    # This check writes out errors to console log .vs. app insights.\n    # NOTE: In production environment, you should consider logging this to Azure\n    #       application insights.\n    print(f"\\n [on_turn_error] unhandled error: {error}", file=sys.stderr)\n    traceback.print_exc()\n\n    # Send a message to the user\n    await context.send_activity("The bot encountered an error or bug.")\n'})})})]})}),"\n",(0,i.jsx)(n.h2,{id:"migrate-activity-handlers",children:"Migrate activity handlers"}),"\n",(0,i.jsxs)(n.p,{children:["Both v1 and v2 are built atop incoming ",(0,i.jsx)(n.code,{children:"Activity"})," requests, which trigger handlers in your code when specific type of activities are received. The syntax for how you register different types of ",(0,i.jsx)(n.code,{children:"Activity"})," handlers differs ",(0,i.jsx)(o.A,{language:"python",children:"slightly"})," between the v1 and v2 versions of our SDK."]}),"\n",(0,i.jsx)(n.h3,{id:"message-handlers",children:"Message handlers"}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    # Triggered when user sends "hi"\n-    @app.message(re.compile(r"hi", re.IGNORECASE))\n-    async def greeting(context: TurnContext, _state: AppTurnState) -> bool:\n-        await context.send_activity("Hi there!")\n-        return True\n-\n-    # Listens for ANY message received\n-    @app.activity("message")\n-    async def on_message(context: TurnContext, _state: TurnState):\n-        # Echoes back what user said\n-        await context.send_activity(f"you said: {context.activity.text}")\n-        return True\n# highlight-error-end\n# highlight-success-start\n+    # Triggered when user sends "hi", "hello", or "greetings"\n+    @app.on_message_pattern(re.compile(r"hello|hi|greetings"))\n+    async def handle_greeting(ctx: ActivityContext[MessageActivity]) -> None:\n+        await ctx.reply("Hello! How can I assist you today?")\n+\n+    # Listens for ANY message received\n+    @app.on_message\n+    async def handle_message(ctx: ActivityContext[MessageActivity]):\n+        # Sends a typing indicator\n+        await ctx.reply(TypingActivityInput())\n+        await ctx.send(f"You said \'{ctx.activity.text}\'")\n# highlight-success-end\n'})})}),(0,i.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Triggered when user sends "hi", "hello", or "greetings"\n@app.on_message_pattern(re.compile(r"hello|hi|greetings"))\nasync def handle_greeting(ctx: ActivityContext[MessageActivity]) -> None:\n    await ctx.reply("Hello! How can I assist you today?")\n\n# Listens for ANY message received\n@app.on_message\nasync def handle_message(ctx: ActivityContext[MessageActivity]):\n    # Sends a typing indicator\n    await ctx.reply(TypingActivityInput())\n    await ctx.send(f"You said \'{ctx.activity.text}\'")\n'})})}),(0,i.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Triggered when user sends "hi"\n@app.message(re.compile(r"hi", re.IGNORECASE))\nasync def greeting(context: TurnContext, _state: AppTurnState) -> bool:\n    await context.send_activity("Hi there!")\n    return True\n\n# Listens for ANY message received\n@app.activity("message")\nasync def on_message(context: TurnContext, _state: TurnState):\n    # Echoes back what user said\n    await context.send_activity(f"you said: {context.activity.text}")\n    return True\n'})})})]})}),"\n",(0,i.jsx)(n.h3,{id:"task-modules",children:"Task modules"}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsx)(n.p,{children:"Note that on Microsoft Teams, task modules have been renamed to dialogs."})}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    @app.task_module.fetch("connect-account")\n-    async def on_connect_account(context: TurnContext, _state: TurnState):\n-        return TaskModuleTaskInfo(\n-            title="Connect your Microsoft 365 account",\n-            height="medium",\n-            width="medium",\n-            url=f"https://{config.NEXT_PUBLIC_BOT_DOMAIN}/connections",\n-            fallbackUrl=f"https://{config.NEXT_PUBLIC_BOT_DOMAIN}/connections",\n-            completionBotId=config.NEXT_PUBLIC_BOT_ID,\n-        )\n-\n-    @app.task_modules.submit("connect-account")\n-    async def on_submit_connect_account(context: TurnContext, _state: TurnState, data: Dict[str, Any]):\n-        print(json.dumps(data))\n-        await context.send_activity("You are all set! Now, how can I help you today?")\n-        return None\n# highlight-error-end\n# highlight-success-start\n+    @app.on_dialog_open\n+    async def handle_dialog_open(ctx: ActivityContext[TaskFetchInvokeActivity]):\n+        data: Optional[Any] = ctx.activity.value.data\n+        dialog_type = data.get("opendialogtype") if data else None\n+\n+        if dialog_type == "some_type":\n+             return InvokeResponse(\n+                body=TaskModuleResponse(\n+                    task=TaskModuleContinueResponse(\n+                        value=UrlTaskModuleTaskInfo(\n+                            title="Dialog title",\n+                            height="medium",\n+                            width="medium",\n+                            url= f"https://${os.getenv("YOUR_WEBSITE_DOMAIN")}/some-path",\n+                            fallback_url= f"https://${os.getenv("YOUR_WEBSITE_DOMAIN")}/fallback-path-for-web",\n+                            completion_bot_id= os.getenv("ENTRA_APP_CLIENT_ID"),\n+                        )\n+                    )\n+                )\n+            )\n+\n+    @app.on_dialog_submit\n+    async def handle_dialog_submit(ctx: ActivityContext[TaskSubmitInvokeActivity]):\n+        data: Optional[Any] = ctx.activity.value.data\n+        dialog_type = data.get("submissiondialogtype") if data else None\n+\n+        if dialog_type == "some_type":\n+            await ctx.send(json.dumps(ctx.activity.value))\n+\n+        return TaskModuleResponse(task=TaskModuleMessageResponse(value="Received submit"))\n# highlight-success-end\n'})})}),(0,i.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@app.on_dialog_open\nasync def handle_dialog_open(ctx: ActivityContext[TaskFetchInvokeActivity]):\n    data: Optional[Any] = ctx.activity.value.data\n    dialog_type = data.get("opendialogtype") if data else None\n\n    if dialog_type == "some_type":\n         return InvokeResponse(\n            body=TaskModuleResponse(\n                task=TaskModuleContinueResponse(\n                    value=UrlTaskModuleTaskInfo(\n                        title="Dialog title",\n                        height="medium",\n                        width="medium",\n                        url= f"https://${os.getenv("YOUR_WEBSITE_DOMAIN")}/some-path",\n                        fallback_url= f"https://${os.getenv("YOUR_WEBSITE_DOMAIN")}/fallback-path-for-web",\n                        completion_bot_id= os.getenv("ENTRA_APP_CLIENT_ID"),\n                    )\n                )\n            )\n        )\n\n@app.on_dialog_submit\nasync def handle_dialog_submit(ctx: ActivityContext[TaskSubmitInvokeActivity]):\n    data: Optional[Any] = ctx.activity.value.data\n    dialog_type = data.get("submissiondialogtype") if data else None\n\n    if dialog_type == "some_type":\n        await ctx.send(json.dumps(ctx.activity.value))\n\n    return TaskModuleResponse(task=TaskModuleMessageResponse(value="Received submit"))\n'})})}),(0,i.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@app.task_module.fetch("connect-account")\nasync def on_connect_account(context: TurnContext, _state: TurnState):\n    return TaskModuleTaskInfo(\n        title="Connect your Microsoft 365 account",\n        height="medium",\n        width="medium",\n        url=f"https://{config.NEXT_PUBLIC_BOT_DOMAIN}/connections",\n        fallbackUrl=f"https://{config.NEXT_PUBLIC_BOT_DOMAIN}/connections",\n        completionBotId=config.NEXT_PUBLIC_BOT_ID,\n    )\n\n@app.task_modules.submit("connect-account")\nasync def on_submit_connect_account(context: TurnContext, _state: TurnState, data: Dict[str, Any]):\n    print(json.dumps(data))\n    await context.send_activity("You are all set! Now, how can I help you today?")\n    return None\n'})})})]})}),"\n",(0,i.jsxs)(n.p,{children:["Learn more in the ",(0,i.jsx)(n.a,{href:"../in-depth-guides/dialogs",children:"Dialogs guide"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"adaptive-cards",children:"Adaptive cards"}),"\n",(0,i.jsx)(n.p,{children:"In Teams SDK v2, cards have much more rich type validation than existed in v1. However, assuming your cards were valid, it should be easy to migrate to v2."}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    @app.message("/card")\n-    async def adaptive_card(context: TurnContext, _state: AppTurnState) -> bool:\n-        attachment = CardFactory.adaptive_card(\n-             {\n-                "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n-                "version": "1.6",\n-                "type": "AdaptiveCard",\n-                "body": [\n-                    {\n-                        "text": "Hello, world!",\n-                        "wrap": True,\n-                        "type": "TextBlock",\n-                    },\n-                ],\n-                "msteams": {\n-                    "width": "Full"\n-                }\n-            }\n-        )\n-        await context.send_activity(Activity(attachments=[attachment]))\n-        return True\n# highlight-error-end\n# highlight-success-start\n+    @app.on_message_pattern("/card")\n+    async def handle_card_message(ctx: ActivityContext[MessageActivity]):\n+        print(f"[CARD] Card requested by: {ctx.activity.from_}")\n+        card = AdaptiveCard.model_validate(\n+            {\n+                "schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n+                "version": "1.6",\n+                "type": "AdaptiveCard",\n+                "body": [\n+                    {\n+                        "text": "Hello, world!",\n+                        "wrap": True,\n+                        "type": "TextBlock",\n+                    },\n+                ],\n+                "msteams": {\n+                    "width": "Full"\n+                }\n+            }\n+        )\n+        await ctx.send(card)\n# highlight-success-end\n'})})}),(0,i.jsxs)(c.A,{value:"v2-option1",label:"Teams SDK v2 (Option 1)",children:[(0,i.jsx)(n.p,{children:"For existing cards like this, the simplest way to convert that to Teams SDK is this:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@app.on_message_pattern("/card")\nasync def handle_card_message(ctx: ActivityContext[MessageActivity]):\n    print(f"[CARD] Card requested by: {ctx.activity.from_}")\n    card = AdaptiveCard.model_validate(\n        {\n            "schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n            "version": "1.6",\n            "type": "AdaptiveCard",\n            "body": [\n                {\n                    "text": "Hello, world!",\n                    "wrap": True,\n                    "type": "TextBlock",\n                },\n            ],\n            "msteams": {\n                "width": "Full"\n            }\n        }\n    )\n    await ctx.send(card)\n'})})]}),(0,i.jsxs)(c.A,{value:"v2-option2",label:"Teams SDK v2 (Option 2)",children:[(0,i.jsx)(n.p,{children:"For a more thorough port, you could also do the following:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@app.on_message_pattern("/card")\nasync def handle_card_message(ctx: ActivityContext[MessageActivity]):\n    card = AdaptiveCard(\n        schema="http://adaptivecards.io/schemas/adaptive-card.json",\n        body=[\n            TextBlock(text="Hello, world", wrap=True, weight="Bolder"),\n        ],\n        ms_teams=TeamsCardProperties(width=\'full\'),\n    )\n    await ctx.send(card)\n'})})]}),(0,i.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'@app.message("/card")\nasync def adaptive_card(context: TurnContext, _state: AppTurnState) -> bool:\n    attachment = CardFactory.adaptive_card(\n         {\n            "$schema": "http://adaptivecards.io/schemas/adaptive-card.json",\n            "version": "1.6",\n            "type": "AdaptiveCard",\n            "body": [\n                {\n                    "text": "Hello, world!",\n                    "wrap": True,\n                    "type": "TextBlock",\n                },\n            ],\n            "msteams": {\n                "width": "Full"\n            }\n        }\n    )\n    await context.send_activity(Activity(attachments=[attachment]))\n    return True\n'})})})]})}),"\n",(0,i.jsxs)(n.p,{children:["Learn more in the ",(0,i.jsx)(n.a,{href:"../in-depth-guides/adaptive-cards",children:"Adaptive Cards guide"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsx)(n.p,{children:"Most agents feature authentication for user identification, interacting with APIs, etc. Whether your Teams SDK app used Entra SSO or custom OAuth, porting to v2 should be simple."}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    app = Application[TurnState[ConversationState, UserState, TempState]](\n-        ApplicationOptions(\n-            bot_app_id=config.APP_ID,\n-            storage=MemoryStorage(),\n-            adapter=TeamsAdapter(config),\n-            auth=AuthOptions(\n-                default="graph",\n-                auto=True,\n-                settings={\n-                    "graph": OAuthOptions(\n-                        connection_name=config.OAUTH_CONNECTION_NAME,\n-                        title="Sign In",\n-                        text="please sign in",\n-                        end_on_invalid_message=True,\n-                        enable_sso=True,\n-                    ),\n-                },\n-            ),\n-        )\n-    )\n-\n-    auth = app.auth.get("graph")\n-\n-    @app.message("/signout")\n-    async def on_sign_out(\n-        context: TurnContext, state: TurnState[ConversationState, UserState, TempState]\n-    ):\n-        await auth.sign_out(context, state)\n-        await context.send_activity("you are now signed out...\ud83d\udc4b")\n-        return False\n-\n-    @auth.on_sign_in_success\n-    async def on_sign_in_success(\n-        context: TurnContext, state: TurnState[ConversationState, UserState, TempState]\n-    ):\n-        await context.send_activity("successfully logged in!")\n-        await context.send_activity(f"token: {state.temp.auth_tokens[\'graph\']}")\n-\n-    @auth.on_sign_in_failure\n-    async def on_sign_in_failure(\n-        context: TurnContext,\n-        _state: TurnState[ConversationState, UserState, TempState],\n-        _res: SignInResponse,\n-    ):\n-        await context.send_activity("failed to login...")\n# highlight-error-end\n# highlight-success-start\n+    app = App()\n+\n+    @app.on_message\n+    async def handle_message(ctx: ActivityContext[MessageActivity]):\n+        ctx.logger.info("User requested sign-in.")\n+        if ctx.is_signed_in:\n+            await ctx.send("You are already signed in.")\n+        else:\n+            await ctx.sign_in()\n+\n+    @app.on_message_pattern("/signout")\n+    async def handle_sign_out(ctx: ActivityContext[MessageActivity]):\n+        await ctx.sign_out()\n+        await ctx.send("You have been signed out.")\n+\n+    @app.event("sign_in")\n+    async def handle_sign_in(event: SignInEvent):\n+        """Handle sign-in events."""\n+        await event.activity_ctx.send("You are now signed in!")\n+\n+    @app.event("error")\n+    async def handle_error(event: ErrorEvent):\n+        """Handle error events."""\n+        print(f"Error occurred: {event.error}")\n+        if event.context:\n+            print(f"Context: {event.context}")\n# highlight-success-end\n'})})}),(0,i.jsx)(c.A,{value:"v2",label:"Teams SDK v2",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'app = App()\n\n@app.on_message\nasync def handle_message(ctx: ActivityContext[MessageActivity]):\n    ctx.logger.info("User requested sign-in.")\n    if ctx.is_signed_in:\n        await ctx.send("You are already signed in.")\n    else:\n        await ctx.sign_in()\n\n@app.on_message_pattern("/signout")\nasync def handle_sign_out(ctx: ActivityContext[MessageActivity]):\n    await ctx.sign_out()\n    await ctx.send("You have been signed out.")\n\n@app.event("sign_in")\nasync def handle_sign_in(event: SignInEvent):\n    """Handle sign-in events."""\n    await event.activity_ctx.send("You are now signed in!")\n\n@app.event("error")\nasync def handle_error(event: ErrorEvent):\n    """Handle error events."""\n    print(f"Error occurred: {event.error}")\n    if event.context:\n        print(f"Context: {event.context}")\n'})})}),(0,i.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'app = Application[TurnState[ConversationState, UserState, TempState]](\n    ApplicationOptions(\n        bot_app_id=config.APP_ID,\n        storage=MemoryStorage(),\n        adapter=TeamsAdapter(config),\n        auth=AuthOptions(\n            default="graph",\n            auto=True,\n            settings={\n                "graph": OAuthOptions(\n                    connection_name=config.OAUTH_CONNECTION_NAME,\n                    title="Sign In",\n                    text="please sign in",\n                    end_on_invalid_message=True,\n                    enable_sso=True,\n                ),\n            },\n        ),\n    )\n)\n\nauth = app.auth.get("graph")\n\n@app.message("/signout")\nasync def on_sign_out(\n    context: TurnContext, state: TurnState[ConversationState, UserState, TempState]\n):\n    await auth.sign_out(context, state)\n    await context.send_activity("you are now signed out...\ud83d\udc4b")\n    return False\n\n@auth.on_sign_in_success\nasync def on_sign_in_success(\n    context: TurnContext, state: TurnState[ConversationState, UserState, TempState]\n):\n    await context.send_activity("successfully logged in!")\n    await context.send_activity(f"token: {state.temp.auth_tokens[\'graph\']}")\n\n@auth.on_sign_in_failure\nasync def on_sign_in_failure(\n    context: TurnContext,\n    _state: TurnState[ConversationState, UserState, TempState],\n    _res: SignInResponse,\n):\n    await context.send_activity("failed to login...")\n'})})})]})}),"\n",(0,i.jsx)(n.h2,{id:"ai",children:"AI"}),"\n",(0,i.jsxs)(o.A,{language:"python",children:[(0,i.jsx)(n.h3,{id:"action-planner",children:"Action planner"}),(0,i.jsxs)(n.p,{children:["When we created Teams SDK, LLM's didn't natively support tool calling or orchestration. A lot has changed since then, which is why we decided to deprecate ",(0,i.jsx)(n.code,{children:"ActionPlanner"})," from Teams SDK, and replace it with something a bit more lightweight. Notably, Teams SDK had two similar concepts: functions and actions. In Teams SDK, these are consolidated into functions."]}),(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    # Create AI components\n-    model = OpenAIModel(\n-        OpenAIModelOptions(api_key=config.OPENAI_KEY, default_model="gpt-4o")\n-    )\n-\n-    prompts = PromptManager(\n-        PromptManagerOptions(prompts_folder=f"{os.path.dirname(__file__)}/prompts")\n-    )\n-\n-    # Define a prompt function for getting the current status of the lights\n-    @prompts.function("get_light_status")\n-    async def on_get_light_status(context, state, functions, tokenizer, args):\n-        return "on" if state.get("conversation.lightsOn") else "off"\n-\n-    planner = ActionPlanner(\n-        ActionPlannerOptions(model=model, prompts=prompts, default_prompt="tools")\n-    )\n-\n-    # Define storage and application\n-    storage = MemoryStorage()\n-    app = Application[AppTurnState](\n-        ApplicationOptions(\n-            bot_app_id=config.APP_ID,\n-            storage=storage,\n-            adapter=TeamsAdapter(config),\n-            ai=AIOptions(planner=planner),\n-        )\n-    )\n-\n-    # Register action handlers\n-    @app.ai.action("LightsOn")\n-    async def on_lights_on(context: ActionTurnContext, state: AppTurnState):\n-        state.conversation.lights_on = True\n-        return "the lights are now on"\n-\n-    @app.ai.action("LightsOff")\n-    async def on_lights_off(context: ActionTurnContext, state: AppTurnState):\n-        state.conversation.lights_on = False\n-        return "the lights are now off"\n-\n-    @app.ai.action("Pause")\n-    async def on_pause(context: ActionTurnContext, state: AppTurnState):\n-        time_ms = int(context.data["time"]) if context.data["time"] else 1000\n-        time.sleep(time_ms / 1000)\n-        return "done pausing"\n# highlight-error-end\n# highlight-success-start\n+    import asyncio\n+    from microsoft_teams.ai import ChatPrompt\n+    from microsoft_teams.api import MessageActivity\n+    from microsoft_teams.apps import ActivityContext, App\n+    from microsoft_teams.common import LocalStorage\n+    from microsoft_teams.openai import OpenAICompletionsAIModel\n+\n+    storage = LocalStorage()\n+    app = App()\n+\n+    @app.on_message\n+    async def handle_message(ctx: ActivityContext[MessageActivity]):\n+        state = storage.get(ctx.activity.from_.id) or {"lights_on": False}\n+\n+        prompt = ChatPrompt(\n+            instructions="You are a helpful assistant that can control lights.",\n+            model=OpenAICompletionsAIModel(model="gpt-4o"),\n+        )\n+\n+        # Define functions inline\n+        prompt.function(\n+            "get_light_status",\n+            "Gets the current status of the lights",\n+            lambda: "on" if state["lights_on"] else "off"\n+        )\n+\n+        prompt.function(\n+            "lights_on",\n+            "Turns the lights on",\n+            lambda: (state.update({"lights_on": True}), "the lights are now on")[1]\n+        )\n+\n+        prompt.function(\n+            "lights_off",\n+            "Turns the lights off",\n+            lambda: (state.update({"lights_on": False}), "the lights are now off")[1]\n+        )\n+\n+        async def pause(time: int):\n+            await asyncio.sleep(time / 1000)\n+            return "done pausing"\n+\n+        prompt.function(\n+            "pause",\n+            "Delays for a period of time",\n+            {\n+                "type": "object",\n+                "properties": {\n+                    "time": {\n+                        "type": "number",\n+                        "description": "The amount of time to delay in milliseconds"\n+                    }\n+                },\n+                "required": ["time"]\n+            },\n+            pause\n+        )\n+\n+        result = await prompt.send(ctx.activity.text)\n+        storage.set(ctx.activity.from_.id, state)\n+\n+        if result.response.content:\n+            await ctx.send(result.response.content)\n# highlight-success-end\n'})})}),(0,i.jsxs)(c.A,{value:"v2",label:"Teams SDK v2",children:[(0,i.jsxs)(n.p,{children:["In Teams SDK, there is no ",(0,i.jsx)(n.code,{children:"actions.json"})," file. Instead, function prompts, parameters, etc. are declared in your code."]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'import asyncio\nfrom microsoft_teams.ai import ChatPrompt\nfrom microsoft_teams.api import MessageActivity\nfrom microsoft_teams.apps import ActivityContext, App\nfrom microsoft_teams.common import LocalStorage\nfrom microsoft_teams.openai import OpenAICompletionsAIModel\n\nstorage = LocalStorage()\napp = App()\n\n@app.on_message\nasync def handle_message(ctx: ActivityContext[MessageActivity]):\n    state = storage.get(ctx.activity.from_.id) or {"lights_on": False}\n\n    prompt = ChatPrompt(\n        instructions="You are a helpful assistant that can control lights.",\n        model=OpenAICompletionsAIModel(model="gpt-4o"),\n    )\n\n    # Define functions inline - no separate actions.json needed\n    prompt.function(\n        "get_light_status",\n        "Gets the current status of the lights",\n        lambda: "on" if state["lights_on"] else "off"\n    )\n\n    prompt.function(\n        "lights_on",\n        "Turns the lights on",\n        lambda: (state.update({"lights_on": True}), "the lights are now on")[1]\n    )\n\n    prompt.function(\n        "lights_off",\n        "Turns the lights off",\n        lambda: (state.update({"lights_on": False}), "the lights are now off")[1]\n    )\n\n    async def pause(time: int):\n        await asyncio.sleep(time / 1000)\n        return "done pausing"\n\n    prompt.function(\n        "pause",\n        "Delays for a period of time",\n        {\n            "type": "object",\n            "properties": {\n                "time": {\n                    "type": "number",\n                    "description": "The amount of time to delay in milliseconds"\n                }\n            },\n            "required": ["time"]\n        },\n        pause\n    )\n\n    result = await prompt.send(ctx.activity.text)\n    storage.set(ctx.activity.from_.id, state)\n\n    if result.response.content:\n        await ctx.send(result.response.content)\n'})})]}),(0,i.jsxs)(c.A,{value:"v1",label:"Teams SDK v1",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Create AI components\nmodel = OpenAIModel(\n    OpenAIModelOptions(api_key=config.OPENAI_KEY, default_model="gpt-4o")\n)\n\nprompts = PromptManager(\n    PromptManagerOptions(prompts_folder=f"{os.path.dirname(__file__)}/prompts")\n)\n\n# Define a prompt function for getting the current status of the lights\n@prompts.function("get_light_status")\nasync def on_get_light_status(context, state, functions, tokenizer, args):\n    return "on" if state.get("conversation.lightsOn") else "off"\n\nplanner = ActionPlanner(\n    ActionPlannerOptions(model=model, prompts=prompts, default_prompt="tools")\n)\n\n# Define storage and application\nstorage = MemoryStorage()\napp = Application[AppTurnState](\n    ApplicationOptions(\n        bot_app_id=config.APP_ID,\n        storage=storage,\n        adapter=TeamsAdapter(config),\n        ai=AIOptions(planner=planner),\n    )\n)\n\n# Register action handlers\n@app.ai.action("LightsOn")\nasync def on_lights_on(context: ActionTurnContext, state: AppTurnState):\n    state.conversation.lights_on = True\n    return "the lights are now on"\n\n@app.ai.action("LightsOff")\nasync def on_lights_off(context: ActionTurnContext, state: AppTurnState):\n    state.conversation.lights_on = False\n    return "the lights are now off"\n\n@app.ai.action("Pause")\nasync def on_pause(context: ActionTurnContext, state: AppTurnState):\n    time_ms = int(context.data["time"]) if context.data["time"] else 1000\n    time.sleep(time_ms / 1000)\n    return "done pausing"\n\n@app.ai.action("LightStatus")\nasync def on_lights_status(context: ActionTurnContext, state: AppTurnState):\n    return "the lights are on" if state.conversation.lights_on else "the lights are off"\n'})}),(0,i.jsxs)(n.p,{children:["And the corresponding ",(0,i.jsx)(n.code,{children:"actions.json"})," file:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'[\n    {\n        "name": "LightsOn",\n        "description": "Turns on the lights"\n    },\n    {\n        "name": "LightsOff",\n        "description": "Turns off the lights"\n    },\n    {\n        "name": "Pause",\n        "description": "Delays for a period of time",\n        "parameters": {\n            "type": "object",\n            "properties": {\n                "time": {\n                    "type": "number",\n                    "description": "The amount of time to delay in milliseconds"\n                }\n            },\n            "required": ["time"]\n        }\n    },\n    {\n        "name": "LightStatus",\n        "description": "Gets the lights status"\n    }\n]\n'})})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"feedback",children:"Feedback"}),"\n",(0,i.jsx)(n.p,{children:"If you supported feedback for AI generated messages, migrating is simple."}),"\n",(0,i.jsx)(o.A,{language:"python",children:(0,i.jsxs)(r.A,{children:[(0,i.jsx)(c.A,{value:"Diff",default:!0,children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# highlight-error-start\n-    app = Application[AppTurnState](\n-        ApplicationOptions(\n-            # ... other options\n-            ai=AIOptions(\n-                enable_feedback_loop=enableFeedbackLoop\n-            ),\n-        )\n-    )\n-\n-    @app.message()\n-    async def on_message(context: TurnContext, state: AppTurnState):\n-        await context.send_activity(Activity(text="Hey, give me feedback!", channel_data={"feedbackLoop": { "type": "custom"}}))\n-\n-    @app.feedback_loop()\n-    async def feedback_loop(context: TurnContext, state: AppTurnState, feedback_data: FeedbackLoopData):\n-        print("Feedback loop triggered")\n# highlight-error-end\n# highlight-success-start\n+    # Reply with message including feedback buttons\n+    @app.on_message\n+    async def handle_feedback(ctx: ActivityContext[MessageActivity]):\n+        await ctx.send(MessageActivityInput(text="Hey, give me feedback!").add_ai_generated().add_feedback())\n+\n+    @app.on_message_submit_feedback\n+    async def handle_message_feedback(ctx: ActivityContext[MessageSubmitActionInvokeActivity]):\n+        # Custom logic here..\n# highlight-success-end\n'})})}),(0,i.jsxs)(c.A,{value:"v2",label:"Teams SDK v2",children:[(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Reply with message including feedback buttons\n@app.on_message\nasync def handle_feedback(ctx: ActivityContext[MessageActivity]):\n    await ctx.send(MessageActivityInput(text="Hey, give me feedback!").add_ai_generated().add_feedback())\n\n@app.on_message_submit_feedback\nasync def handle_message_feedback(ctx: ActivityContext[MessageSubmitActionInvokeActivity]):\n    # Custom logic here..\n'})}),(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.em,{children:"Note:"})," In Teams SDK, you do not need to opt into feedback at the ",(0,i.jsx)(n.code,{children:"App"})," level."]})]}),(0,i.jsx)(c.A,{value:"v1",label:"Teams SDK v1",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'app = Application[AppTurnState](\n    ApplicationOptions(\n        # ... other options\n        ai=AIOptions(\n            enable_feedback_loop=enableFeedbackLoop\n        ),\n    )\n)\n\n@app.message()\nasync def on_message(context: TurnContext, state: AppTurnState):\n    await context.send_activity(Activity(text="Hey, give me feedback!", channel_data={"feedbackLoop": { "type": "custom"}}))\n\n@app.feedback_loop()\nasync def feedback_loop(context: TurnContext, state: AppTurnState, feedback_data: FeedbackLoopData):\n    print("Feedback loop triggered")\n'})})})]})}),"\n",(0,i.jsxs)(n.p,{children:["You can learn more about feedback in Teams SDK in the ",(0,i.jsx)(n.a,{href:"../in-depth-guides/feedback",children:"Feedback guide"}),"."]}),"\n",(0,i.jsxs)(o.A,{language:"python",children:[(0,i.jsx)(n.h2,{id:"incrementally-migrating-code-via-botbuilder-plugin",children:"Incrementally migrating code via botbuilder plugin"}),(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Comparison code coming soon!"})}),(0,i.jsxs)(n.p,{children:["If you aren't ready to migrate all of your code, you can run your existing Teams SDK code in parallel with Teams SDK. Learn more ",(0,i.jsx)(n.a,{href:"./botbuilder/integration",children:"here"}),"."]})]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(g,{...e})}):g(e)}}}]);