"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[7326],{26802:(e,t,n)=>{n.d(t,{A:()=>s});var i=n(22147),a=n(62540);function s({language:e,children:t}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,a.jsx)(a.Fragment,{children:t}):null}},39037:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"python/in-depth-guides/adaptive-cards/executing-actions","title":"Executing Actions","description":"\x3c!--","source":"@site/docs/main/python/in-depth-guides/adaptive-cards/executing-actions.mdx","sourceDirName":"python/in-depth-guides/adaptive-cards","slug":"/python/in-depth-guides/adaptive-cards/executing-actions","permalink":"/teams-sdk/python/in-depth-guides/adaptive-cards/executing-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/python/in-depth-guides/adaptive-cards/executing-actions.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Executing Actions","title":"Executing Actions","summary":"How to implement interactive elements in Adaptive Cards through actions like buttons, links, and input submission triggers."},"sidebar":"default","previous":{"title":"Building Adaptive Cards","permalink":"/teams-sdk/python/in-depth-guides/adaptive-cards/building-adaptive-cards"},"next":{"title":"Dialogs","permalink":"/teams-sdk/python/in-depth-guides/dialogs/"}}');var a=n(62540),s=n(43023),r=n(26802);const o={sidebar_position:2,sidebar_label:"Executing Actions",title:"Executing Actions",summary:"How to implement interactive elements in Adaptive Cards through actions like buttons, links, and input submission triggers."},c="Executing Actions",d={},l=[{value:"Action Types",id:"action-types",level:2},{value:"Creating Actions with the SDK",id:"creating-actions-with-the-sdk",level:2},{value:"Single Actions",id:"single-actions",level:3},{value:"Action Sets",id:"action-sets",level:3},{value:"Raw JSON Alternative",id:"raw-json-alternative",level:3},{value:"Working with Input Values",id:"working-with-input-values",level:2},{value:"Associating data with the cards",id:"associating-data-with-the-cards",level:3},{value:"Input Validation",id:"input-validation",level:3},{value:"Server Handlers",id:"server-handlers",level:2},{value:"Basic Structure",id:"basic-structure",level:3}];function h(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"executing-actions",children:"Executing Actions"})}),"\n",(0,a.jsxs)(t.p,{children:["Adaptive Cards support interactive elements through ",(0,a.jsx)(t.strong,{children:"actions"}),"\u2014buttons, links, and input submission triggers that respond to user interaction.\nYou can use these to collect form input, trigger workflows, show task modules, open URLs, and more."]}),"\n",(0,a.jsx)(t.h2,{id:"action-types",children:"Action Types"}),"\n",(0,a.jsx)(t.p,{children:"The Teams SDK supports several action types for different interaction patterns:"}),"\n",(0,a.jsxs)(t.table,{children:[(0,a.jsx)(t.thead,{children:(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.th,{children:"Action Type"}),(0,a.jsx)(t.th,{children:"Purpose"}),(0,a.jsx)(t.th,{children:"Description"})]})}),(0,a.jsxs)(t.tbody,{children:[(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"Action.Execute"})}),(0,a.jsx)(t.td,{children:"Server\u2011side processing"}),(0,a.jsx)(t.td,{children:"Send data to your bot for processing. Best for forms & multi\u2011step workflows."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"Action.Submit"})}),(0,a.jsx)(t.td,{children:"Simple data submission"}),(0,a.jsxs)(t.td,{children:["Legacy action type. Prefer ",(0,a.jsx)(t.code,{children:"Execute"})," for new projects."]})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"Action.OpenUrl"})}),(0,a.jsx)(t.td,{children:"External navigation"}),(0,a.jsx)(t.td,{children:"Open a URL in the user's browser."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"Action.ShowCard"})}),(0,a.jsx)(t.td,{children:"Progressive disclosure"}),(0,a.jsx)(t.td,{children:"Display a nested card when clicked."})]}),(0,a.jsxs)(t.tr,{children:[(0,a.jsx)(t.td,{children:(0,a.jsx)(t.code,{children:"Action.ToggleVisibility"})}),(0,a.jsx)(t.td,{children:"UI state management"}),(0,a.jsx)(t.td,{children:"Show/hide card elements dynamically."})]})]})]}),"\n",(0,a.jsx)(t.admonition,{type:"info",children:(0,a.jsxs)(t.p,{children:["For complete reference, see the ",(0,a.jsx)(t.a,{href:"https://adaptivecards.microsoft.com/?topic=Action.Execute",children:"official documentation"}),"."]})}),"\n",(0,a.jsx)(t.h2,{id:"creating-actions-with-the-sdk",children:"Creating Actions with the SDK"}),"\n",(0,a.jsx)(t.h3,{id:"single-actions",children:"Single Actions"}),"\n",(0,a.jsx)(t.p,{children:"The SDK provides builder helpers that abstract the underlying JSON. For example:"}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from microsoft_teams.cards.core import ExecuteAction\n# ...\n\naction = ExecuteAction(title="Submit Feedback")\n                    .with_data({"action": "submit_feedback"})\n                    .with_associated_inputs("auto")\n'})})}),"\n",(0,a.jsx)(t.h3,{id:"action-sets",children:"Action Sets"}),"\n",(0,a.jsxs)(t.p,{children:["Group actions together using ",(0,a.jsx)(t.code,{children:"ActionSet"}),":"]}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from microsoft_teams.cards.core import ActionSet, ExecuteAction, OpenUrlAction\n# ...\n\naction_set = ActionSet(\n                actions=[\n                    ExecuteAction(title="Submit Feedback")\n                    .with_data({"action": "submit_feedback"}),\n                    OpenUrlAction(url="https://adaptivecards.microsoft.com").with_title("Learn More")\n                ]\n            ),\n'})})}),"\n",(0,a.jsx)(t.h3,{id:"raw-json-alternative",children:"Raw JSON Alternative"}),"\n",(0,a.jsxs)(t.p,{children:["Just like when building cards, if you prefer to work with raw JSON, you can do just that. ",(0,a.jsx)(r.A,{language:"python",children:"You get type safety for free in Python."})]}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'json = {\n  "type": "Action.OpenUrl",\n  "url": "https://adaptivecards.microsoft.com",\n  "title": "Learn More",\n}\n'})})}),"\n",(0,a.jsx)(t.h2,{id:"working-with-input-values",children:"Working with Input Values"}),"\n",(0,a.jsx)(t.h3,{id:"associating-data-with-the-cards",children:"Associating data with the cards"}),"\n",(0,a.jsxs)(t.p,{children:["Sometimes you want to send a card and have it be associated with some data. Set the ",(0,a.jsx)(t.code,{children:"data"})," value to be sent back to the client so you can associate it with a particular entity."]}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from microsoft_teams.cards import AdaptiveCard, ActionSet, ExecuteAction, OpenUrlAction\nfrom microsoft_teams.cards.core import TextInput, ToggleInput\n# ...\n\nprofile_card = AdaptiveCard(\n        schema="http://adaptivecards.io/schemas/adaptive-card.json",\n        body=[\n            TextInput(id="name").with_label("Name").with_value("John Doe"),\n            TextInput(id="email", label="Email", value="john@contoso.com"),\n            ToggleInput(title="Subscribe to newsletter").with_id("subscribe").with_value("false"),\n            ActionSet(\n                actions=[\n                    ExecuteAction(title="Save")\n                    # entity_id will come back after the user submits\n                    .with_data({"action": "save_profile", "entity_id": "12345"}),\n                ]\n            ),\n        ],\n    )\n\n# Data received in handler:\n"""\n{\n  "action": "save_profile",\n  "entity_id": "12345",     # From action data\n  "name": "John Doe",       # From name input\n  "email": "john@doe.com",  # From email input\n  "subscribe": "true"       # From toggle input (as string)\n}\n"""\n'})})}),"\n",(0,a.jsx)(t.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,a.jsxs)(t.p,{children:["Input Controls provide ways for you to validate. More details can be found on the Adaptive Cards ",(0,a.jsx)(t.a,{href:"https://adaptivecards.microsoft.com/?topic=input-validation",children:"documentation"}),"."]}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from microsoft_teams.cards import AdaptiveCard, ActionSet, ExecuteAction, NumberInput, TextInput\n# ...\n\ndef create_profile_card_input_validation():\n    age_input = NumberInput(id="age").with_label("age").with_is_required(True).with_min(0).with_max(120)\n    # Can configure custom error messages\n    name_input = TextInput(id="name").with_label("Name").with_is_required(True).with_error_message("Name is required")\n\n    card = AdaptiveCard(\n        schema="http://adaptivecards.io/schemas/adaptive-card.json",\n        body=[\n            age_input,\n            name_input,\n            TextInput(id="location").with_label("Location"),\n            ActionSet(\n                actions=[\n                    ExecuteAction(title="Save")\n                    # All inputs should be validated\n                    .with_data({"action": "save_profile"})\n                    .with_associated_inputs("auto")\n                ]\n            ),\n        ],\n    )\n    return card\n'})})}),"\n",(0,a.jsx)(t.h2,{id:"server-handlers",children:"Server Handlers"}),"\n",(0,a.jsx)(t.h3,{id:"basic-structure",children:"Basic Structure"}),"\n",(0,a.jsxs)(t.p,{children:["Card actions arrive as ",(0,a.jsx)(t.code,{children:"card.action"})," activities in your app. These give you access to the validated input values plus any ",(0,a.jsx)(t.code,{children:"data"})," values you had configured to be sent back to you."]}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from microsoft_teams.api import AdaptiveCardInvokeActivity, AdaptiveCardActionErrorResponse, AdaptiveCardActionMessageResponse, HttpError, InnerHttpError, AdaptiveCardInvokeResponse\nfrom microsoft_teams.apps import ActivityContext\n# ...\n\n@app.on_card_action\nasync def handle_card_action(ctx: ActivityContext[AdaptiveCardInvokeActivity]) -> AdaptiveCardInvokeResponse:\n    data = ctx.activity.value.action.data\n    if not data.get("action"):\n        return AdaptiveCardActionErrorResponse(\n            status_code=400,\n            type="application/vnd.microsoft.error",\n            value=HttpError(\n                code="BadRequest",\n                message="No action specified",\n                inner_http_error=InnerHttpError(\n                    status_code=400,\n                    body={"error": "No action specified"},\n                ),\n            ),\n        )\n\n    print("Received action data:", data)\n\n    if data["action"] == "submit_feedback":\n        await ctx.send(f"Feedback received: {data.get(\'feedback\')}")\n    elif data["action"] == "purchase_item":\n        await ctx.send(f"Purchase request received for game: {data.get(\'choiceGameSingle\')}")\n    elif data["action"] == "save_profile":\n        await ctx.send(\n            f"Profile saved!\\nName: {data.get(\'name\')}\\nEmail: {data.get(\'email\')}\\nSubscribed: {data.get(\'subscribe\')}"\n        )\n    else:\n        return AdaptiveCardActionErrorResponse(\n            status_code=400,\n            type="application/vnd.microsoft.error",\n            value=HttpError(\n                code="BadRequest",\n                message="Unknown action",\n                inner_http_error=InnerHttpError(\n                    status_code=400,\n                    body={"error": "Unknown action"},\n                ),\n            ),\n        )\n\n    return AdaptiveCardActionMessageResponse(\n        status_code=200,\n        type="application/vnd.microsoft.activity.message",\n        value="Action processed successfully",\n    )\n'})})}),"\n",(0,a.jsx)(r.A,{language:"python",children:(0,a.jsx)(t.admonition,{type:"note",children:(0,a.jsxs)(t.p,{children:["The ",(0,a.jsx)(t.code,{children:"data"})," values are accessible as a dictionary and can be accessed using ",(0,a.jsx)(t.code,{children:".get()"})," method for safe access."]})})})]})}function p(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},43023:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>o});var i=n(63696);const a={},s=i.createContext(a);function r(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);