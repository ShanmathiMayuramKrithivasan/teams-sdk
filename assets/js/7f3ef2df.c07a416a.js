"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[2350],{26802:(e,t,n)=>{n.d(t,{A:()=>a});var i=n(22147),s=n(62540);function a({language:e,children:t}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:t}):null}},43023:(e,t,n)=>{n.d(t,{R:()=>r,x:()=>c});var i=n(63696);const s={},a=i.createContext(s);function r(e){const t=i.useContext(a);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(a.Provider,{value:t},e.children)}},87068:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>u,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"typescript/in-depth-guides/adaptive-cards/executing-actions","title":"Executing Actions","description":"\x3c!--","source":"@site/docs/main/typescript/in-depth-guides/adaptive-cards/executing-actions.mdx","sourceDirName":"typescript/in-depth-guides/adaptive-cards","slug":"/typescript/in-depth-guides/adaptive-cards/executing-actions","permalink":"/teams-sdk/typescript/in-depth-guides/adaptive-cards/executing-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/in-depth-guides/adaptive-cards/executing-actions.mdx","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Executing Actions","title":"Executing Actions","summary":"How to implement interactive elements in Adaptive Cards through actions like buttons, links, and input submission triggers."},"sidebar":"default","previous":{"title":"Building Adaptive Cards","permalink":"/teams-sdk/typescript/in-depth-guides/adaptive-cards/building-adaptive-cards"},"next":{"title":"Dialogs","permalink":"/teams-sdk/typescript/in-depth-guides/dialogs/"}}');var s=n(62540),a=n(43023),r=n(26802);const c={sidebar_position:2,sidebar_label:"Executing Actions",title:"Executing Actions",summary:"How to implement interactive elements in Adaptive Cards through actions like buttons, links, and input submission triggers."},o="Executing Actions",d={},l=[{value:"Action Types",id:"action-types",level:2},{value:"Creating Actions with the SDK",id:"creating-actions-with-the-sdk",level:2},{value:"Single Actions",id:"single-actions",level:3},{value:"Action Sets",id:"action-sets",level:3},{value:"Raw JSON Alternative",id:"raw-json-alternative",level:3},{value:"Working with Input Values",id:"working-with-input-values",level:2},{value:"Associating data with the cards",id:"associating-data-with-the-cards",level:3},{value:"Input Validation",id:"input-validation",level:3},{value:"Server Handlers",id:"server-handlers",level:2},{value:"Basic Structure",id:"basic-structure",level:3}];function p(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"executing-actions",children:"Executing Actions"})}),"\n",(0,s.jsxs)(t.p,{children:["Adaptive Cards support interactive elements through ",(0,s.jsx)(t.strong,{children:"actions"}),"\u2014buttons, links, and input submission triggers that respond to user interaction.\nYou can use these to collect form input, trigger workflows, show task modules, open URLs, and more."]}),"\n",(0,s.jsx)(t.h2,{id:"action-types",children:"Action Types"}),"\n",(0,s.jsx)(t.p,{children:"The Teams SDK supports several action types for different interaction patterns:"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Action Type"}),(0,s.jsx)(t.th,{children:"Purpose"}),(0,s.jsx)(t.th,{children:"Description"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Action.Execute"})}),(0,s.jsx)(t.td,{children:"Server\u2011side processing"}),(0,s.jsx)(t.td,{children:"Send data to your bot for processing. Best for forms & multi\u2011step workflows."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Action.Submit"})}),(0,s.jsx)(t.td,{children:"Simple data submission"}),(0,s.jsxs)(t.td,{children:["Legacy action type. Prefer ",(0,s.jsx)(t.code,{children:"Execute"})," for new projects."]})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Action.OpenUrl"})}),(0,s.jsx)(t.td,{children:"External navigation"}),(0,s.jsx)(t.td,{children:"Open a URL in the user's browser."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Action.ShowCard"})}),(0,s.jsx)(t.td,{children:"Progressive disclosure"}),(0,s.jsx)(t.td,{children:"Display a nested card when clicked."})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"Action.ToggleVisibility"})}),(0,s.jsx)(t.td,{children:"UI state management"}),(0,s.jsx)(t.td,{children:"Show/hide card elements dynamically."})]})]})]}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["For complete reference, see the ",(0,s.jsx)(t.a,{href:"https://adaptivecards.microsoft.com/?topic=Action.Execute",children:"official documentation"}),"."]})}),"\n",(0,s.jsx)(t.h2,{id:"creating-actions-with-the-sdk",children:"Creating Actions with the SDK"}),"\n",(0,s.jsx)(t.h3,{id:"single-actions",children:"Single Actions"}),"\n",(0,s.jsx)(t.p,{children:"The SDK provides builder helpers that abstract the underlying JSON. For example:"}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import { ExecuteAction } from '@microsoft/teams.cards';\n// ...\n\nnew ExecuteAction({ title: 'Submit Feedback' })\n  .withData({ action: 'submit_feedback' })\n  .withAssociatedInputs('auto'),\n"})})}),"\n",(0,s.jsx)(t.h3,{id:"action-sets",children:"Action Sets"}),"\n",(0,s.jsxs)(t.p,{children:["Group actions together using ",(0,s.jsx)(t.code,{children:"ActionSet"}),":"]}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import { ExecuteAction, OpenUrlAction, ActionSet } from '@microsoft/teams.cards';\n// ...\n\nnew ActionSet(\n  new ExecuteAction({ title: 'Submit Feedback' })\n    .withData({ action: 'submit_feedback' })\n    .withAssociatedInputs('auto'),\n  new OpenUrlAction('https://adaptivecards.microsoft.com').withTitle('Learn More')\n);\n"})})}),"\n",(0,s.jsx)(t.h3,{id:"raw-json-alternative",children:"Raw JSON Alternative"}),"\n",(0,s.jsxs)(t.p,{children:["Just like when building cards, if you prefer to work with raw JSON, you can do just that. ",(0,s.jsx)(r.A,{language:"typescript",children:"You get type safety for free in TypeScript."})]}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import { IOpenUrlAction } from '@microsoft/teams.cards';\n// ...\n\n{\n  type: 'Action.OpenUrl',\n  url: 'https://adaptivecards.microsoft.com',\n  title: 'Learn More',\n} as const satisfies IOpenUrlAction\n"})})}),"\n",(0,s.jsx)(t.h2,{id:"working-with-input-values",children:"Working with Input Values"}),"\n",(0,s.jsx)(t.h3,{id:"associating-data-with-the-cards",children:"Associating data with the cards"}),"\n",(0,s.jsxs)(t.p,{children:["Sometimes you want to send a card and have it be associated with some data. Set the ",(0,s.jsx)(t.code,{children:"data"})," value to be sent back to the client so you can associate it with a particular entity."]}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import {\n  AdaptiveCard,\n  TextInput,\n  ToggleInput,\n  ActionSet,\n  ExecuteAction,\n} from '@microsoft/teams.cards';\n// ...\n\nfunction editProfileCard() {\n  const card = new AdaptiveCard(\n    new TextInput({ id: 'name' }).withLabel('Name').withValue('John Doe'),\n    new TextInput({ id: 'email', label: 'Email', value: 'john@contoso.com' }),\n    new ToggleInput('Subscribe to newsletter').withId('subscribe').withValue('false'),\n    new ActionSet(\n      new ExecuteAction({ title: 'Save' })\n        .withData({\n          action: 'save_profile',\n          entityId: '12345', // This will come back once the user submits\n        })\n        .withAssociatedInputs('auto')\n    )\n  );\n\n  // Data received in handler\n  /**\n  {\n    action: \"save_profile\",\n    entityId: \"12345\",     // From action data\n    name: \"John Doe\",      // From name input\n    email: \"john@doe.com\", // From email input\n    subscribe: \"true\"      // From toggle input (as string)\n  }\n  */\n\n  return card;\n}\n"})})}),"\n",(0,s.jsx)(t.h3,{id:"input-validation",children:"Input Validation"}),"\n",(0,s.jsxs)(t.p,{children:["Input Controls provide ways for you to validate. More details can be found on the Adaptive Cards ",(0,s.jsx)(t.a,{href:"https://adaptivecards.microsoft.com/?topic=input-validation",children:"documentation"}),"."]}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import {\n  AdaptiveCard,\n  NumberInput,\n  TextInput,\n  ActionSet,\n  ExecuteAction,\n} from '@microsoft/teams.cards';\n// ...\n\nfunction createProfileCardInputValidation() {\n  const ageInput = new NumberInput({ id: 'age' })\n    .withLabel('Age')\n    .withIsRequired(true)\n    .withMin(0)\n    .withMax(120);\n\n  const nameInput = new TextInput({ id: 'name' })\n    .withLabel('Name')\n    .withIsRequired()\n    .withErrorMessage('Name is required!'); // Custom error messages\n  const card = new AdaptiveCard(\n    nameInput,\n    ageInput,\n    new TextInput({ id: 'location' }).withLabel('Location'),\n    new ActionSet(\n      new ExecuteAction({ title: 'Save' })\n        .withData({\n          action: 'save_profile',\n        })\n        .withAssociatedInputs('auto') // All inputs should be validated\n    )\n  );\n\n  return card;\n}\n"})})}),"\n",(0,s.jsx)(t.h2,{id:"server-handlers",children:"Server Handlers"}),"\n",(0,s.jsx)(t.h3,{id:"basic-structure",children:"Basic Structure"}),"\n",(0,s.jsxs)(t.p,{children:["Card actions arrive as ",(0,s.jsx)(t.code,{children:"card.action"})," activities in your app. These give you access to the validated input values plus any ",(0,s.jsx)(t.code,{children:"data"})," values you had configured to be sent back to you."]}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"import {\n  AdaptiveCardActionErrorResponse,\n  AdaptiveCardActionMessageResponse,\n} from '@microsoft/teams.api';\nimport { App } from '@microsoft/teams.apps';\n// ...\n\napp.on('card.action', async ({ activity, send }) => {\n  const data = activity.value?.action?.data;\n  if (!data?.action) {\n    return {\n      statusCode: 400,\n      type: 'application/vnd.microsoft.error',\n      value: {\n        code: 'BadRequest',\n        message: 'No action specified',\n        innerHttpError: {\n          statusCode: 400,\n          body: { error: 'No action specified' },\n        },\n      },\n    } satisfies AdaptiveCardActionErrorResponse;\n  }\n\n  console.debug('Received action data:', data);\n\n  switch (data.action) {\n    case 'submit_feedback':\n      await send(`Feedback received: ${data.feedback}`);\n      break;\n\n    case 'purchase_item':\n      await send(`Purchase request received for game: ${data.choiceGameSingle}`);\n      break;\n\n    case 'save_profile':\n      await send(\n        `Profile saved!\\nName: ${data.name}\\nEmail: ${data.email}\\nSubscribed: ${data.subscribe}`\n      );\n      break;\n\n    default:\n      return {\n        statusCode: 400,\n        type: 'application/vnd.microsoft.error',\n        value: {\n          code: 'BadRequest',\n          message: 'Unknown action',\n          innerHttpError: {\n            statusCode: 400,\n            body: { error: 'Unknown action' },\n          },\n        },\n      } satisfies AdaptiveCardActionErrorResponse;\n  }\n\n  return {\n    statusCode: 200,\n    type: 'application/vnd.microsoft.activity.message',\n    value: 'Action processed successfully',\n  } satisfies AdaptiveCardActionMessageResponse;\n});\n"})})}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"data"})," values are not typed and come as ",(0,s.jsx)(t.code,{children:"any"}),", so you will need to cast them to the correct type in this case."]})})})]})}function u(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}}}]);