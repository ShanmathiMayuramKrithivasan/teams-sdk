"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[7342],{3530:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/example-on-teams-8286abb25b11411cefb28a0bf49aa821.png"},26802:(e,n,t)=>{t.d(n,{A:()=>o});var i=t(22147),s=t(62540);function o({language:e,children:n}){return(0,i.zy)().pathname.includes(`/${e}/`)?(0,s.jsx)(s.Fragment,{children:n}):null}},43023:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>l});var i=t(63696);const s={},o=i.createContext(s);function r(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),i.createElement(o.Provider,{value:n},e.children)}},75292:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/agents-toolkit-c7bd4ad378a9ee1b4367a70a5220577c.png"},79512:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"typescript/getting-started/running-in-teams/index","title":"Running in Teams","description":"\x3c!--","source":"@site/docs/main/typescript/getting-started/running-in-teams/index.mdx","sourceDirName":"typescript/getting-started/running-in-teams","slug":"/typescript/getting-started/running-in-teams/","permalink":"/teams-sdk/typescript/getting-started/running-in-teams/","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/getting-started/running-in-teams/index.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Running in Teams","summary":"Guide to deploying and testing your locally running agent in Microsoft Teams using the Microsoft 365 Agents Toolkit.","llms":"ignore"},"sidebar":"default","previous":{"title":"Code Basics","permalink":"/teams-sdk/typescript/getting-started/code-basics"},"next":{"title":"Essentials","permalink":"/teams-sdk/typescript/essentials/"}}');var s=t(62540),o=t(43023),r=t(26802);const l={sidebar_position:3,title:"Running in Teams",summary:"Guide to deploying and testing your locally running agent in Microsoft Teams using the Microsoft 365 Agents Toolkit.",llms:"ignore"},a="Running In Teams",c={},d=[{value:"Microsoft 365 Agents Toolkit",id:"microsoft-365-agents-toolkit",level:2},{value:"Install Microsoft 365 Agents Toolkit",id:"install-microsoft-365-agents-toolkit",level:3},{value:"Adding Teams configuration files via <code>teams</code> CLI",id:"adding-teams-configuration-files-via-teams-cli",level:2},{value:"Debugging in Teams",id:"debugging-in-teams",level:2},{value:"Testing your agent",id:"testing-your-agent",level:2},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Next steps",id:"next-steps",level:2},{value:"Resources",id:"resources",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"running-in-teams",children:"Running In Teams"})}),"\n",(0,s.jsxs)(n.p,{children:["Now that you completed ",(0,s.jsx)(n.a,{href:"../quickstart",children:"the quickstart"})," and your agent is running locally, let's deploy it to Microsoft Teams for testing. This guide will walk you through the process."]}),"\n",(0,s.jsx)(n.h2,{id:"microsoft-365-agents-toolkit",children:"Microsoft 365 Agents Toolkit"}),"\n",(0,s.jsxs)(n.p,{children:["Microsoft 365 Agents Toolkit is a powerful tool that simplifies deploying and debugging Teams applications. It automates tasks like managing the Teams app manifest, configuring authentication, provisioning, and deployment. If you'd like to learn about these concepts, check out ",(0,s.jsx)(n.a,{href:"/teams/core-concepts",children:"Teams core concepts"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"install-microsoft-365-agents-toolkit",children:"Install Microsoft 365 Agents Toolkit"}),"\n",(0,s.jsx)(n.p,{children:"First, you'll need to install the Agents Toolkit IDE extension:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Visit the ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/install-teams-toolkit",children:"Microsoft 365 Agents Toolkit installation guide"})," to install on your preferred IDE."]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"adding-teams-configuration-files-via-teams-cli",children:["Adding Teams configuration files via ",(0,s.jsx)(n.code,{children:"teams"})," CLI"]}),"\n",(0,s.jsx)(n.p,{children:"To configure your agent for Teams, run the following command in the terminal inside your quote-agent folder:"}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["(if you have ",(0,s.jsx)(n.code,{children:"teams"})," CLI installed globally, use ",(0,s.jsx)(n.code,{children:"teams"})," instead of ",(0,s.jsx)(n.code,{children:"npx"}),")"]})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"npx @microsoft/teams.cli config add atk.basic\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"atk.basic"})," configuration is a basic setup for Agents Toolkit. It includes the necessary files and configuration to get started with Teams development.",(0,s.jsx)("br",{}),"\nExplore more advanced configurations as needed with ",(0,s.jsx)(n.code,{children:"npx @microsoft/teams.cli config --help"}),".",(0,s.jsx)("br",{})]})}),"\n",(0,s.jsxs)(n.p,{children:["This ",(0,s.jsx)(n.a,{href:"/developer-tools/cli",children:"CLI"})," command adds configuration files required by Agents Toolkit, including:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Environment setup in the ",(0,s.jsx)(n.code,{children:"env"})," folder and root ",(0,s.jsx)(n.code,{children:".env"})," file"]}),"\n",(0,s.jsxs)(n.li,{children:["Teams app manifest in the ",(0,s.jsx)(n.code,{children:"appPackage"})," folder (if not already present)"]}),"\n",(0,s.jsxs)(n.li,{children:["Debug instructions in ",(0,s.jsx)(n.code,{children:".vscode/launch.json"})," and ",(0,s.jsx)(n.code,{children:".vscode/tasks.json"})]}),"\n",(0,s.jsxs)(n.li,{children:["Agents Toolkit automation files to your project (e.g. ",(0,s.jsx)(n.code,{children:"teamsapp.local.yml"}),")"]}),"\n"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Tool Name"}),(0,s.jsx)(n.th,{children:"Command"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Teams SDK CLI"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"teams"})}),(0,s.jsx)(n.td,{children:"A command-line tool for setting up and utilizing the Teams SDK, including integration with Microsoft 365 Agents Toolkit when desired."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Microsoft 365 Agents Toolkit"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"atk"})}),(0,s.jsx)(n.td,{children:"A tool for managing provisioning, deployment, and in-client debugging for Teams applications."})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"debugging-in-teams",children:"Debugging in Teams"}),"\n",(0,s.jsx)(n.p,{children:"After installing Agents Toolkit and adding the configuration:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Open"})," your agent's project in your IDE."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Open the Microsoft 365 Agents Toolkit extension panel"})," (usually on the left sidebar)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Log in"})," to your Microsoft 365 and Azure accounts in the Agents Toolkit extension."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:'Select "Local"'})," under Environment Settings of the Agents Toolkit extension."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Click on Debug (Chrome) or Debug (Edge)"})," to start debugging via the 'play' button."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Screenshot of Microsoft 365 Agents Toolkit with &#39;Environment&#39; section expanded and &#39;local&#39; selected.",src:t(75292).A+"",width:"355",height:"145"})}),"\n",(0,s.jsx)(n.p,{children:"When debugging starts, the Agents Toolkit will:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Build"})," your application"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsxs)(n.strong,{children:["Start a ",(0,s.jsx)(n.a,{href:"/teams/core-concepts#devtunnel",children:"devtunnel"})]})," that will assign a temporary public URL to your local server"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Provision the Teams app"})," for your tenant so that it can be installed and be authenticated on Teams"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Set up the local variables"})," necessary for your agent to run in Teams in ",(0,s.jsx)(n.code,{children:"env/.env.local"})," and ",(0,s.jsx)(n.code,{children:"env/env.local.user"}),". This includes propagating the app manifest with your newly provisioned resources."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Start"})," the local server."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Package your app manifest"})," into a Teams application zip package and the manifest json with variables inserted in ",(0,s.jsx)(n.code,{children:"appPackage/build"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Launch Teams"})," in an incognito window in your browser."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Upload the package"})," to Teams and signal it to sideload (install) the app just for your use."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"If you set up Agents Toolkit via the Teams SDK CLI, you should see something like the following in your terminal:"}),"\n",(0,s.jsx)(r.A,{language:"typescript",children:(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-sh",children:"[nodemon] 3.1.9\n[nodemon] to restart at any time, enter `rs`\n[nodemon] watching path(s): src/**\n[nodemon] watching extensions: ts\n[nodemon] starting `node -r ts-node/register -r dotenv/config ./src/index.ts`\n[WARN] @teams/app/devtools \u26a0\ufe0f  Devtools are not secure and should not be used production environments \u26a0\ufe0f\n[INFO] @teams/app/http listening on port 3978 \ud83d\ude80\n[INFO] @teams/app/devtools available at http://localhost:3979/devtools\n"})})}),"\n",(0,s.jsx)(n.h2,{id:"testing-your-agent",children:"Testing your agent"}),"\n",(0,s.jsx)(n.p,{children:"After the debugging session starts:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Teams will open in your browser"}),"\n",(0,s.jsx)(n.li,{children:"You'll be prompted to sign in (if not already)"}),"\n",(0,s.jsx)(n.li,{children:"Teams will ask permission to install the app"}),"\n",(0,s.jsx)(n.li,{children:"Once installed, you can start chatting with your agent!"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Screenshot of quote-agent-local agent running in Teams.",src:t(3530).A+"",width:"1212",height:"1068"})}),"\n",(0,s.jsx)(n.p,{children:"Congratulations! Now you have a fully functional agent running in Microsoft Teams. Interact with it just like any other Teams app and explore the rest of the documentation to build more complex agents."}),"\n",(0,s.jsx)(n.admonition,{type:"tip",children:(0,s.jsxs)(n.p,{children:["If you want to monitor the activities and events in your app, you can still use the ",(0,s.jsx)(n.a,{href:"/developer-tools/devtools",children:"DevTools plugin"}),"! Note that the DevTools server is running on port 3979. You can open it in your browser to interact with your agent and monitor activities in real time."]})}),"\n",(0,s.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,s.jsxs)(n.p,{children:["For deployment and resource management we recommend the Microsoft 365 Agents Toolkit. For authentication-related issues, refer to our ",(0,s.jsx)(n.a,{href:"/teams/app-authentication/troubleshooting",children:"Authentication Troubleshooting"})," guide."]}),"\n",(0,s.jsxs)(n.p,{children:["If you prefer to set everything up by hand, follow our ",(0,s.jsx)(n.a,{href:"/teams/configuration/manual-configuration",children:"Manual Configuration"})," guide. The Teams SDK itself doesn't handle deployment or Azure resources, so you'll need to rely on the general ",(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoftteams/deploy-overview",children:"Microsoft Teams deployment documentation"})," for in-depth help."]}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,s.jsxs)(n.p,{children:["Now that your agent is running in Teams, you can learn more ",(0,s.jsx)(n.a,{href:"../../essentials",children:"essential concepts"})," to understand how to build more complex agents. Explore the ",(0,s.jsx)(n.a,{href:"../../in-depth-guides",children:"in-depth guides"})," for advanced topics like authentication, message extensions, and more."]}),"\n",(0,s.jsx)(n.h2,{id:"resources",children:"Resources"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/developer-tools/cli",children:"Teams CLI documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoft-365/developer/overview-m365-agents-toolkit?toc=%2Fmicrosoftteams%2Fplatform%2Ftoc.json&bc=%2Fmicrosoftteams%2Fplatform%2Fbreadcrumb%2Ftoc.json",children:"Microsoft 365 Agents Toolkit documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoftteams/platform/toolkit/microsoft-365-agents-toolkit-cli",children:"Microsoft 365 Agents Toolkit CLI documentation"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://github.com/OfficeDev/Teams-Toolkit",children:"Teams CLI GitHub repository"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://learn.microsoft.com/en-us/microsoftteams/deploy-overview",children:"Microsoft Teams deployment documentation"})}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}}}]);