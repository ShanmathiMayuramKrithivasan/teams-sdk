"use strict";(self.webpackChunkteams_md=self.webpackChunkteams_md||[]).push([[7354],{7812:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>p,default:()=>h,frontMatter:()=>o,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"typescript/migrations/v2-previews","title":"From V2 Previews","description":"\x3c!--","source":"@site/docs/main/typescript/migrations/v2-previews.mdx","sourceDirName":"typescript/migrations","slug":"/typescript/migrations/v2-previews","permalink":"/teams-sdk/typescript/migrations/v2-previews","draft":false,"unlisted":false,"editUrl":"https://github.com/microsoft/teams-sdk/tree/main/teams.md/docs/main/typescript/migrations/v2-previews.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"From V2 Previews","title":"From V2 Previews","languages":["typescript"]},"sidebar":"default","previous":{"title":"Migrating from Teams SDK v1","permalink":"/teams-sdk/typescript/migrations/v1"},"next":{"title":"\ud83d\ude80 Getting Started","permalink":"/teams-sdk/csharp/getting-started/"}}');var i=s(62540),r=s(43023),a=s(26802);const o={sidebar_position:3,sidebar_label:"From V2 Previews",title:"From V2 Previews",languages:["typescript"]},p="From V2 Previews",d={},c=[{value:"Graph Client",id:"graph-client",level:2},{value:"Installing endpoints dependency",id:"installing-endpoints-dependency",level:3},{value:"Updating code",id:"updating-code",level:3},{value:"Calling endpoints",id:"calling-endpoints",level:4},{value:"Providing arguments",id:"providing-arguments",level:4},{value:"No more redundant arguments",id:"no-more-redundant-arguments",level:4},{value:"Improving readability",id:"improving-readability",level:4}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"from-v2-previews",children:"From V2 Previews"})}),"\n",(0,i.jsxs)(a.A,{language:"typescript",children:[(0,i.jsx)(n.p,{children:"If you're moving from preview versions of Teams SDK, you may encounter a few breaking changes along the way. This page outlines those and shows how to get back on track."}),(0,i.jsx)(n.h2,{id:"graph-client",children:"Graph Client"}),(0,i.jsx)(n.p,{children:"The Graph Client has been redesigned to be more flexible and support far more Graph APIs, while being mindful of code and package size. The Graph endpoints are now an optional dependency, and one that is fully tree-shakable if you're using a modern bundler."}),(0,i.jsx)(n.p,{children:"The redesign changes the calling pattern slightly. If you were using Graph APIs, you may need to update your code."}),(0,i.jsx)(n.h3,{id:"installing-endpoints-dependency",children:"Installing endpoints dependency"}),(0,i.jsxs)(n.p,{children:["The first step in the migration is to install the ",(0,i.jsx)(n.code,{children:"@microsoft/teams.graph-endpoints"})," dependency. This dependency is optional to reduce overhead for for applications that don't need to call Graph APIs. If you're reading this migration guide however, you'll likely want to install it."]}),(0,i.jsx)(n.p,{children:"This package is installed just like any other NPM package, using your package manager of choice. For instance:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-sh",children:"npm install @microsoft/teams.graph-endpoints\n"})}),(0,i.jsx)(n.h3,{id:"updating-code",children:"Updating code"}),(0,i.jsxs)(n.p,{children:["Once the endpoints dependency is installed, the code changes should be fairly straight forward as the overall Graph taxonomy and API naming conventions have not changed. The overall change is that instead of invoking an endpoint function directly, you now pass in an endpoint to the ",(0,i.jsx)(n.code,{children:"graphClient.call()"})," method."]}),(0,i.jsx)(n.h4,{id:"calling-endpoints",children:"Calling endpoints"}),(0,i.jsx)(n.p,{children:"In earlier preview versions, the way to get details for the current user was:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// GET /me\nconst me = await app.graph.me.get();\n"})}),(0,i.jsx)(n.p,{children:"In current versions, the equivalent method is:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as endpoints from '@microsoft/teams.graph-endpoints';\n\n// GET /me\nconst me = await app.graph.call(endpoints.me.get);\n"})}),(0,i.jsx)(n.h4,{id:"providing-arguments",children:"Providing arguments"}),(0,i.jsx)(n.p,{children:"In earlier preview versions, variables were passes as an argument when invoking the endpoint. To get details for a specific user, you would do the following:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// GET /users/{id | userPrincipalName}\nconst user = await app.graph.users.get({ 'user-id': userId });\n"})}),(0,i.jsx)(n.p,{children:"In current versions, the variables are provided as a separate argument after the endpoint:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as endpoints from '@microsoft/teams.graph-endpoints';\n\n// GET /users/{id | userPrincipalName}\nconst user = await app.graph.call(endpoints.users.get, { 'user-id': userId });\n"})}),(0,i.jsx)(n.h4,{id:"no-more-redundant-arguments",children:"No more redundant arguments"}),(0,i.jsx)(n.p,{children:"In earlier preview versions, some endpoints required the same argument to be provided twice. For instance:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// GET /teams/{team-id}/installedApps`\nconst apps = await app.graph.teams.installedApps(teamId).list({ 'team-id': teamId });\n"})}),(0,i.jsx)(n.p,{children:"In current versions, once is enough:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// GET /teams/{team-id}/installedApps`\nconst apps = await app.graph.call(endpoints.teams.installedApps.list, { 'team-id': teamId });\n"})}),(0,i.jsx)(n.h4,{id:"improving-readability",children:"Improving readability"}),(0,i.jsx)(n.p,{children:"If you find it helpful for readability, you can scope your endpoint import as you prefer. For instance:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"import * as endpoints from '@microsoft/teams.graph-endpoints';\nimport { me } from '@microsoft/teams.graph-endpoints';\nimport { presence } from '@microsoft/teams.graph-endpoints/me';\nimport { setPresence } from '@microsoft/teams.graph-endpoints/me/presence';\nimport { create as updatePresence } from '@microsoft/teams.graph-endpoints/me/presence/setPresence';\n\n// different ways to POST to /me/presence/setPresence\nconst newPresence = { availability: 'Away', activity: 'Away', sessionId: clientId };\nawait app.graph.call(endpoints.me.presence.setPresence.create, newPresence);\nawait app.graph.call(me.presence.setPresence.create, newPresence);\nawait app.graph.call(presence.setPresence.create, newPresence);\nawait app.graph.call(setPresence.create, newPresence);\nawait app.graph.call(updatePresence, newPresence);\n"})})]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},26802:(e,n,s)=>{s.d(n,{A:()=>r});var t=s(22147),i=s(62540);function r({language:e,children:n}){return(0,t.zy)().pathname.includes(`/${e}/`)?(0,i.jsx)(i.Fragment,{children:n}):null}},43023:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>o});var t=s(63696);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);